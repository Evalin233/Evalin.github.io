<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Oracle学习</title>
      <link href="/post/716958ef.html"/>
      <url>/post/716958ef.html</url>
      
        <content type="html"><![CDATA[<h1 id="一、名词解释"><a href="#一、名词解释" class="headerlink" title="一、名词解释"></a>一、名词解释</h1><p><strong>数据：</strong>当今世界是一个充满着数据的互联网世界，充斥着大量的数据。这个互联网世界就是数据世界。数据的来源有很多，比如出行记录、消费记录、浏览的网页、发送的消息等等。<strong>文本，图像、音乐、声音都是数据</strong>。</p><p><strong>数据库：存放数据的仓库</strong>，电子化的文件柜，存储和管理数据的软件。</p><p>它的存储空间很大，可以存放百万条、千万条、上亿条数据。但是数据库并不是随意地将数据进行存放，是有一定的规则的，否则查询的效率会很低。</p><p><strong>登录：</strong>数据有安全保密性，不能随便一个人都能看到，查看数据的前提是通过安全认证，这个安全认证就是用户名和密码，如果你用户名和密码输对了，说明这个数据库属于你。<strong>鉴定用户名和密码是否正确的过程称为登录鉴定</strong>。</p><p>​    总结来说就是：你是谁？</p><p><strong>权限：</strong>通过了登录鉴定并不是说你就可以访问数据了，未必！举个例子：小明的公司有一个数据库，这个数据库存储了客户信息，员工信息，工资信息……这个公司有很多员工，那么无论是谁只要通过了登录鉴定就都能查看员工的工资信息了？员工的工资可是公司的绝密敏感信息啊。答案显然是：不能！</p><p>所以要做数据的<strong>权限</strong>控制，<strong>仅让特定的人访问特定的信息</strong>。你拥有这个数据的权限就可以访问这笔数据，否则会遭到拒绝。</p><p>总结来说就是：你是能做什么？</p><p><strong>角色：权限的集合称为角色。</strong>或者换种说法：一组权限叫角色。</p><p>为什么要有角色? 能看到员工工资的人是一群人，而不是一个人，这一群人通常叫做“出纳”。出纳就是一个角色，出纳通常还具有：报销单，对账单，工资表…..数据的操作权限，那么，我们说拥有这一组权限的人就是“出纳”，“出纳”就是角色。</p><p>设置角色的目的是为了更方便的把这一组权限赋给某一群人，因为一个一个的为用户赋权限太累了，权限太多，用户也太多。</p><p><strong>存储过程：存储在数据库中供用户调用的程序叫存储过程（数据库中的程序）。</strong></p><p><strong>游标：</strong>直接的理解是可以（在结果集中）上下游走的光标。</p><p>游标的作用就是用于临时存储从数据库中提取的数据块（结果集）。<strong>游标提供了在结果集中一次一行或者多行前进或向后浏览数据的能力</strong>。游标实际就是JDBC当中的ResultSet。</p><h1 id="1、Oracle的配置"><a href="#1、Oracle的配置" class="headerlink" title="1、Oracle的配置"></a>1、Oracle的配置</h1><h2 id="1-1-配置"><a href="#1-1-配置" class="headerlink" title="1.1 配置"></a>1.1 配置</h2><p>启动两个服务（默认自动启动）：</p><p>OracleServiceORCL</p><p>OracleOraDb11g_home1TNSListener</p><p>使用配置助手配置本地连接（默认自动配置好的）。这两项操作不出问题就不做。</p><h1 id="2、用户创建与授权-DCL"><a href="#2、用户创建与授权-DCL" class="headerlink" title="2、用户创建与授权(DCL)"></a>2、用户创建与授权(DCL)</h1><h2 id="2-1-用户类型"><a href="#2-1-用户类型" class="headerlink" title="2.1 用户类型"></a>2.1 用户类型</h2><p>登录时可以选择的三种账户类型:sysdba,sysoper,normal</p><p>它们之间的区别：</p><table><thead><tr><th><strong>账户</strong></th><th><strong>描述</strong></th><th><strong>功能</strong></th></tr></thead><tbody><tr><td><strong>sysdba</strong></td><td>数据库管理员</td><td>打开数据库服务器，关闭数据库服务器，备份数据库，恢复数据库，日志归档，会话限制，管理功能，创建数据库</td></tr><tr><td><strong>sysoper</strong></td><td>数据库操作员</td><td>打开数据库服务器，关闭数据库服务器， 备份数据库，恢复数据库，日志归档，会话限制</td></tr><tr><td><strong>normal</strong></td><td>普通用户</td><td>无任何权限（只有通过被授权之后才可以对数据库进行操作）</td></tr></tbody></table><h2 id="2-2-用户"><a href="#2-2-用户" class="headerlink" title="2.2 用户"></a>2.2 用户</h2><h3 id="2-2-1-默认解锁账户"><a href="#2-2-1-默认解锁账户" class="headerlink" title="2.2.1 默认解锁账户"></a>2.2.1 默认解锁账户</h3><table><thead><tr><th><strong>用户名</strong></th><th><strong>密码</strong></th><th><strong>类型</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>sys</td><td>安装时设置</td><td>sysdba, sysoper</td><td>级别最高的账户</td></tr><tr><td>sysdba</td><td>安装时设置</td><td>sysdba</td><td>级别最高的账户</td></tr><tr><td>system</td><td>安装时设置</td><td>normal</td><td>虽然是普通用户，但拥有dba角色</td></tr></tbody></table><p>sysdba，sysoper，dba的区别：sysdba，sysoper不依赖于数据库系统的启动，因为它俩是可以启动和关闭数据库系统的。dba必须依赖于数据库系统，数据库工作正常了dba角色才有了存在的基础。</p><h3 id="2-2-2-创建账户"><a href="#2-2-2-创建账户" class="headerlink" title="2.2.2 创建账户"></a>2.2.2 创建账户</h3><h4 id="2-2-2-1-创建用户"><a href="#2-2-2-1-创建用户" class="headerlink" title="2.2.2.1 创建用户"></a>2.2.2.1 创建用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> 用户名 IDENTIFIED <span class="keyword">BY</span> 密码;</span><br><span class="line">例如：<span class="keyword">CREATE</span> <span class="keyword">USER</span> nowashing IDENTIFIED <span class="keyword">BY</span> yujinxiang; </span><br><span class="line">创建了一个用户，用户名是nowashing密码是yujinxiang。</span><br></pre></td></tr></table></figure><h4 id="2-2-2-2-修改任意用户的密码"><a href="#2-2-2-2-修改任意用户的密码" class="headerlink" title="2.2.2.2 修改任意用户的密码"></a>2.2.2.2 修改任意用户的密码</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> 用户名 IDENTIFIED <span class="keyword">BY</span> 密码;</span><br><span class="line">例如：ALERT <span class="keyword">USER</span> scott IDENTIFIED <span class="keyword">BY</span> tiger;</span><br><span class="line">将scott的密码修改为tiger。</span><br></pre></td></tr></table></figure><h4 id="2-2-2-3-修改当前用户的密码"><a href="#2-2-2-3-修改当前用户的密码" class="headerlink" title="2.2.2.3 修改当前用户的密码"></a>2.2.2.3 修改当前用户的密码</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> 用户名 IDENTIFIED <span class="keyword">BY</span> 新密码 REPLACE 旧密码;</span><br></pre></td></tr></table></figure><h4 id="2-2-2-4-删除用户"><a href="#2-2-2-4-删除用户" class="headerlink" title="2.2.2.4 删除用户"></a>2.2.2.4 删除用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> 用户名（CASCADE级联删除拥有对象）</span><br><span class="line">例如：<span class="keyword">DROP</span> <span class="keyword">USER</span> nowashing;</span><br><span class="line">删除掉nowashing这个用户，以及这个用户所拥有的所有的数据对象(权限，表，视图，存储过程……)。</span><br></pre></td></tr></table></figure><h4 id="2-2-2-5-查询所有用户"><a href="#2-2-2-5-查询所有用户" class="headerlink" title="2.2.2.5 查询所有用户"></a>2.2.2.5 查询所有用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> all_users;</span><br></pre></td></tr></table></figure><h2 id="2-3-授权"><a href="#2-3-授权" class="headerlink" title="2.3 授权"></a>2.3 授权</h2><h3 id="2-3-1-授权"><a href="#2-3-1-授权" class="headerlink" title="2.3.1 授权"></a>2.3.1 授权</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"><span class="keyword">GRANT</span> 权限<span class="operator">/</span>角色列表 <span class="keyword">TO</span> 用户名 [<span class="keyword">WITH</span> ADMIN OPTION];</span><br><span class="line">例如<span class="number">1</span>：</span><br><span class="line"><span class="keyword">GRANT</span> dba <span class="keyword">TO</span> nowashing;</span><br><span class="line">授权dba角色给nowashing这个用户。</span><br><span class="line">后续篇章将权限，角色统称为权限。</span><br><span class="line">例如<span class="number">2</span>：</span><br><span class="line">权限或角色有多项用逗号分隔：</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">connect</span>,resource,dba <span class="keyword">TO</span> nowashing;</span><br><span class="line">例如<span class="number">3</span>：</span><br><span class="line">被授权用户拥有此权限后是否可以再将此权限授予别人：</span><br><span class="line"><span class="keyword">GRANT</span> dba <span class="keyword">TO</span> nowashing <span class="keyword">WITH</span> ADMIN OPTION;</span><br><span class="line">不加<span class="keyword">WITH</span> ADMIN OPTION是不允许授予别人的。</span><br><span class="line">例如<span class="number">4</span>：</span><br><span class="line">将某授权授予给所有用户：</span><br><span class="line"><span class="keyword">GRANT</span> 权限 <span class="keyword">TO</span> PUBLIC;</span><br></pre></td></tr></table></figure><h3 id="2-3-2-撤消授权"><a href="#2-3-2-撤消授权" class="headerlink" title="2.3.2 撤消授权"></a>2.3.2 撤消授权</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"><span class="keyword">REVOKE</span> 权限<span class="operator">/</span>角色列表 <span class="keyword">FROM</span> 用户</span><br><span class="line">例如：<span class="keyword">REVOKE</span>  dba <span class="keyword">TO</span> nowashing;</span><br><span class="line">收回(撤消)dba角色从nowashing这个用户。</span><br><span class="line">权限或角色有多项用逗号分隔：</span><br><span class="line"><span class="keyword">REVOKE</span>  <span class="keyword">connect</span>,resource,dba <span class="keyword">TO</span> nowashing</span><br></pre></td></tr></table></figure><h3 id="2-3-3-查询已拥有的权限"><a href="#2-3-3-查询已拥有的权限" class="headerlink" title="2.3.3 查询已拥有的权限"></a>2.3.3 查询已拥有的权限</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dba_sys_privs; <span class="comment">--查询所有用户和角色被授予的系统权限</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_sys_privs; <span class="comment">--查询当前登录用户被授予的系统权限</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_role_privs—查询当前登录用户拥有的角色</span><br></pre></td></tr></table></figure><h3 id="2-3-4-常见系统权限"><a href="#2-3-4-常见系统权限" class="headerlink" title="2.3.4 常见系统权限"></a>2.3.4 常见系统权限</h3><p>系统权限: 允许用户执行特定的数据库动作，如创建表、创建索引、连接实例等。</p><p>对象权限: 允许用户操纵一些特定的对象，如读取视图，可更新某些列、执行存储过程等。</p><p>Oracle的系统权限有206种（SELECT * FROM system_privilege_map），以下仅列出常用的一些：</p><table><thead><tr><th><strong>权限名称</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><strong>create   session</strong></td><td>连接到数据库</td></tr><tr><td><strong>create   sequence</strong></td><td>创建序列</td></tr><tr><td><strong>create   synonym</strong></td><td>创建同义词</td></tr><tr><td><strong>create   public synonym</strong></td><td>创建公用的同义词</td></tr><tr><td><strong>create   table</strong></td><td>创建表</td></tr><tr><td><strong>create   any table</strong></td><td>在任何模式中创建表</td></tr><tr><td><strong>drop   table</strong></td><td>删除表</td></tr><tr><td><strong>drop   any table</strong></td><td>删除任何模式中的表</td></tr><tr><td><strong>create   procedure</strong></td><td>创建存储过程</td></tr><tr><td><strong>execute   any procedure</strong></td><td>运行任务模式中的存储过程</td></tr><tr><td><strong>create   user</strong></td><td>创建用户</td></tr><tr><td><strong>alter   user</strong></td><td>修改用户</td></tr><tr><td><strong>drop   user</strong></td><td>删除用户</td></tr><tr><td><strong>create   view</strong></td><td>创建视图</td></tr></tbody></table><p>模式(schema)：是某个用户拥有所有对象的集合。</p><h3 id="2-3-5-常见系统角色"><a href="#2-3-5-常见系统角色" class="headerlink" title="2.3.5 常见系统角色"></a>2.3.5 常见系统角色</h3><table><thead><tr><th><strong>角色名称</strong></th><th><strong>拥有权限</strong></th></tr></thead><tbody><tr><td><strong>dba</strong></td><td>所有权限</td></tr><tr><td><strong>connect</strong></td><td>create   session 连接到数据库   alter session   –修改会话    create sequence –建立序列    create synonym –建立同义词    create view –建立视图   create   cluster –建立聚簇    create database link –建立数据库链接</td></tr><tr><td><strong>resource</strong></td><td>create   trigger–建立触发器   create   sequence  –建立序列   create   procedure –建立存储过程   create   cluster –建立聚簇   create   operator  –建立操作员   create   index –建立索引   create   indextype –建立索引类型   create   table –建立表</td></tr></tbody></table><h3 id="2-3-6-对象权限"><a href="#2-3-6-对象权限" class="headerlink" title="2.3.6 对象权限"></a>2.3.6 对象权限</h3><p>所谓的对象指的是：表，视图，索引，同义词，存储过程，触发器，序列……</p><p>Ø  不同的对象具有不同的对象权限</p><p>Ø  对象的拥有者拥有所有权限</p><p>Ø  对象的拥有者可以向外分配权限</p><table><thead><tr><th><strong>对象权限</strong></th><th><strong>表</strong></th><th><strong>视图</strong></th><th><strong>序列</strong></th><th><strong>过程</strong></th></tr></thead><tbody><tr><td><strong>查询(select)</strong></td><td>√</td><td>√</td><td>√</td><td></td></tr><tr><td><strong>插入(insert)</strong></td><td>√</td><td>√</td><td></td><td></td></tr><tr><td><strong>更新(update)</strong></td><td>√</td><td>√</td><td></td><td></td></tr><tr><td><strong>删除(delete)</strong></td><td>√</td><td>√</td><td></td><td></td></tr><tr><td><strong>修改(alter)</strong></td><td>√</td><td></td><td>√</td><td></td></tr><tr><td><strong>索引(index)</strong></td><td>√</td><td></td><td></td><td></td></tr><tr><td><strong>关联(references)</strong></td><td>√</td><td></td><td></td><td></td></tr><tr><td><strong>执行(execute)</strong></td><td></td><td></td><td></td><td>√</td></tr></tbody></table><h4 id="2-3-6-1-授予权限"><a href="#2-3-6-1-授予权限" class="headerlink" title="2.3.6.1 授予权限"></a>2.3.6.1 授予权限</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> 权限列表 <span class="keyword">ON</span> 对象名 <span class="keyword">TO</span> 用户名 [<span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION]</span><br><span class="line"></span><br><span class="line">例<span class="number">1</span>，授予<span class="operator">*</span><span class="operator">*</span>郁金香<span class="operator">*</span><span class="operator">*</span>这个用户，向<span class="operator">*</span><span class="operator">*</span>学生表查询，插值，修改，删除<span class="operator">*</span><span class="operator">*</span>的权限：</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="operator">*</span><span class="operator">*</span><span class="keyword">select</span> ,<span class="keyword">insert</span>,<span class="keyword">update</span>,<span class="keyword">delete</span>,<span class="keyword">execute</span><span class="operator">*</span><span class="operator">*</span> <span class="keyword">ON</span> <span class="operator">*</span><span class="operator">*</span>t_student<span class="operator">*</span><span class="operator">*</span> <span class="keyword">TO</span> yujinxiang;</span><br><span class="line"></span><br><span class="line">例<span class="number">2</span>，向数据库中所有用户分配权限：</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">select</span> <span class="keyword">ON</span> dept <span class="keyword">TO</span> PUBLIC;</span><br></pre></td></tr></table></figure><h4 id="2-3-6-2-授予部分字段权限（insert-update）"><a href="#2-3-6-2-授予部分字段权限（insert-update）" class="headerlink" title="2.3.6.2 授予部分字段权限（insert,update）"></a>2.3.6.2 授予部分字段权限（insert,update）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> 权限名称 (字段列表)  <span class="keyword">ON</span> 对象名 <span class="keyword">TO</span> 用户名 [<span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION]</span><br><span class="line"></span><br><span class="line">例如，授予<span class="operator">*</span><span class="operator">*</span>郁金香<span class="operator">*</span><span class="operator">*</span>这个用户，<span class="operator">*</span><span class="operator">*</span>修改学生表<span class="operator">*</span><span class="operator">*</span>的<span class="operator">*</span><span class="operator">*</span>学生姓名，学生年龄<span class="operator">*</span><span class="operator">*</span>的权限：</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="operator">*</span><span class="operator">*</span><span class="keyword">update</span><span class="operator">*</span><span class="operator">*</span> (stu_name，student_age)  <span class="keyword">ON</span> <span class="operator">*</span><span class="operator">*</span>t_student<span class="operator">*</span><span class="operator">*</span> <span class="keyword">TO</span> <span class="operator">*</span><span class="operator">*</span>yujinxiang<span class="operator">*</span><span class="operator">*</span>;</span><br></pre></td></tr></table></figure><h4 id="2-3-6-3-查询已拥有权限"><a href="#2-3-6-3-查询已拥有权限" class="headerlink" title="2.3.6.3 查询已拥有权限"></a>2.3.6.3 查询已拥有权限</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_tab_privs_made  <span class="comment">--查询授出去的对象权限(通常是属主自己查）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_tab_privs_recd，</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_tab_privs <span class="comment">--</span></span><br><span class="line"></span><br><span class="line">查询当前用户拥有的对象权限</span><br></pre></td></tr></table></figure><h4 id="2-3-6-4-撤消授权"><a href="#2-3-6-4-撤消授权" class="headerlink" title="2.3.6.4 撤消授权"></a>2.3.6.4 撤消授权</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span>格式：</span><br><span class="line"></span><br><span class="line"><span class="keyword">REVOKE</span> 权限列表 <span class="keyword">ON</span> 对象名 <span class="keyword">FROM</span> 用户名;</span><br><span class="line"></span><br><span class="line">例<span class="number">1</span>，撤消授予<span class="operator">*</span><span class="operator">*</span>郁金香<span class="operator">*</span><span class="operator">*</span>这个用户，向<span class="operator">*</span><span class="operator">*</span>学生表查询，插值，修改，删除<span class="operator">*</span><span class="operator">*</span>的权限：</span><br><span class="line"></span><br><span class="line"><span class="keyword">REVOKE</span> <span class="operator">*</span><span class="operator">*</span><span class="keyword">select</span> ,<span class="keyword">insert</span>,<span class="keyword">update</span>,<span class="keyword">delete</span>,<span class="keyword">execute</span><span class="operator">*</span><span class="operator">*</span> <span class="keyword">ON</span> <span class="operator">*</span><span class="operator">*</span>t_student<span class="operator">*</span><span class="operator">*</span> <span class="keyword">FROM</span> yujinxiang;</span><br><span class="line"></span><br><span class="line">例<span class="number">2</span>，撤消授予<span class="operator">*</span><span class="operator">*</span>郁金香<span class="operator">*</span><span class="operator">*</span>这个用户，<span class="operator">*</span><span class="operator">*</span>修改学生表<span class="operator">*</span><span class="operator">*</span>的<span class="operator">*</span><span class="operator">*</span>学生姓名，学生年龄<span class="operator">*</span><span class="operator">*</span>的权限：</span><br><span class="line"></span><br><span class="line"><span class="keyword">REVOKE</span> <span class="operator">*</span><span class="operator">*</span><span class="keyword">update</span><span class="operator">*</span><span class="operator">*</span> <span class="keyword">ON</span> <span class="operator">*</span><span class="operator">*</span>t_student<span class="operator">*</span><span class="operator">*</span> <span class="keyword">FROM</span> <span class="operator">*</span><span class="operator">*</span>yujinxiang<span class="operator">*</span><span class="operator">*</span>;</span><br></pre></td></tr></table></figure><h1 id="二、Oracle-基本概念"><a href="#二、Oracle-基本概念" class="headerlink" title="二、Oracle 基本概念"></a>二、Oracle 基本概念</h1><ul><li>1.Oracle 数据库</li></ul><p>​    Oracle Database，又名Oracle RDBMS，简称Oracle。Oracle数据库系统是美国Oracle公司(甲骨文)提供的以分布式数据库为核心的一组软件产品，是目前最流行的客户&#x2F;服务器(client&#x2F;server)或B&#x2F;S体系结构的数据库之一，比如SilverStream就是基于数据库的一种中间件。Oracle 数据库是数据的物理存储，这就包括（数据文件 ORA 或者 DBF、控制文件、联机日志、参数文件），其实Oracle 数据库的概念和其它数据库不一样，这里的数据库是一个操作系统只有一个库，可以看作是 Oracle 就只有一个大数据库。</p><ul><li>2.实例</li></ul><p>​    一个Oracle实例（Oracle Instance）有一系列的后台进程（Backguound Processes)和内存结构（Memory Structures)组成。一个数据库可以有 n 个实例。</p><ul><li>3.数据文件（dbf）</li></ul><p>​    数据文件是数据库的物理存储单位。数据库的数据是存储在表空间中的，真正是在某一个或者多个数据文件中。而一个表空间可以由一个或多个数据文件组成，一个数据文件只能属于一个表空间。一旦数据文件被加入到某个表空间后，就不能删除这个文件，如果要删除某个数据文件，只能删除其所属于的表空间才行。</p><ul><li>4.表空间</li></ul><p>​    表空间是 Oracle 对物理数据库上相关数据文件（ORA 或者 DBF 文件）的逻辑映射。一个数据库在逻辑上被划分成一到若干个表空间，每个表空间包含了在逻辑上相关联的一组结构。每个数据库至少有一个表空间(称之为 system 表空间)。<br>每个表空间由同一磁盘上的一个或多个文件组成，这些文件叫数据文件(datafile)。一个数据文件只能属于一个表空间。</p><p><img src="/post/716958ef/myBlog\source_posts\2023-07-25-Oracle学习\1.jpg" alt="1690291646201"></p><ul><li>5.用户</li></ul><p>​    用户是在实例下建立的。不同实例中可以建相同名字的用户。注意！表的数据，是由用户放入某一个表空间的，而这个表空间会随机把这些表数据放到一个或者多个数据文件中。由于Oracle的数据库不是普通的概念，oracle是由用户和表空间对数据进行管理和存放的。但是表不是由表空间去查询的，而是由用户去查的。因为不同用户可以在同一个表空间建立同一个名字的表，这里区分就是用户了!</p><h1 id="三、Oracle基础知识"><a href="#三、Oracle基础知识" class="headerlink" title="三、Oracle基础知识"></a>三、Oracle基础知识</h1><p><img src="/post/716958ef/myBlog\source_posts\2023-07-25-Oracle学习\2.jpg" alt="Oracle"></p><h2 id="3-1-Oracle-数据类型"><a href="#3-1-Oracle-数据类型" class="headerlink" title="3.1 Oracle 数据类型"></a>3.1 Oracle 数据类型</h2><ul><li>字符型</li></ul><p>​    （1）CHAR : 固定长度的字符类型，最多存储 2000 个字节<br>​    （2）VARCHAR2 :可变长度的字符类型，最多存储 4000 个字节<br>​    （3）LONG : 大文本类型。最大可以存储 2 个 G</p><ul><li>数值型</li></ul><p>​    NUMBER : 数值类型<br>​    例如：NUMBER(5) 最大可以存的数为 99999<br>​               NUMBER(5,2) 最大可以存的数为 999.99<br>               在使用Oracle的数值类型时最好都采用number(p,s)的方式</p><ul><li>日期型</li></ul><p>​    （1）DATE：日期时间型，精确到秒<br>​    （2）TIMESTAMP：精确到秒的小数点后 9 位</p><ul><li>long类型与lob大型对象数据类型</li></ul><p>​(1)LONG文本类型，最多达2GB；long列不能作为主键或唯一约束；存储时需要进行字符集转换；一个表中只有一列可以为long或long raw；不支持分布式事务；限制较多<br>​(2)LONG RAW可变长二进制数据，不用进行字符集转换的数据，最长2GB。<br>​(3)BLOB二进制大型对象，存储图片，音乐，视频等信息，通常将文件转为二进制再存进去；存储的最大大小为4G；支持随机存储<br>​(4)CLOB字符大型对象，存储文章或较长的文字。存储的最大大小为4G。<br>​(5)NCLOB存储Unicode类型的数据，根据字符集而定的字符类型，最大长度4G。<br>​(6)BFILE二进制文件，存放指向操作系统文件的指针；指向的文件不是数据库的一部分，只能在数据库外维护；只读，数据库将该文件当二进制文件处理。</p><ul><li><p>rowid &amp; urowid类型 </p><p>rowid 行地址，十六进制串，表示行在所在的表中唯一的行地址，该数据类型主要用于返回ROWID伪列，常用在可以将表中的每一条记录都加以唯一标识的场合，使用rowid来建立内部索引。</p><p>urowid支持逻辑的和物理的rowids。</p></li></ul><table><thead><tr><th><strong>字段类型</strong></th><th><strong>中文说明</strong></th><th><strong>限制条件</strong></th><th><strong>其它</strong></th></tr></thead><tbody><tr><td><strong>CHAR</strong></td><td>固定长度字符串</td><td>最大长度2000 bytes</td><td></td></tr><tr><td><strong>VARCHAR2</strong></td><td>可变长度的字符串</td><td>最大长度4000 bytes</td><td>varchar2中文占2字节，英文占1字节。</td></tr><tr><td><strong>NVARCHAR2</strong></td><td>根据字符集而定的可变长度字符串</td><td>最大长度4000 bytes</td><td>Nvarchar2中英文占一样的字节，具体占多少字节因字符集而定。</td></tr><tr><td><strong>DATE</strong></td><td>日期（日-月-年），时间可有可无</td><td>YYYY-MM-DD（HH24:MI:SS）</td><td></td></tr><tr><td><strong>TIMESTAMP(6)</strong></td><td>时间戳 （年月日时分秒毫秒）</td><td>YYYY-MM-DD HH24:MI:SS.ff</td><td>与DATE数据类型相比，TIMESTAMP类型可以精确到微秒，微秒的精确范围为0-9，默认为6</td></tr><tr><td><strong>LONG</strong></td><td>超长字符串</td><td>最大长度2G</td><td>足够存储大部分著作</td></tr><tr><td><strong>RAW</strong></td><td>固定长度的二进制数据</td><td>最大长度2000 bytes</td><td>可存放多媒体图象声音等</td></tr><tr><td><strong>LONG RAW</strong></td><td>可变长度的二进制数据</td><td>最大长度2G</td><td>同上</td></tr><tr><td><strong>BLOB</strong></td><td>二进制数据</td><td>最大长度4G</td><td></td></tr><tr><td><strong>CLOB</strong></td><td>大字符数据</td><td>最大长度4G</td><td>保存单字节或多字节字符数据，最大值为4G</td></tr><tr><td><strong>NCLOB</strong></td><td>根据字符集而定的字符数据</td><td>最大长度4G</td><td>保存Unicode编码字符数据,最大值为4G。</td></tr><tr><td><strong>BFILE</strong></td><td>存放在数据库外的二进制数据</td><td>最大长度4G</td><td></td></tr><tr><td><strong>NUMBER(P,S)</strong></td><td>数字类型</td><td>P为所有有效数字的位数，S为小数位</td><td>oracle底层只有number为类型并没有decimal和integer这两个类型    这两个类型只为oracle和其它数据库之间方便迁移的。</td></tr><tr><td><strong>DECIMAL(P,S)</strong></td><td>数字类型</td><td>P为所有有效数字的位数，S为小数位</td><td></td></tr><tr><td><strong>INTEGER</strong></td><td>整数类型</td><td>小的整数</td><td></td></tr><tr><td><strong>FLOAT</strong></td><td>浮点数类型</td><td>NUMBER(38)，双精度</td><td>存储近似值</td></tr><tr><td><strong>REAL</strong></td><td>实数类型</td><td>NUMBER(63)，精度更高</td><td>存储近似值</td></tr></tbody></table><h2 id="3-2-DDL-DML-DQL-DCL"><a href="#3-2-DDL-DML-DQL-DCL" class="headerlink" title="3.2 DDL,DML,DQL,DCL"></a>3.2 DDL,DML,DQL,DCL</h2><p>**DDL(Data Definition Language)**<strong>：</strong></p><p>数据定义语言,用于创建对象 如:CREATE TABLE ,ALTER TABLE,DROP TABLE,CREATE VIEW……</p><p>**DML (Data Manipulation Language)**<strong>：</strong></p><p>数据操纵语言，如：INSERT INTO,UPDATE,DELETE……</p><p>**DQL (Data Query Language)**<strong>：</strong></p><p>数据查询语言，如：SELECT……</p><p>**DCL(Data Control Language)**<strong>：</strong></p><p>数据控制语言，控制特定用户对数据表、存储过程、函数等数据库对象的控制权，由 GRANT 和 REVOKE 两个指令组成。</p><h2 id="3-3-命名规范"><a href="#3-3-命名规范" class="headerlink" title="3.3 命名规范"></a>3.3 命名规范</h2><p><strong>表名和列名:</strong></p><p>Ø  必须以字母开头</p><p>Ø  必须在 1–30 个字符之间</p><p>Ø  必须只能包含 A–Z, a–z, 0–9, _, $, 和 #</p><p>Ø  必须不能和用户定义的其他对象重名</p><p>Ø  必须不能是Oracle 的保留字(所有的保留字：select * from v$reserved_words order by keyword asc;)</p><p>Ø  Oracle默认存储是都存为大写</p><p><strong>SQL：</strong></p><p>为了构建易读易编的有效语句，其规则和准则如下：</p><p>Ø  SQL语句是不区分大小写的</p><p>Ø  SQL语句可以是一行，也可以是多行</p><p>Ø  关键字不能在两行之间一分为二或缩写</p><p>Ø  子句通常放在单独的行中，这样可以增强可读性并且易于编辑</p><p>Ø  合理使用缩进 ( 为了增强可读性)</p><h2 id="3-4-DDL"><a href="#3-4-DDL" class="headerlink" title="3.4 DDL"></a>3.4 DDL</h2><h3 id="3-4-1-创建表"><a href="#3-4-1-创建表" class="headerlink" title="3.4.1 创建表"></a>3.4.1 创建表</h3><p>基本格式:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span>  表名 (     列名 类型,     列名 类型,     列名 类型,     ……   )   例如：   <span class="keyword">CREATE</span>  <span class="keyword">TABLE</span>  t_student (     stu_id number(<span class="number">9</span>),     stu_name varchar2(<span class="number">50</span>),     stu_age number(<span class="number">2</span>),     stu_date <span class="type">date</span>     ……   )   </span><br></pre></td></tr></table></figure><p>从已有的数据创建表：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>   <span class="keyword">TABLE</span> stud2 <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stud   </span><br></pre></td></tr></table></figure><h3 id="3-4-2-修改表"><a href="#3-4-2-修改表" class="headerlink" title="3.4.2 修改表"></a>3.4.2 修改表</h3><p>修改表名称:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RENAME  表名 <span class="keyword">to</span> 新表名</span><br></pre></td></tr></table></figure><p>给表添加备注:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">IS</span>  <span class="string">&#x27;表的说明&#x27;</span></span><br></pre></td></tr></table></figure><p>给列添加备注:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> 表名.列名 <span class="keyword">IS</span> <span class="string">&#x27;列的说明&#x27;</span></span><br></pre></td></tr></table></figure><p>修改表结构：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 ……(后面要跟的语句取决写下面的新增<span class="operator">/</span>修改<span class="operator">/</span>删除列的应用场景)</span><br></pre></td></tr></table></figure><p>给表增加列: </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> 列名 列类型</span><br></pre></td></tr></table></figure><p>删除列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">DROP</span>  <span class="keyword">COLUMN</span> 列名</span><br></pre></td></tr></table></figure><p>修改列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">修改列名和列类型</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名  MODIFY 列名 列类型</span><br><span class="line"></span><br><span class="line">更改列名 </span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 RENAME <span class="keyword">COLUMN</span> 旧列名 <span class="keyword">to</span> 新列名</span><br><span class="line"></span><br><span class="line">删除列  </span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">DROP</span> <span class="keyword">COLUMN</span>  列名</span><br></pre></td></tr></table></figure><h3 id="3-4-3-删除表"><a href="#3-4-3-删除表" class="headerlink" title="3.4.3 删除表"></a>3.4.3 删除表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> 表名</span><br></pre></td></tr></table></figure><p>查询用户所有表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_tables</span><br></pre></td></tr></table></figure><h3 id="3-4-4-查看表结构"><a href="#3-4-4-查看表结构" class="headerlink" title="3.4.4 查看表结构"></a>3.4.4 查看表结构</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> table_name,column_name, data_type, data_length, data_precision <span class="keyword">FROM</span> user_tab_columns;</span><br></pre></td></tr></table></figure><p>查看表备注</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_tab_comments</span><br></pre></td></tr></table></figure><p>查看列备注</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_col_comments</span><br></pre></td></tr></table></figure><h2 id="3-5-DML"><a href="#3-5-DML" class="headerlink" title="3.5 DML"></a>3.5 DML</h2><h3 id="3-5-1-向表中写入新数据行-insert"><a href="#3-5-1-向表中写入新数据行-insert" class="headerlink" title="3.5.1 向表中写入新数据行(insert)"></a>3.5.1 向表中写入新数据行(insert)</h3><p>指定列名插值：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span>   <span class="keyword">INTO</span> 表名 (列名<span class="number">1</span>，列名<span class="number">2</span>，列名<span class="number">3.</span>..) VLAUES (列<span class="number">1</span>的值，列<span class="number">2</span>的值，列<span class="number">3</span>的值...) </span><br></pre></td></tr></table></figure><p>向所有列插值：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span>   <span class="keyword">INTO</span> 表名 VLAUES (列<span class="number">1</span>的值，列<span class="number">2</span>的值，列<span class="number">3</span>的值…)      </span><br></pre></td></tr></table></figure><p>插入的结果从其它表查出来：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> temp2  <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> temp2</span><br></pre></td></tr></table></figure><p>注：序列要先创建，创建和使用序列参考<a href="#%E5%BA%8F%E5%88%97">序列章节</a></p><p>插值时使用序列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 (id，列名<span class="number">2</span>，列名<span class="number">3.</span>..) VLAUES (序列名称.NEXTVAL，列<span class="number">2</span>的值，列<span class="number">3</span>的值...)   </span><br></pre></td></tr></table></figure><p>基本格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> 表名 <span class="keyword">SET</span> 字段<span class="number">1</span><span class="operator">=</span>字段<span class="number">1</span>的值，字段<span class="number">2</span><span class="operator">=</span>字段<span class="number">2</span>的值…… <span class="keyword">WHERE</span> 字段<span class="number">1</span><span class="operator">=</span>字段<span class="number">1</span>的值 [<span class="keyword">and</span><span class="operator">/</span><span class="keyword">or</span>] 字段<span class="number">2</span><span class="operator">=</span>字段<span class="number">2</span>的值……</span><br><span class="line">例<span class="number">1</span>：</span><br><span class="line"><span class="keyword">UPDATE</span> t_student  <span class="keyword">SET</span> age<span class="operator">=</span><span class="number">20</span>,name<span class="operator">=</span>’张三’ <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span></span><br><span class="line">更新学生表当中id为<span class="number">1</span>的学生信息为：年龄<span class="number">20</span>岁，姓名张三</span><br><span class="line">例<span class="number">2</span>：</span><br><span class="line"><span class="keyword">UPDATE</span> t_student  <span class="keyword">SET</span> age<span class="operator">=</span><span class="number">20</span>,sex<span class="operator">=</span>’女’ <span class="keyword">WHERE</span> name<span class="operator">=</span>’张三’ <span class="keyword">AND</span> phone<span class="operator">=</span>’<span class="number">13012345678</span>’</span><br><span class="line">更新学生表当中姓名为张三，并且手机号为<span class="number">13012345678</span>为学生信息为：年龄<span class="number">20</span>岁，姓名张三</span><br></pre></td></tr></table></figure><h3 id="3-5-2-删除数据行-delete"><a href="#3-5-2-删除数据行-delete" class="headerlink" title="3.5.2 删除数据行(delete)"></a>3.5.2 删除数据行(delete)</h3><p>基本格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span>字段<span class="number">1</span><span class="operator">=</span>字段<span class="number">1</span>的值 [<span class="keyword">AND</span><span class="operator">/</span><span class="keyword">OR</span>] 字段<span class="number">2</span><span class="operator">=</span>字段<span class="number">2</span>的值……</span><br><span class="line">例如：</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_student <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span></span><br><span class="line">删除id为<span class="number">1</span>的这个学生的信息</span><br></pre></td></tr></table></figure><h3 id="3-5-3-截断表-truncate"><a href="#3-5-3-截断表-truncate" class="headerlink" title="3.5.3 截断表(truncate)"></a>3.5.3 截断表(truncate)</h3><p>基本格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span>表名</span><br></pre></td></tr></table></figure><p>截断表指的是将表恢复到初始新建状态，从表中删除所有的行和重置表的存储区域。</p><h3 id="3-5-4-drop-delete-truncate的区别"><a href="#3-5-4-drop-delete-truncate的区别" class="headerlink" title="3.5.4 drop,delete,truncate的区别"></a>3.5.4 drop,delete,truncate的区别</h3><p>  1.delete和truncate都是只删除表的数据，而不删除表的结构（定义），drop删除数据和定义。</p><p>  2.delete语句是dml,事务提交之后才生效。truncate和drop是ddl，操作立即生效不需提交事务,不能回滚。</p><p>  3.delete如果有相应的trigger,执行的时候将被触发。truncate,drop操作不触发trigger。</p><p>  4.truncate 将表重置回到最开始。而delete只删除数据，不释放存储空间，等待写入新的数据来覆盖旧的数据。 </p><p>  5.速度一般来说: drop&gt; truncate &gt; delete。</p><p>  6.truncate只能删除全部的数据，而delete可以通过where条件来筛选要删除的数据。</p><h2 id="3-6-DQL"><a href="#3-6-DQL" class="headerlink" title="3.6 DQL"></a>3.6 DQL</h2><h3 id="3-6-1-简单查询"><a href="#3-6-1-简单查询" class="headerlink" title="3.6.1 简单查询"></a>3.6.1 简单查询</h3><p>格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 子句 <span class="keyword">from</span> 子句 [<span class="keyword">where</span> 子句 [<span class="keyword">order</span> <span class="keyword">by</span> cloumns [<span class="keyword">asc</span><span class="operator">/</span><span class="keyword">desc</span>]]]</span><br></pre></td></tr></table></figure><p>◆select子句选择要查询的信息（特定列，列所有 * 。使用逗号隔开，可以调整列的先后显示顺序）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">例<span class="number">1</span>,查询所有学生信息：</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student</span><br><span class="line">例<span class="number">2</span>,查询所有学生的id,name,age信息：</span><br><span class="line"><span class="keyword">SELECT</span> id,name,age <span class="keyword">FROM</span> t_student</span><br></pre></td></tr></table></figure><p> ◆from子句选择要查询的表，视图，结果集，dual</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">例<span class="number">1</span>，<span class="keyword">from</span>作用在表上：</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student</span><br><span class="line">例<span class="number">2</span>，<span class="keyword">from</span>作用在视图上(视图后面讲)：</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_student</span><br><span class="line">例<span class="number">3</span>，<span class="keyword">from</span>作用在结果集上：</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student</span><br><span class="line">)</span><br><span class="line">例<span class="number">4</span>，<span class="keyword">from</span>作用在dual上：</span><br><span class="line"><span class="keyword">SELECT</span> sysdate <span class="keyword">FROM</span> DUAL</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span><span class="operator">+</span><span class="number">1</span> <span class="keyword">FROM</span> DUAL</span><br><span class="line">解释：DUAL用在没有查询目标的<span class="keyword">SELECT</span>语句块中</span><br></pre></td></tr></table></figure><p>◆where子句限定限制返回的行,where子句中的多个条件使用 and\or连接。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">例<span class="number">1</span>，查询id为<span class="number">1</span>的学生信息：</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span></span><br><span class="line">例<span class="number">2</span>，查询id为<span class="number">1</span>并且name为张三的学生信息：</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> name<span class="operator">=</span>’张三’</span><br><span class="line">例<span class="number">3</span>，查询name为张三或年龄大于<span class="number">18</span>岁的学生信息：</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_student <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">or</span> age<span class="operator">&gt;</span><span class="number">18</span></span><br></pre></td></tr></table></figure><p>★ 字符类型要用’’括起来，date类型要用to_date函数，时间戳类型要用to_datestamp。字符值区分大小写。</p><p> ★ 当需要使用’时，需要使用’来转义，例如一个单引号’’，两个单引号 ‘’’’</p><h3 id="3-6-2-查询中使用运算符"><a href="#3-6-2-查询中使用运算符" class="headerlink" title="3.6.2 查询中使用运算符"></a>3.6.2 查询中使用运算符</h3><p>sql当中可以使用算术表达式，表达式一般出现在select子句和where子句中。算术表达式可以包含列名、常数值和算术运算符。</p><p>1.算术运算符 + - * &#x2F; 。</p><p>   算术运算符的优先顺序：</p><p>  ◆乘和除的运算优先级高于加和减</p><p>  ◆优先级相同的运算符是从左到右进行运算的</p><p>  ◆可以使用小括号来强制语句做出优先运算，并使语句运算顺序更为清晰</p><p>  ◆日期计算 也可以使用+ -，单位为天（如:select sysdate + 1 from  dual）</p><p>2.连接符 || 或 concat(arg1,arg2)</p><p>3.比较运算符 &lt; ,&gt;  ,&lt;&#x3D; ,&gt;&#x3D; ,&#x3D;,!&#x3D;,&lt;&gt;,is,is not ,in ,not in,any,all,between,like </p><p> ◆LIKE：匹配字符串</p><p> ◆IN：匹配列表值</p><p> ◆BETWEEN：匹配范围值</p><p> ◆IS NULL：匹配空值</p><p> ◆IS NAN：匹配非数字值</p><p>◆NOT 取反</p><p> ◆ANY 任意一个  (select 1 from dual  where 1 &gt; any(1,2,3,4) ) </p><p> ◆ALL 所有的  (select 1 from dual  where 1 &gt; all(1,2,3,4) ) </p><p>4.通配符</p><p>下划线(_)：表示匹配1个字符</p><p>百分号(%)：表示匹配任意个字符</p><p>5.转义</p><p>如果要查询实际的下划线或百分号就需要使用ESCAPE选项区分通配符</p><p>ESCAPE选项告知数据库如何区分通配符和要匹配的字符，例如：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ename  <span class="keyword">FROM</span>  emp  <span class="keyword">WHERE</span> ename  <span class="keyword">LIKE</span>  <span class="string">&#x27;%\%%&#x27;</span>  <span class="keyword">ESCAPE</span>  <span class="string">&#x27;\&#x27;</span></span><br></pre></td></tr></table></figure><p>6.处理NULL值</p><p>NULL值表示未知的值。它是一个特殊的值，但并不是空字符串，NULL值表示该列是未知的。</p><p>NVL(列名, 0)，当时列为NULL时，返回0 </p><p>7.as 可以给列名起一个别名，并且在返回记录时使用别名返回。默认oracle将别名转为大写。如果想自定义别名可以在用””将别名括起来。as可以省略。</p><p>8.DISTINCT 删除重复的行记录，union ,union all</p><p>9.ORDER BY，排序（基本语句: ORDER BY 表达式1 ASC&#x2F;DESC,表达式2 ASC&#x2F;DESC……），多个表达式之间用逗号隔开</p><p> ◆ASC 升序，可省略</p><p> ◆DESC 降序</p><p>10.使用用户输入的参数</p><p>语法：&amp;参数名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">case</span> 列名 </span><br><span class="line"></span><br><span class="line">​            <span class="keyword">when</span> 值<span class="number">1</span> <span class="keyword">then</span> 显示结果<span class="number">1</span></span><br><span class="line"></span><br><span class="line">​            <span class="keyword">when</span> 值<span class="number">2</span> <span class="keyword">then</span> 显示结果<span class="number">2</span></span><br><span class="line"></span><br><span class="line">​            ……</span><br><span class="line"></span><br><span class="line">​           <span class="keyword">else</span> 结果</span><br><span class="line"></span><br><span class="line">​           <span class="keyword">end</span>   </span><br></pre></td></tr></table></figure><h3 id="3-6-3-分页查询"><a href="#3-6-3-分页查询" class="headerlink" title="3.6.3 分页查询"></a>3.6.3 分页查询</h3><p>设：page_no为当前页号，count每页记录数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s2.<span class="operator">*</span> <span class="keyword">from</span> </span><br><span class="line"></span><br><span class="line">(</span><br><span class="line">​    <span class="keyword">select</span> s1.<span class="operator">*</span>,rownum rn <span class="keyword">from</span> (</span><br><span class="line"></span><br><span class="line">​          <span class="keyword">select</span> s.<span class="operator">*</span> <span class="keyword">from</span> student s  <span class="keyword">order</span> <span class="keyword">by</span> s.id</span><br><span class="line"></span><br><span class="line">​    ) s1 </span><br><span class="line">) s2  <span class="keyword">where</span> rn <span class="keyword">between</span> <span class="number">1</span> <span class="operator">+</span> (<span class="operator">&amp;</span>page_no <span class="operator">-</span> <span class="number">1</span>) <span class="operator">*</span> <span class="operator">&amp;</span>count  <span class="keyword">and</span>  <span class="operator">+</span> <span class="operator">&amp;</span>page_no <span class="operator">*</span> <span class="operator">&amp;</span>count</span><br></pre></td></tr></table></figure><h3 id="3-6-4-多表查询"><a href="#3-6-4-多表查询" class="headerlink" title="3.6.4 多表查询"></a>3.6.4 多表查询</h3><p>例题：查询出所有学生信息以及此学生的导员姓名 </p><h4 id="3-6-4-1-交叉连接（笛卡尔积）"><a href="#3-6-4-1-交叉连接（笛卡尔积）" class="headerlink" title="3.6.4.1 交叉连接（笛卡尔积）"></a>3.6.4.1 交叉连接（笛卡尔积）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a,b</span><br><span class="line">或</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a <span class="keyword">cross</span> <span class="keyword">join</span> b  </span><br></pre></td></tr></table></figure><h4 id="3-6-4-2-内连接"><a href="#3-6-4-2-内连接" class="headerlink" title="3.6.4.2 内连接"></a>3.6.4.2 内连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a,b <span class="keyword">where</span> a.fk <span class="operator">=</span> b.pk</span><br><span class="line">或</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a [<span class="keyword">inner</span>] <span class="keyword">join</span> b <span class="keyword">on</span> a.fk <span class="operator">=</span> b.pk    </span><br></pre></td></tr></table></figure><p>内连接又称等值连接</p><h4 id="3-6-4-3-自然连接"><a href="#3-6-4-3-自然连接" class="headerlink" title="3.6.4.3 自然连接"></a>3.6.4.3 自然连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a <span class="keyword">natural</span> <span class="keyword">join</span> b</span><br></pre></td></tr></table></figure><p>自然连接是内连接当中极其特殊的一种，它会自动关联两表当中字段名称和字段类型一模一样的值，也就是说两表当中字段名称和字段类型一模一样的情况下，它会自动加上 on a.fk &#x3D; b.pk。</p><p>自然连接会去除重复的字段</p><h4 id="3-6-4-4-外连接"><a href="#3-6-4-4-外连接" class="headerlink" title="3.6.4.4 外连接"></a>3.6.4.4 外连接</h4><h5 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a <span class="keyword">left</span> [<span class="keyword">outer</span>] <span class="keyword">join</span> b <span class="keyword">on</span> a.pk <span class="operator">=</span> b.fk    </span><br></pre></td></tr></table></figure><h5 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a <span class="keyword">right</span>[<span class="keyword">outer</span>] <span class="keyword">join</span> b <span class="keyword">on</span> a.pk <span class="operator">=</span> b.fk    </span><br></pre></td></tr></table></figure><h5 id="全外连接"><a href="#全外连接" class="headerlink" title="全外连接"></a>全外连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> a <span class="keyword">full</span> [<span class="keyword">outer</span>] <span class="keyword">join</span> b <span class="keyword">on</span> a.pk <span class="operator">=</span> b.fk</span><br></pre></td></tr></table></figure><h4 id="3-6-4-5-子查询"><a href="#3-6-4-5-子查询" class="headerlink" title="3.6.4.5 子查询"></a>3.6.4.5 子查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.<span class="operator">*</span>,(<span class="keyword">select</span> b.x <span class="keyword">from</span> b <span class="keyword">where</span> b.fk<span class="operator">=</span>a.pk)  <span class="keyword">from</span> a</span><br></pre></td></tr></table></figure><h4 id="3-6-4-6-exists运算符"><a href="#3-6-4-6-exists运算符" class="headerlink" title="3.6.4.6 exists运算符"></a>3.6.4.6 exists运算符</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual  <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual <span class="keyword">where</span> <span class="number">1</span><span class="operator">&gt;</span> <span class="keyword">any</span>(<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">查询有挂科的学生: <span class="keyword">select</span> s.<span class="operator">*</span> <span class="keyword">from</span> student s <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> subject su <span class="keyword">where</span> su.score <span class="operator">&lt;</span> <span class="number">60</span> <span class="keyword">and</span> su.stu_id <span class="operator">=</span> s.id)</span><br></pre></td></tr></table></figure><h1 id="四、函数"><a href="#四、函数" class="headerlink" title="四、函数"></a>四、函数</h1><h2 id="4-1-单行函数（单行函数只处理单个行，并且为每行返回一个结果）"><a href="#4-1-单行函数（单行函数只处理单个行，并且为每行返回一个结果）" class="headerlink" title="4.1 单行函数（单行函数只处理单个行，并且为每行返回一个结果）"></a>4.1 单行函数（单行函数只处理单个行，并且为每行返回一个结果）</h2><p> 1.1字符函数</p><p> ◆CONCAT(x,y),将x和y拼接起来，并返回新字符串</p><p> ◆INITCAP(x)将字符串转换为每个词首字母为大写，其他字母为小写</p><p> ◆INSTR(str,  find_string  [,  start]   [,  count])</p><p>​    返回指定字符串find_string在str中的位置。可以指定开始搜索的位置start，也可以提供该字符串出现的次数(第)count（次）。</p><p>​    start和count默认为1，表示从字符串开始的位置开始搜索，并返回第一次出现的位置</p><p> ◆LENGTH(x) 返回表达式中的字符数</p><p> ◆LOWER(x) ,UPPER(x) 转换大小写</p><p> ◆LPAD(x,  width  [,  pad_string])，RPAD(x,  width  [,  pad_string]) 在字符串左&#x2F;右侧填充pad_string字符，以使总字符宽度为width，默认填充空格,汉字占2位</p><p> ◆LTRIM(x [,  trim_string]),RTRIM(x [,  trim_string]),TRIM(trim_string FROM x)，从x字符串左&#x2F;右侧&#x2F;两端去除所有的trim_string字符串，默认去除空格</p><p> ◆NVL(x,  value)  将一个NULL值转换为另外一个值。如果x是NULL值的话返回value值，否则返回x值本身</p><p> ◆NVL2(x,  value1,  value2) 如果x不为NULL值，返回value1，否则返回value2</p><p> ◆REPLACE(x,  search_string,  replace_string) 从字符串x中搜索search_string字符串，并使用replace_string字符串替换</p><p> ◆SUBSTR(x,  start  [,  length]) 返回字符串中的指定的字符，</p><p>​    ★从start个位置开始</p><p>​    ★长度为length个字符</p><p>​    ★如果length省略,则将返回一直到字符串末尾的所有字符</p><p>★如果start是负数，则从末尾开始算起</p><p>1.2数字函数</p><p> ◆ABS(value) 返回value的绝对值</p><p> ◆CEIL(value) 返回大于或等于value的最小整数 如: SELECT CEIL(5.8),CEIL(-5.2) FROM dual;  返回：6 和 -5</p><p> ◆FLOOR(value) 返回小于或等于value的最大整数  如: SELECT FLOOR(5.8),FLOOR(-5.2) FROM dual; 返回：5 和 -6</p><p> ◆POWER(value,n) 返回value的n次幂</p><p> ◆MOD(m,n) 返回m和n取余数的结果</p><p> ◆SQRT(value) 对value进行开平方</p><p> ◆TRUNC(value,n) 对value进行截断</p><p>  ★ n&gt;0，保留n位小数； TRUNC(5.75，1) &#x3D;&#x3D;&gt; 5.7</p><p>  ★ n&lt;0，则保留-n位整数位(小数点左边指定位数后面的部分截去，均以0记)； TRUNC(5.75，-1) &#x3D;&#x3D;&gt; 0  截整数部分，只保留整数，自右往左截-n位</p><p>  ★ n&#x3D;0，则去掉小数部分 TRUNC(5.75，0) &#x3D;&#x3D;&gt; 5 </p><p> ◆ROUND(value[,n]) 对value进行四舍五入，保存小数点右侧的n位。</p><p>  ★ n&gt;0，保留n位小数；ROUND(5.75,1)&#x3D;&#x3D;&gt; 5.8</p><p>  ★ n&lt;0，则保留-n位整数位(小数点左边指定位数后面的部分四舍五入)； ROUND(5.75,-1) &#x3D;&#x3D;&gt; 10</p><p>  ★ n&#x3D;0，则去掉小数部分 ROUND(5.75)&#x3D;&#x3D;&gt; 5</p><p>​     如果n不填，则n默认为0.</p><p>1.3转换函数 （将值从一种类型转换成另外一种类型，或者从一种格式转换为另外一种格式）</p><p> ◆TO_CHAR(x [,  format])  将x转化为字符串。 format为转换的格式，可以为数字格式或日期格式</p><p>  ★数字格式  SELECT TO_CHAR(12345.67, ‘99,999.99’) FROM dual;</p><p>​    ☆ 9 确定宽度，前导补空，后导补0</p><p>​    ☆ 0 确定宽度，前后导都补0</p><p>​    ☆ $ 美元</p><p>​    ☆ L 当地的货币符号</p><p>​    ☆ . 小数点</p><p>​    ☆ ,分隔符</p><p>  ★日期格式  select to_char(sysdate,’yyyy-mm-dd hh24:mi:ss’) from dual</p><p>​    ☆ q 季度1-4 </p><p>​    ☆ ww 年里面的第几周</p><p>​    ☆ 当前时间减去7分钟的时间  sysdate - interval ‘7’ MINUTE </p><p>​    ☆ 当前时间减去7小时的时间  sysdate - interval ‘7’ hour</p><p>​    ☆ 当前时间减去7天的时间     sysdate - interval ‘7’ day</p><p>​    ☆ 当前时间减去7月的时间     sysdate - interval ‘7’ month</p><p>​    ☆ 当前时间减去7年的时间     sysdate - interval ‘7’ year</p><p>​    ☆ 时间间隔乘以一个数字       sysdate - 8*interval ‘7’ hour</p><p>◆TO_DATE(x [,format]) 将x字符串转换为日期</p><p>​    规则同TO_CHAR</p><p>​    ☆  TO_DATE(‘2012-3-15’,’YYYY-MM-DD‘) </p><p>◆TO_NUMBER(x [,  format]) 将x转换为数字。可以指定format格式</p><p>​    ☆ TO_NUMBER(‘970.13’) + 25.5 </p><p>​    ☆ TO_NUMBER(‘$12,345.67’, ‘$99,999.99’) ,  TO_NUMBER(‘￥12,345.67’, ‘L99,999.99’)</p><p>☆ TO_NUMBER(to_char(sysdate, ‘yyyy’))</p><p>◆CAST(x  AS  type) 将x转换为指定的兼容的数据库类型</p><p>☆ CAST(12345.67 AS VARCHAR2(10) )</p><p> ☆ CAST(‘05-7月-07’ AS DATE)</p><p>☆ CAST(12345.678 AS NUMBER(10,2))      </p><h2 id="4-2-聚集函数（亦称分组函数、聚合函数。聚集函数可以对行集进行操作，并且为每组给出一个结果）"><a href="#4-2-聚集函数（亦称分组函数、聚合函数。聚集函数可以对行集进行操作，并且为每组给出一个结果）" class="headerlink" title="4.2 聚集函数（亦称分组函数、聚合函数。聚集函数可以对行集进行操作，并且为每组给出一个结果）"></a>4.2 聚集函数（亦称分组函数、聚合函数。聚集函数可以对行集进行操作，并且为每组给出一个结果）</h2><p>格式：select 组函数（表达式）&#x2F;表达式 from 子句 group by 表达式</p><p><strong>注意：</strong>非group by 中出现的表达式 如果要出现在select当中，必须使用组函数</p><p>  ★ 聚集函数可以使用任何有效的表达式</p><p>  ★ NULL值在聚集函数中将被忽略</p><p>  ★ 可以在聚集函数中使用DISTINCT关键字，排除重复值</p><p>★ 筛选条件如果使用了组函数，则应使用having筛选</p><p> ◆AVG(x)：返回x的平均值</p><p> ◆COUNT(x)：返回统计的行数</p><p> ◆MAX(x)：返回x的最大值</p><p> ◆MIN(x)：返回x的最小值</p><p> ◆SUM(x)：返回x的总计值</p><p> ◆MEDIAN(x)：返回中间值</p><p> ◆STDDEV(x)：返回标准偏差</p><p> ◆VARIANCE(x)：返回x的方差</p><p>聚集函数的分组应用，有时需要对表中的行进行分组，然后统计每组的信息：</p><p>  例如：</p><p>1.统计学生的人数，按性别进行统计，可以使用GROUP BY进行分组  SELECT sex  FROM student GROUP BY sex</p><p>2.统计每个导师带的所有学生的每个科目的平均&#x2F;最高&#x2F;最低&#x2F;总成绩，并按对应成绩排序,并且只要平均成绩大于60分的记录</p><p>3.统计每个商品分类下的所有商品的每个月份的平均&#x2F;最高&#x2F;最低&#x2F;总销量，并按对应销量排序,并且只要平均销量低于10000件的记录</p><p>4.统计每个员工的每年里哪个一月工资最低（如果有不同的月都是最低工资，则取离当前时间较近的一个月），并且显示此月工资是多少（每月工资不固定）</p><h1 id="五、数据完整性-约束"><a href="#五、数据完整性-约束" class="headerlink" title="五、数据完整性(约束)"></a>五、数据完整性(约束)</h1><p>数据完整性(Data Integrity)是指数据的精确性(Accuracy)和可靠性(Reliability)，它是防止数据库中存在不符合语义规定的数据和因错误信息的输入造成无效操作或错误信息而提出的。</p><p>例如：</p><p>1.数据类型 年龄使用什么类型？</p><p>2.格式是否正确 身份证号，可以是15位也可以是18位</p><p>3.范围 性别可选择“男”、“女”</p><p>4.是否允许重复 银行卡号不允许重复</p><p>数据完整性分为三类：</p><h2 id="5-1-实体完整性（Entity-Integrity）"><a href="#5-1-实体完整性（Entity-Integrity）" class="headerlink" title="5.1 实体完整性（Entity Integrity）"></a>5.1 实体完整性（Entity Integrity）</h2><p>  实体完整性要求每一个表中的主键字段都不能为空（非空）或者重复的值（唯一）。</p><p>  ★ 唯一约束(UNIQUE)</p><p>  ★ 主键约束(PRIMARY KEY)</p><p>隐含非空约束和唯一约束</p><h2 id="5-2-域完整性（Domain-Integrity）"><a href="#5-2-域完整性（Domain-Integrity）" class="headerlink" title="5.2 域完整性（Domain Integrity）"></a>5.2 域完整性（Domain Integrity）</h2><p> 域完整性指列的值域的完整性。如数据类型、格式、值域范围、是否允许空值等</p><p> ★限制数据类型（检查约束 CHECK） </p><p>示例:</p><p>1）check(列名 in(值1,值2……))  </p><p>2）check (列名&gt;&#x3D;0 and 列名&lt;&#x3D;100) </p><p>3）check(name like ‘M%’)</p><p> ★默认值 (DEFAULT)  没有约束名称，也不能用CONSTRAINT关键字</p><p> ★非空约束(NOT NULL) 没有约束名称，也不能用CONSTRAINT关键字</p><h2 id="5-3-参照完整性-Referential-Integrity"><a href="#5-3-参照完整性-Referential-Integrity" class="headerlink" title="5.3 参照完整性(Referential Integrity)"></a>5.3 参照完整性(Referential Integrity)</h2><p> 外键约束(FOREIGN KEY)   </p><p>完整语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CONSTRAINT</span> 约束名称 <span class="keyword">FOREIGN</span> KEY (列名)  <span class="keyword">REFERENCES</span> 引用表名 (引用列名)</span><br></pre></td></tr></table></figure><p>建表语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> 表名(列 类型 <span class="keyword">REFERENCES</span> 引用表名 (引用主键)) 注意，没有 <span class="keyword">CONSTRAINT</span> 约束名称 <span class="keyword">FOREIGN</span> KEY,也就是说：不支持对约束命名，也不用写出<span class="keyword">FOREIGN</span> KEY</span><br></pre></td></tr></table></figure><p>★当更新、删除、插入一个表中的数据时，通过参照引用相互关联的另一个表中的数据，来检查对表的数据操作是否正确。</p><p> ★引用完整性要求关系中不允许引用不存在的实体。</p><p> ★引用完整性与实体完整性是关系模型必须满足的完整性约束条件。</p><h2 id="5-4-添加约束"><a href="#5-4-添加约束" class="headerlink" title="5.4 添加约束"></a>5.4 添加约束</h2><p>1.先建表，后创建约束</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> 约束名称 约束类型  (列名) </span><br></pre></td></tr></table></figure><p>2.建表时直接加约束(不适用外键约束，外键有它自已的格式):</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span>表名(</span><br><span class="line">列名 类型 [<span class="keyword">CONSTRAINT</span> 约束名称] 约束类型</span><br><span class="line">)</span><br><span class="line">          <span class="keyword">CREATE</span> <span class="keyword">TABLE</span>表名(</span><br><span class="line">列名 类型 ,</span><br><span class="line">           [<span class="keyword">CONSTRAINT</span> 约束名称] 约束类型(列名)</span><br><span class="line">)</span><br><span class="line">          <span class="keyword">CREATE</span> <span class="keyword">TABLE</span>表名(</span><br><span class="line">列名 类型 约束类型  <span class="comment">--这种格式仅适用于非空和默认值,非空和默认值可以同时存在，例如：sex number(1) not null defalut 1</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="5-5-删除约束"><a href="#5-5-删除约束" class="headerlink" title="5.5 删除约束"></a>5.5 删除约束</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">drop</span> <span class="keyword">CONSTRAINT</span> 约束名称</span><br></pre></td></tr></table></figure><h2 id="5-6-启用约束"><a href="#5-6-启用约束" class="headerlink" title="5.6 启用约束"></a>5.6 启用约束</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名  MODIFY <span class="keyword">CONSTRAINT</span> 约束名称 enable</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名  MODIFY 列名  <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名  MODIFY 列名  <span class="keyword">default</span> 值</span><br></pre></td></tr></table></figure><h2 id="5-7-禁用约束"><a href="#5-7-禁用约束" class="headerlink" title="5.7 禁用约束"></a>5.7 禁用约束</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名  MODIFY <span class="keyword">CONSTRAINT</span> 约束名称 disable</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名  MODIFY 列名   <span class="keyword">null</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名  MODIFY 列名  <span class="keyword">default</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure><h2 id="5-8-查询约束"><a href="#5-8-查询约束" class="headerlink" title="5.8 查询约束"></a>5.8 查询约束</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TABLE_NAME , CONSTRAINT_NAME，CONSTRAINT_TYPE,STATUS <span class="keyword">FROM</span> USER_CONSTRAINTS</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> USER_CONS_COLUMNS</span><br></pre></td></tr></table></figure><h1 id="六、级联"><a href="#六、级联" class="headerlink" title="六、级联"></a>六、级联</h1><p><strong>级联删除：</strong></p><p>在创建外键约束时可以添加ON DELETE CASCADE选项，那么当主表的数据被删除时，子表对应的行同样也自动被删除。</p><p><strong>级联更新：</strong></p><p>在创建外键约束时可以添加ON DELETE SET NULL选项，那么当主表的数据被删除时，子表匹配的相关行的列会被设置为NULL值，而不是被删除。</p><h1 id="七、范式"><a href="#七、范式" class="headerlink" title="七、范式"></a>七、范式</h1><h2 id="7-1-第一范式"><a href="#7-1-第一范式" class="headerlink" title="7.1 第一范式"></a>7.1 第一范式</h2><p>对于表中的每一行，必须且仅仅有唯一的行值。在一行中的每一列仅有唯一的值并且具有原子性。</p><p>◆<strong>有主键（必须且仅仅有唯一的行值）</strong></p><p>◆<strong>字段不可以再拆分（每一列仅有唯一的值并且具有原子性）</strong></p><p>   比如，联系方式：<a href="mailto:&#50;&#x34;&#x30;&#52;&#x30;&#x34;&#56;&#54;&#64;&#113;&#113;&#46;&#99;&#x6f;&#109;">&#50;&#x34;&#x30;&#52;&#x30;&#x34;&#56;&#54;&#64;&#113;&#113;&#46;&#99;&#x6f;&#109;</a>，18502999999 不符哈第一范式。因为联系方式可以拆分为Email和电话。并且具有两个值。</p><h2 id="7-2-第二范式"><a href="#7-2-第二范式" class="headerlink" title="7.2 第二范式"></a>7.2 第二范式</h2><p>非主键列是主键的子集，非主键列活动必须完全依赖整个主键。</p><p>◆<strong>表不可以再拆分(表的原子性)</strong></p><p>非主键列是主键的子集不相关的信息不要放到一张表，确保表中的每列都和主键相关。 错误示例：</p><table><thead><tr><th>STU_ID</th><th>STU_NAME</th><th>STU_AGE</th><th>TEA_NAME</th><th>TEA_SEX</th></tr></thead><tbody><tr><td>1</td><td>张三</td><td>20</td><td>张老师</td><td>男</td></tr><tr><td>2</td><td>李四</td><td>20</td><td>张老师</td><td>男</td></tr><tr><td>3</td><td>王五</td><td>20</td><td>李老师</td><td>女</td></tr><tr><td>4</td><td>赵六</td><td>20</td><td>李老师</td><td>女</td></tr></tbody></table><p>两处不合理：</p><p> 1.教师跟学生是不相关的两种信息，不应放在一张表里 </p><p> 2.教师姓名和教师性别和学生存在传递关系，导致教师信息重复</p><p>拆分成两张表，满足第二范式后，区别一目了然：</p><table><thead><tr><th>STU_ID</th><th>STU_NAME</th><th>STU_AGE</th><th>TEA_ID</th></tr></thead><tbody><tr><td>1</td><td>张三</td><td>20</td><td>1</td></tr><tr><td>2</td><td>李四</td><td>20</td><td>1</td></tr><tr><td>3</td><td>王五</td><td>20</td><td>2</td></tr><tr><td>4</td><td>赵六</td><td>20</td><td>2</td></tr></tbody></table><table><thead><tr><th>TEA_ID</th><th>TEA_NAME</th><th>TEA_SEX</th></tr></thead><tbody><tr><td>1</td><td>张老师</td><td>男</td></tr><tr><td>2</td><td>李老师</td><td>女</td></tr></tbody></table><h2 id="7-3-第三范式"><a href="#7-3-第三范式" class="headerlink" title="7.3 第三范式"></a>7.3 第三范式</h2><p>◆非主键列互不依赖</p><p>例如：</p><table><thead><tr><th>STU_ID</th><th>STU_NAME</th><th>STU_SCORE</th><th>SCORE_LEVEL</th></tr></thead><tbody><tr><td>1</td><td>张三</td><td>100</td><td>优秀</td></tr><tr><td>2</td><td>李四</td><td>80</td><td>良好</td></tr><tr><td>3</td><td>王五</td><td>80</td><td>良好</td></tr><tr><td>4</td><td>赵六</td><td>60</td><td>及格</td></tr></tbody></table><p>分数和等级都是非主属性，但确产生了依赖。</p><p>消除依赖：</p><table><thead><tr><th>STU_ID</th><th>STU_NAME</th><th>STU_SCORE</th><th>SCORE_LEVEL</th></tr></thead><tbody><tr><td>1</td><td>张三</td><td>100</td><td>1</td></tr><tr><td>2</td><td>李四</td><td>80</td><td>2</td></tr><tr><td>3</td><td>王五</td><td>80</td><td>2</td></tr><tr><td>4</td><td>赵六</td><td>60</td><td>3</td></tr></tbody></table><table><thead><tr><th>LEVEL_ID</th><th>SCORE_LEVEL</th></tr></thead><tbody><tr><td>1</td><td>优秀</td></tr><tr><td>2</td><td>良好</td></tr><tr><td>3</td><td>及格</td></tr><tr><td>4</td><td>不及格</td></tr></tbody></table><h1 id="八、-表关系设计"><a href="#八、-表关系设计" class="headerlink" title="八、 表关系设计"></a>八、 表关系设计</h1><p>★一对多</p><p>多的一方引用一的一方</p><p>★一对一</p><p>两表共用主键</p><p>★多对多</p><p>通过第三张表实现，建立两个一对多的关系</p><h1 id="九、-PLSQL"><a href="#九、-PLSQL" class="headerlink" title="九、 PLSQL"></a>九、 PLSQL</h1><p>PL&#x2F;SQL(Procedural Language&#x2F;Structured Query Language，过程语言&#x2F;结构化查询语言)</p><h2 id="9-1-PL-x2F-SQL基本格式"><a href="#9-1-PL-x2F-SQL基本格式" class="headerlink" title="9.1 PL&#x2F;SQL基本格式"></a>9.1 PL&#x2F;SQL基本格式</h2><p>PL&#x2F;SQL的块由变量声明、程序代码和异常处理代码3部分组成：</p><p>DECLARE (声明)</p><p>  声明一些变量、常量、用户定义的数据类型及游标:</p><p>  name varchar(30); –声明时不设置值</p><p>  name varchar(30):&#x3D;‘Jack’;–声明带有默认值</p><p>  name preson.name%type; –直接引用一个表的数据类型</p><p>BEGIN （主体）</p><p>  主程序体，在这里可以加入各种合法语句</p><p>EXCEPTION （异常处理）</p><p>  异常处理程序，当程序中出现错误时执行这一部分</p><p>END （结束）</p><h2 id="9-2-PL-x2F-SQL有效字符"><a href="#9-2-PL-x2F-SQL有效字符" class="headerlink" title="9.2 PL&#x2F;SQL有效字符"></a>9.2 PL&#x2F;SQL有效字符</h2><p> 1.大小写英文字母</p><p> 2.0~9的阿拉伯数字</p><p> 3.下划线</p><p> 4.操作符，包括+、-、*、&#x2F;、&lt;、&gt;、!、&#x3D;、@、%等</p><p> 5.最大长度为30个字符，不区分大小写，但建议适当使用大小写，增加程序的可读性</p><h2 id="9-3-变-x2F-常量声明"><a href="#9-3-变-x2F-常量声明" class="headerlink" title="9.3 变&#x2F;常量声明"></a>9.3 变&#x2F;常量声明</h2><p>Declare 声明变量（char, varchar2, date, number, boolean, long,integer,type,rowtype)</p><p>  varl             char(15);</p><p>  married          boolean :&#x3D; true;</p><p>  psal             number(7,2);</p><p>  my_name          emp.ename%type;  引用型变量，即my_name的类型与emp表中ename列的类型一样</p><p>  emp_rec          emp%row type;     记录集型变量</p><p>  记录变量分量的引用： emp_rec.ename:&#x3D;’ADAMS’;</p><p>声明常量:  常量名 constant 数据类型 :&#x3D; 值; </p><p>  常量一旦定义，在以后的使用中其值不再改变，一些固定的大小为了防止有人改变，定义成常量。</p><p>  例如 pass_score constant INTEGER :&#x3D; 60 ;</p><h2 id="9-4-输出"><a href="#9-4-输出" class="headerlink" title="9.4 输出"></a>9.4 输出</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> severoutput <span class="keyword">on</span> <span class="comment">--SQL*Plus需要, PL/SQL Developer不需要</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">​    name <span class="type">varchar</span>(<span class="number">10</span>):<span class="operator">=</span><span class="string">&#x27;HelloWorld&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">​     dbms_output.put(<span class="string">&#x27;test:&#x27;</span>); <span class="comment">--不换行输出，不能单独工作</span></span><br><span class="line"></span><br><span class="line">​     dbms_output.put_line(name); <span class="comment">--换行输出</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="9-5-接收用户的输入赋值-amp-变量名称"><a href="#9-5-接收用户的输入赋值-amp-变量名称" class="headerlink" title="9.5 接收用户的输入赋值 &amp;变量名称"></a>9.5 接收用户的输入赋值 &amp;变量名称</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">​    <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">​           dbms_output.put_line(<span class="string">&#x27;你输入的值是:&#x27;</span> <span class="operator">||</span> <span class="string">&#x27;&amp;word&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="9-6-into赋值"><a href="#9-6-into赋值" class="headerlink" title="9.6 into赋值"></a>9.6 into赋值</h2><p>用into关键字可以将查询结果的值，赋给变量:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">​    name varchar2(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">​    id number;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">​     <span class="keyword">select</span> id,name <span class="keyword">into</span> id,name <span class="keyword">from</span> student <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">​     dbms_output.put_line(<span class="string">&#x27;id的值:&#x27;</span><span class="operator">||</span>id <span class="operator">||</span><span class="string">&#x27;,name的值:&#x27;</span><span class="operator">||</span> name);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="9-7-流程控制"><a href="#9-7-流程控制" class="headerlink" title="9.7 流程控制"></a>9.7 流程控制</h2><h3 id="9-7-1-if…then…"><a href="#9-7-1-if…then…" class="headerlink" title="9.7.1 if…then…"></a>9.7.1 if…then…</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if...then... </span><br><span class="line"></span><br><span class="line">elsif... then... </span><br><span class="line"></span><br><span class="line">else...</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> if;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">1</span>：</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">   score number :<span class="operator">=</span> <span class="operator">&amp;</span>score;<span class="comment">--从控制台输入一个分数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">​    if score <span class="operator">&lt;</span> <span class="number">60</span>  <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(<span class="string">&#x27;不及格&#x27;</span>);</span><br><span class="line"></span><br><span class="line">​        elsif score <span class="operator">&lt;=</span> <span class="number">70</span> <span class="keyword">then</span>  <span class="comment">/*注意:是elsif不是elseif！*/</span>      </span><br><span class="line"></span><br><span class="line">​         dbms_output.put_line(<span class="string">&#x27;及格&#x27;</span>);</span><br><span class="line"></span><br><span class="line">​     elsif score <span class="operator">&lt;=</span> <span class="number">80</span> <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(<span class="string">&#x27;良&#x27;</span>);</span><br><span class="line"></span><br><span class="line">​    <span class="keyword">else</span>  <span class="comment">/*注意:else没有then！*/</span>   </span><br><span class="line"></span><br><span class="line">​       dbms_output.put_line(<span class="string">&#x27;优秀&#x27;</span>);</span><br><span class="line"></span><br><span class="line">​    <span class="keyword">end</span> if;  <span class="comment">/*注意:所有的成块的代码 都要end！*/</span>   </span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">2</span>：</span><br><span class="line"></span><br><span class="line"> <span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">   score number;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">​    <span class="keyword">select</span> score <span class="keyword">into</span> score <span class="keyword">from</span> student <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;<span class="operator">/</span><span class="operator">/</span>从学生表里查分数</span><br><span class="line"></span><br><span class="line">​    if score <span class="operator">&lt;</span> <span class="number">60</span>  <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(<span class="string">&#x27;不及格&#x27;</span>);</span><br><span class="line"></span><br><span class="line">​    elsif score <span class="operator">&lt;=</span> <span class="number">70</span> <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(<span class="string">&#x27;及格&#x27;</span>);</span><br><span class="line"></span><br><span class="line">​    elsif score <span class="operator">&lt;=</span> <span class="number">80</span> <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(<span class="string">&#x27;良&#x27;</span>);</span><br><span class="line"></span><br><span class="line">​    </span><br><span class="line"></span><br><span class="line">​    <span class="keyword">else</span> </span><br><span class="line"></span><br><span class="line">​       dbms_output.put_line(<span class="string">&#x27;优秀&#x27;</span>);</span><br><span class="line"></span><br><span class="line">​    <span class="keyword">end</span> if;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h3 id="9-7-2-case-when…then…"><a href="#9-7-2-case-when…then…" class="headerlink" title="9.7.2 case when…then…"></a>9.7.2 case when…then…</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span>  var  </span><br><span class="line"></span><br><span class="line"><span class="keyword">when</span> … <span class="keyword">then</span>    </span><br><span class="line"></span><br><span class="line"><span class="keyword">when</span> … <span class="keyword">then</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> (类似于三元表达式，只能赋值，不能有动作) </span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">1</span>: <span class="keyword">sql</span>语句当中</span><br><span class="line"></span><br><span class="line">​    <span class="keyword">select</span>  </span><br><span class="line"></span><br><span class="line">​    <span class="keyword">case</span>  sex  </span><br><span class="line"></span><br><span class="line">​      <span class="keyword">when</span> <span class="number">0</span> <span class="keyword">then</span>  <span class="string">&#x27;男&#x27;</span></span><br><span class="line"></span><br><span class="line">​      <span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span>  <span class="string">&#x27;女&#x27;</span></span><br><span class="line"></span><br><span class="line">​      <span class="keyword">else</span> <span class="string">&#x27;未知&#x27;</span></span><br><span class="line"></span><br><span class="line">​      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">​     <span class="keyword">from</span> student <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>; </span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">2</span>:PL<span class="operator">/</span><span class="keyword">SQL</span>当中</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">   sex number;</span><br><span class="line"></span><br><span class="line">   res varchar2(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">​    <span class="keyword">select</span> sex <span class="keyword">into</span> sex <span class="keyword">from</span> student <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">res :<span class="operator">=</span> (</span><br><span class="line"></span><br><span class="line">​    <span class="keyword">case</span>    </span><br><span class="line"></span><br><span class="line">​      <span class="keyword">when</span> sex <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line"></span><br><span class="line">​      <span class="keyword">when</span> sex <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span>  <span class="string">&#x27;女&#x27;</span></span><br><span class="line"></span><br><span class="line">​      <span class="keyword">when</span> sex <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="string">&#x27;没有值&#x27;</span></span><br><span class="line"></span><br><span class="line">​      <span class="keyword">else</span> <span class="string">&#x27;未知&#x27;</span></span><br><span class="line"></span><br><span class="line">​      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(res);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h3 id="9-7-3-for循环"><a href="#9-7-3-for循环" class="headerlink" title="9.7.3 for循环"></a>9.7.3 for循环</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 变量 <span class="keyword">in</span> 起始值..结束值</span><br><span class="line"></span><br><span class="line">loop</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> loop </span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">1</span>：输出一列<span class="operator">*</span>:</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span></span><br><span class="line"></span><br><span class="line">loop</span><br><span class="line"></span><br><span class="line">   dbms_output.put_line(<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h3 id="9-7-4-loop循环-自动退出"><a href="#9-7-4-loop循环-自动退出" class="headerlink" title="9.7.4 loop循环(自动退出)"></a>9.7.4 loop循环(自动退出)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> loop </span><br><span class="line"></span><br><span class="line">exit <span class="keyword">when</span> ...; </span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> loop; </span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">1</span>：输出<span class="number">1</span><span class="number">-9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">i number :<span class="operator">=</span> <span class="number">1</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">loop</span><br><span class="line"></span><br><span class="line">  dbms_output.put_line(i);</span><br><span class="line"></span><br><span class="line">  i :<span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  exit <span class="keyword">when</span> i <span class="operator">&gt;</span> <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> loop;    </span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h3 id="9-7-5-loop循环-手动退出"><a href="#9-7-5-loop循环-手动退出" class="headerlink" title="9.7.5 loop循环(手动退出)"></a>9.7.5 loop循环(手动退出)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">loop  </span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>exit;  执行exit则退出</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> loop  </span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">1</span>：输出<span class="number">1</span><span class="number">-9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">y number :<span class="operator">=</span> <span class="number">1</span>;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">loop</span><br><span class="line"></span><br><span class="line">  dbms_output.put_line(y);</span><br><span class="line"></span><br><span class="line">  y :<span class="operator">=</span> y <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  if y <span class="operator">&gt;</span> <span class="number">9</span> <span class="keyword">then</span> </span><br><span class="line"></span><br><span class="line">​    exit;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span> if;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> loop;    </span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h3 id="9-7-6-while循环"><a href="#9-7-6-while循环" class="headerlink" title="9.7.6 while循环"></a>9.7.6 while循环</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WHILE...</span><br><span class="line">LOOP...</span><br><span class="line"><span class="keyword">END</span> LOOP</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">1</span>：输出<span class="number">1</span><span class="number">-9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line">y number :<span class="operator">=</span> <span class="number">1</span>;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">WHILE y <span class="operator">&lt;=</span> <span class="number">9</span></span><br><span class="line"></span><br><span class="line">LOOP  </span><br><span class="line"></span><br><span class="line">​    dbms_output.put_line(y);</span><br><span class="line"></span><br><span class="line">​     y :<span class="operator">=</span> y <span class="operator">+</span> <span class="number">1</span>; </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="9-8-异常处理"><a href="#9-8-异常处理" class="headerlink" title="9.8 异常处理"></a>9.8 异常处理</h2><h3 id="9-8-1-预定义异常"><a href="#9-8-1-预定义异常" class="headerlink" title="9.8.1 预定义异常"></a>9.8.1 预定义异常</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">EXCEPTION</span><br><span class="line"></span><br><span class="line">​        <span class="keyword">WHEN</span> 异常名称 <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             <span class="comment">--异常处理语句</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--异常可使用SQLCODE输出错误编码，以及使用SQLERRM来输出错误信息：</span></span><br><span class="line"></span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;值类型错误&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);</span><br><span class="line"></span><br><span class="line">​        <span class="keyword">WHEN</span> 异常名称 <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             异常处理语句</span><br><span class="line"></span><br><span class="line">​        ………</span><br><span class="line"></span><br><span class="line">​       <span class="keyword">WHEN</span> OTHERS <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             异常处理语句</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure><p>所有异常种类：</p><p>ACCESS_INTO_NULL  在未初始化对象时出现</p><p>CASE_NOT_FOUNF   在CASE语句中的选项与用户输入的数据不匹配时出现</p><p>COLLECTION_IS_NULL 在给尚未初始化的表或数组赋值时出现</p><p>CURSOR_ALREADY_OPEN 用户试图重新打开已经打开的游标时出现。在重新打开游标前必须先将其关闭</p><p>INVALID_CURSOR 在执行非法游标运算(如fetch一个尚未打开的游标)时出现</p><p>LOGIN_DENIED 输入的用户名或密码无效时出现</p><p>SOTRAGE_ERROR 在内存损坏或PL&#x2F;SQL耗尽内存时出现</p><p><strong>DUP_VAL_ON_INDEX</strong> 用户试图将重复的(duplicate)值存储在使用唯一索引的数据库列中时出现(insert into student (id) values(1) 1为已存在的id)</p><p><strong>INVALID_NUMBER</strong> 将字符串转换为数字时出现(select id into i from student where name &#x3D; 3)</p><p><strong>NO_DATA_FOUND</strong> 在表中不存在请求的行时出现(select id into i  from student where id &#x3D; -1)</p><p><strong>TOO_MANY_ROWS</strong> 在执行SELECT INTO语句后返回多行时出现(select id into i  from student)</p><p><strong>VALUE_ERROR</strong> 变量中的列值超出变量的大小或类型(i number(1); i:&#x3D;’a’;)</p><p><strong>ZERO_DIVIDE</strong> 以零做除数时出现(i number; i:&#x3D;1&#x2F;0)</p><p>示例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line"></span><br><span class="line">i number;</span><br><span class="line"></span><br><span class="line">str varchar2(<span class="number">10</span>) :<span class="operator">=</span> <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">select</span> id <span class="keyword">into</span> i <span class="keyword">from</span> student; </span><br><span class="line"></span><br><span class="line">EXCEPTION</span><br><span class="line"></span><br><span class="line">​        <span class="keyword">WHEN</span> VALUE_ERROR <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             dbms_output.put_line(<span class="string">&#x27;值类型错误&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);</span><br><span class="line"></span><br><span class="line">​        <span class="keyword">WHEN</span> ZERO_DIVIDE <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             dbms_output.put_line(<span class="string">&#x27;0不能做被除数&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);</span><br><span class="line"></span><br><span class="line">​        <span class="keyword">WHEN</span> TOO_MANY_ROWS <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             dbms_output.put_line(<span class="string">&#x27;返回了太多行，i只能接收一个&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);</span><br><span class="line"></span><br><span class="line">​        <span class="keyword">WHEN</span> NO_DATA_FOUND <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             dbms_output.put_line(<span class="string">&#x27;没有返回行，i无法完成赋值&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);   </span><br><span class="line"></span><br><span class="line">​        <span class="keyword">WHEN</span>  ACCESS_INTO_NULL <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             dbms_output.put_line(<span class="string">&#x27;变量没有初始化&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);</span><br><span class="line"></span><br><span class="line">​         <span class="keyword">WHEN</span>  INVALID_NUMBER <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             dbms_output.put_line(<span class="string">&#x27;数字不能转为字符串&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);  </span><br><span class="line"></span><br><span class="line">​                  </span><br><span class="line"></span><br><span class="line">​       <span class="keyword">WHEN</span>  DUP_VAL_ON_INDEX <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​             dbms_output.put_line(<span class="string">&#x27;索引重复&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);</span><br><span class="line"></span><br><span class="line">​     <span class="keyword">WHEN</span> OTHERS <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​          dbms_output.put_line(<span class="string">&#x27;未知错误&#x27;</span> <span class="operator">||</span> SQLCODE <span class="operator">||</span> SQLERRM);      </span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>; </span><br></pre></td></tr></table></figure><h3 id="9-8-2-非预定义异常-自定义异常"><a href="#9-8-2-非预定义异常-自定义异常" class="headerlink" title="9.8.2 非预定义异常(自定义异常)"></a>9.8.2 非预定义异常(自定义异常)</h3><p>Oracle允许自定义的错误代码的范围为-20000 – -20999</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">1</span>：</span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">​         RAISE_APPLICATION_ERROR(<span class="number">-20001</span>,<span class="string">&#x27;I am sorry to see you&#x27;</span>);</span><br><span class="line"></span><br><span class="line">EXCEPTION</span><br><span class="line"></span><br><span class="line">​          <span class="keyword">WHEN</span> OTHERS <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​          dbms_output.put_line( SQLCODE <span class="operator">||</span><span class="string">&#x27;      &#x27;</span><span class="operator">||</span> SQLERRM);    </span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">2</span>：</span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line"></span><br><span class="line">myexception exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">RAISE myException;</span><br><span class="line"></span><br><span class="line">EXCEPTION</span><br><span class="line"></span><br><span class="line">​         <span class="keyword">WHEN</span> myexception <span class="keyword">THEN</span></span><br><span class="line"></span><br><span class="line">​                RAISE_APPLICATION_ERROR(<span class="number">-20001</span>,<span class="string">&#x27;I am sorry to see you&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>; </span><br></pre></td></tr></table></figure><h1 id="十、存储过程"><a href="#十、存储过程" class="headerlink" title="十、存储过程"></a>十、存储过程</h1><p><strong>存储过程</strong>：存储在数据库中供用户程序调用的程序叫<strong>存储过程</strong>（<strong>数据库中的程序</strong>）</p><h2 id="10-1-创建存储过程"><a href="#10-1-创建存储过程" class="headerlink" title="10.1 创建存储过程"></a>10.1 创建存储过程</h2><p>用CREATE PROCEDURE命令建立存储过程</p><p>语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">       <span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] <span class="keyword">PROCEDURE</span> 过程名 [(参数名称<span class="number">1</span> <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> 参数类型<span class="number">1</span>,参数名称<span class="number">2</span> <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> 参数类型<span class="number">2.</span>..)] <span class="keyword">AS</span> </span><br><span class="line">PLSQL子程序体(<span class="keyword">begin</span>……<span class="keyword">end</span>)</span><br></pre></td></tr></table></figure><h2 id="10-2-形参声明"><a href="#10-2-形参声明" class="headerlink" title="10.2 形参声明"></a>10.2 形参声明</h2><p>基本格式：参数名称 in&#x2F;out 参数类型</p><p>Ø  in类型为输入类型的参数，out类型为输出类型的参数</p><p>Ø  过程没有返回值,in类型的参数，只可以接收值，不能再给in类型的参数设置新的值</p><p>Ø  利用out参数在过程中实现返回多个值</p><p>Ø  声明接收参数的只声明类型，不声明大小</p><h2 id="10-3-实参声明"><a href="#10-3-实参声明" class="headerlink" title="10.3 实参声明"></a>10.3 实参声明</h2><p>实参声明跟在as和begin之间即可，不需要declare关键字</p><h2 id="10-4-存储过程的调用"><a href="#10-4-存储过程的调用" class="headerlink" title="10.4 存储过程的调用"></a>10.4 存储过程的调用</h2><ol><li><p>exec 过程名称[(参数1，参数2…..)];  PLSQL不支持这种调用</p></li><li><p>begin 过程名称[(参数1，参数2…..)] end;</p></li></ol><h2 id="10-5-存储过程示例"><a href="#10-5-存储过程示例" class="headerlink" title="10.5 存储过程示例"></a>10.5 存储过程示例</h2><ol><li>批量向学生表写入100条数据</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> student_batch_insert</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.100</span></span><br><span class="line">      loop</span><br><span class="line">          <span class="keyword">insert</span> <span class="keyword">into</span> t_student(id,name,sex,age)<span class="keyword">values</span>(SEQ_STUDENT_ID.Nextval,<span class="string">&#x27;学生姓名&#x27;</span>,<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">      <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>银行转账</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> transfer(out_no <span class="keyword">in</span> varchar2,in_no <span class="keyword">in</span> varchar2,amont <span class="keyword">in</span> number)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="comment">--1.从扣款方账户当中减掉要转账的金额</span></span><br><span class="line">     <span class="keyword">update</span> t_bank_no <span class="keyword">set</span> bank_amont <span class="operator">=</span> bank_amont <span class="operator">-</span> amont <span class="keyword">where</span> bank_no <span class="operator">=</span> out_no;</span><br><span class="line">     <span class="comment">--2.给收款方账户当中加要转账的金额</span></span><br><span class="line">     <span class="keyword">update</span> t_bank_no <span class="keyword">set</span> bank_amont <span class="operator">=</span> bank_amont <span class="operator">+</span> amont <span class="keyword">where</span> bank_no <span class="operator">=</span> in_no;</span><br><span class="line">     <span class="keyword">commit</span>;<span class="comment">--提交</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><ol start="3"><li>银行转账的异常处理+事务</li></ol><p>事务指的是：一系列操作，要么全部成功，要么全部失败。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> transfer(out_no <span class="keyword">in</span> varchar2,in_no <span class="keyword">in</span> varchar2,amont <span class="keyword">in</span> number)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">i number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     <span class="comment">--1.从扣款方账户当中减掉要转账的金额</span></span><br><span class="line">     <span class="keyword">update</span> t_bank_no <span class="keyword">set</span> bank_amont <span class="operator">=</span> bank_amont <span class="operator">-</span> amont <span class="keyword">where</span> bank_no <span class="operator">=</span> out_no;</span><br><span class="line">     <span class="comment">--i := 10 / 0;</span></span><br><span class="line">     <span class="comment">--2.给收款方账户当中加要转账的金额</span></span><br><span class="line">     <span class="keyword">update</span> t_bank_no <span class="keyword">set</span> bank_amont <span class="operator">=</span> bank_amont <span class="operator">+</span> amont <span class="keyword">where</span> bank_no <span class="operator">=</span> in_no;</span><br><span class="line">     <span class="keyword">commit</span>;</span><br><span class="line">  exception </span><br><span class="line">             <span class="keyword">when</span> others <span class="keyword">then</span></span><br><span class="line">              <span class="keyword">rollback</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="十一、-游标-Cursor"><a href="#十一、-游标-Cursor" class="headerlink" title="十一、 游标(Cursor)"></a>十一、 游标(Cursor)</h1><p>  游标是SQL的一个内存工作区，由系统或用户以变量的形式定义。游标的作用就是用于临时存储从数据库中提取的数据块。 </p><p>游标的三种类型：隐式Cursor,显式Cursor,Ref Cursor(动态Cursor) 。</p><h2 id="11-1-隐式Cursor"><a href="#11-1-隐式Cursor" class="headerlink" title="11.1 隐式Cursor"></a>11.1 隐式Cursor</h2><p>隐式Cursor是系统自动打开和关闭Cursor。</p><p>​     可以通过隐式Cusor的属性来了解DML操作的状态和结果(行数和是否成功)，从而达到流程的控制。</p><p>​         隐式和显式Cursor都具有的属性:</p><p>​         SQL%ROWCOUNT 整型，代表DML语句成功执行的数据行数</p><p>​         SQL%FOUND    布尔型，值为TRUE代表操作成功</p><p>​         SQL%NOTFOUND 布尔型，与SQL%FOUND相反</p><p>​         SQL%ISOPEN   布尔型，DML执行过程中为真，结束后为假</p><p>示例:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">update</span> student <span class="keyword">set</span> remark <span class="operator">=</span> <span class="keyword">null</span>;</span><br><span class="line">     <span class="comment">--输出操作成功的条数</span></span><br><span class="line">    dbms_output.put_line( <span class="keyword">SQL</span><span class="operator">%</span>rowcount );</span><br><span class="line">    <span class="comment">--判断操作是否成功</span></span><br><span class="line">    if <span class="keyword">SQL</span><span class="operator">%</span>FOUND  <span class="keyword">then</span></span><br><span class="line">         dbms_output.put_line(<span class="string">&#x27;success&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">         dbms_output.put_line(<span class="string">&#x27;failed&#x27;</span> );</span><br><span class="line">    <span class="keyword">end</span> if;</span><br><span class="line">   <span class="comment">--判断游标是否打开（是否正在执行中）</span></span><br><span class="line">    if <span class="keyword">SQL</span><span class="operator">%</span>ISOPEN   <span class="keyword">then</span></span><br><span class="line">         dbms_output.put_line(<span class="string">&#x27;running&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">         dbms_output.put_line(<span class="string">&#x27;done&#x27;</span> );</span><br><span class="line">    <span class="keyword">end</span> if;</span><br><span class="line">    <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="11-2-静态Cursor"><a href="#11-2-静态Cursor" class="headerlink" title="11.2 静态Cursor"></a>11.2 静态Cursor</h2><p>​       从数据库中提取多行数据，使用显式Cursor</p><p>​       显式游标的运用分为四个步骤： </p><p>​       定义游标—Cursor [Cursor Name] IS; 必须要使用is. </p><p>​       打开游标—Open [Cursor Name]; </p><p>​       操作数据—Fetch [Cursor name]  into 行对象;</p><p>​       关闭游标—Close [Cursor Name],这个步骤绝对不可以遗漏</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">示例<span class="number">1</span> 单行游标:</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">cursor</span> student_c <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"> rs student<span class="operator">%</span>rowType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">open</span> student_c;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">fetch</span> student_c <span class="keyword">into</span> rs;</span><br><span class="line"></span><br><span class="line">   dbms_output.put_line(rs.id <span class="operator">||</span> <span class="string">&#x27; &#x27;</span> <span class="operator">||</span> rs.name); </span><br><span class="line"></span><br><span class="line">​      <span class="keyword">close</span> student_c;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">示例<span class="number">2</span> 多行游标：</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">cursor</span> student_c <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student <span class="keyword">order</span> <span class="keyword">by</span> id;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">​       <span class="comment">--无需打开和关闭，自动打开和关闭</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">for</span> rs <span class="keyword">in</span> student_c loop</span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(rs.id <span class="operator">||</span> <span class="string">&#x27; &#x27;</span> <span class="operator">||</span> rs.name); </span><br><span class="line"></span><br><span class="line">​    <span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="11-3-动态Cursor（Ref-Cursor）"><a href="#11-3-动态Cursor（Ref-Cursor）" class="headerlink" title="11.3 动态Cursor（Ref Cursor）"></a>11.3 动态Cursor（Ref Cursor）</h2><p>运行时才产生的游标，是动态游标。</p><p>​      Ref cursor的使用步骤: </p><p>​      Type 自定义游标类型 is ref cursor; –自定义了一个游标类型，并声明它是一个动态游标</p><p>​      游标名称 自定义游标类型;            –声明一个游标 它是自定义类型</p><p>​      Open 游标名称 for sql语句;</p><p>​      Fetch 游标名称  into 行对象;</p><p>​      Close 游标名称</p><p>示例:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> sigleRowCoursor(id_p <span class="keyword">in</span> varchar2) <span class="keyword">is</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">cursor</span> student_c <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student <span class="keyword">where</span> id <span class="operator">=</span> id_p;</span><br><span class="line"></span><br><span class="line">  rs student<span class="operator">%</span>rowType;</span><br><span class="line"></span><br><span class="line">  type ref_cursor_type  <span class="keyword">is</span> <span class="keyword">ref</span> <span class="keyword">cursor</span>;<span class="comment">--自定义了一个游标类型，并声明它是一个动态游标</span></span><br><span class="line"></span><br><span class="line">  college_c ref_cursor_type;</span><br><span class="line"></span><br><span class="line">  rs_college college<span class="operator">%</span>rowType;</span><br><span class="line"></span><br><span class="line">  v_sql varchar2(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">open</span> student_c;</span><br><span class="line"></span><br><span class="line">​      <span class="keyword">fetch</span> student_c <span class="keyword">into</span> rs;</span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(rs.id <span class="operator">||</span> <span class="string">&#x27; &#x27;</span> <span class="operator">||</span> rs.name);</span><br><span class="line"></span><br><span class="line">​      v_sql :<span class="operator">=</span> <span class="string">&#x27;select * from college where id = &#x27;</span> <span class="operator">||</span> rs.col_id;</span><br><span class="line"></span><br><span class="line">​      <span class="keyword">close</span> student_c;</span><br><span class="line"></span><br><span class="line">​      <span class="keyword">open</span> college_c <span class="keyword">for</span> v_sql;</span><br><span class="line"></span><br><span class="line">​      <span class="keyword">fetch</span> college_c <span class="keyword">into</span> rs_college;</span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(rs_college.id <span class="operator">||</span> <span class="string">&#x27; &#x27;</span> <span class="operator">||</span> rs_college.name);</span><br><span class="line"></span><br><span class="line">​      <span class="keyword">close</span> college_c;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">存储过程返回游标:</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> backParamter2 (res <span class="keyword">out</span> sys_refcursor) <span class="keyword">is</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">open</span> res <span class="keyword">for</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">运行:</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--声明一个系统游标类型的变量</span></span><br><span class="line"></span><br><span class="line">student_cursor sys_refcursor;</span><br><span class="line"></span><br><span class="line"><span class="comment">--声明一个自定义类型（这个类型是学生表里的行对应的表）</span></span><br><span class="line"></span><br><span class="line">type student_table_type <span class="keyword">is</span> <span class="keyword">table</span> <span class="keyword">of</span> student<span class="operator">%</span>rowtype;</span><br><span class="line"></span><br><span class="line"><span class="comment">--声明一个变量为自定义类型</span></span><br><span class="line"></span><br><span class="line">student_table student_table_type;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">--执行存储过程，此过程返回系统游标</span></span><br><span class="line"></span><br><span class="line">  backParamter2(student_cursor);</span><br><span class="line"></span><br><span class="line">  <span class="comment">--抓取系统游标（集合）里的数据到学生表里</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">fetch</span> student_cursor bulk <span class="keyword">collect</span> <span class="keyword">into</span>  student_table;</span><br><span class="line"></span><br><span class="line">  <span class="comment">--迭代学生表</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i  <span class="keyword">in</span> <span class="number">1.</span>.student_table.count </span><br><span class="line"></span><br><span class="line">  loop</span><br><span class="line"></span><br><span class="line">​      <span class="comment">--取学生表里的行对应的列的值</span></span><br><span class="line"></span><br><span class="line">​      dbms_output.put_line(student_table(i).id <span class="operator">||</span> <span class="string">&#x27;,&#x27;</span> <span class="operator">||</span> student_table(i).name);</span><br><span class="line"></span><br><span class="line">​      </span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line">  <span class="comment">--关闭游标</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">close</span> student_ref_cursor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h1 id="十二、视图"><a href="#十二、视图" class="headerlink" title="十二、视图"></a>十二、视图</h1><p>视图包含行和列，就像一个真实的表。视图中的字段就是来自一个或多个数据库中的真实的表中的字段。我们可以向视图添加 SQL 函数、WHERE 以及 JOIN 语句，我们也可以提交数据，就像这些来自于某个单一的表。</p><p><strong>注释：</strong>数据库的设计和结构不会受到视图中的函数、where 或 join 语句的影响。</p><p>创建格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> <span class="keyword">AS</span> <span class="keyword">SELECT</span> ……</span><br></pre></td></tr></table></figure><h1 id="十三、同义词"><a href="#十三、同义词" class="headerlink" title="十三、同义词"></a>十三、同义词</h1><p>同义词是Oracle对象的别名，使用同义词访问相同的对象,可以为表、视图、存储过程、函数或另一同义词等对象创建同义词,方便访问其它用户的对象，隐藏了对象的身份。</p><p>创建格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SYNONYM synonym_name <span class="keyword">FOR</span> object</span><br></pre></td></tr></table></figure><h1 id="十四、序列"><a href="#十四、序列" class="headerlink" title="十四、序列"></a>十四、序列</h1><p>序列就是<strong>有顺序</strong>的<strong>数列</strong>。例如：123456789……</p><p>创建序列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SEQUENCE 序列名称[ MINVALUE <span class="number">1</span> MAXVALUE <span class="number">999999999999999999999999999</span> INCREMENT <span class="keyword">BY</span> <span class="number">1</span> <span class="keyword">START</span> <span class="keyword">WITH</span>  <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>解释：创建序列，最小值是1，最大值是999999999999999999999999999，增量为1，开始于1。序列调用nextval将触发增量条件。<strong>序列只能向前走，不能向后退！</strong></p><p>使用序列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 序列名称.NEXTVAL <span class="keyword">FROM</span> DUAL</span><br></pre></td></tr></table></figure><p>查询序列当前值：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 序列名称. CURRVAL <span class="keyword">FROM</span> DUAL</span><br></pre></td></tr></table></figure><p>解释：</p><p>NEXTVAL就是Next Value，下一个值。</p><p>CURRVAL就是Current Value，当前值。</p><p>DUAL可以认为是系统的虚表，不存在的表，之所以FROM 后面跟DUAL是因为这条SQL语句的FROM不知该作用在哪张表，当不知道该作用在哪张表时就写DUAL。      </p><p>————————————————</p><p>视频推荐·：【动力节点Oracle从入门到精通全套教程_数据库实战精讲】 <a href="https://www.bilibili.com/video/BV1JP411C7Ew/?p=11&share_source=copy_web&vd_source=36727c3b1131b0c2a09e1c8d974b0a02">https://www.bilibili.com/video/BV1JP411C7Ew/?p=11&amp;share_source=copy_web&amp;vd_source=36727c3b1131b0c2a09e1c8d974b0a02</a></p><p>参考链接：</p><p><a href="https://www.w3cschool.cn/oraclejc/oraclejc-21an2qtd.html">Oracle 基础知识_w3cschool</a></p><p><a href="https://blog.csdn.net/weixin_52850476/article/details/126454851">https://blog.csdn.net/weixin_52850476/article/details/126454851</a></p><p><a href="https://blog.csdn.net/shao_yc/article/details/103022634">https://blog.csdn.net/shao_yc/article/details/103022634</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL学习day04</title>
      <link href="/post/7d555d60.html"/>
      <url>/post/7d555d60.html</url>
      
        <content type="html"><![CDATA[<h1 id="mysql-day04课堂笔记"><a href="#mysql-day04课堂笔记" class="headerlink" title="mysql day04课堂笔记"></a>mysql day04课堂笔记</h1><h2 id="1、索引（index）"><a href="#1、索引（index）" class="headerlink" title="1、索引（index）"></a>1、索引（index）</h2><h3 id="1-1-什么是索引"><a href="#1-1-什么是索引" class="headerlink" title="1.1 什么是索引"></a>1.1 什么是索引</h3><p>​索引是在数据库表的字段上添加的，是为了提高查询效率存在的一种机制。<br>​一张表的一个字段可以添加一个索引，当然，多个字段联合起来也可以添加索引。<br>​索引相当于一本书的目录，是为了缩小扫描范围而存在的一种机制。</p><p>对于一本字典来说，查找某个汉字有两种方式：<br>    第一种方式：一页一页挨着找，直到找到为止，这种查找方式属于全字典扫描。<br>    效率比较低。<br>    第二种方式：先通过目录（索引）去定位一个大概的位置，然后直接定位到这个<br>    位置，做局域性扫描，缩小扫描的范围，快速的查找。这种查找方式属于通过<br>    索引检索，效率较高。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">t_user</span><br><span class="line">id(idIndex)name(nameIndex)email(emailIndex)address  (emailAddressIndex)</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">1zhangsan...</span><br><span class="line">2lisi</span><br><span class="line">3wangwu</span><br><span class="line">4zhaoliu</span><br><span class="line">5hanmeimei</span><br><span class="line">6jack</span><br><span class="line"></span><br><span class="line">select * from t_user where name = &#x27;jack&#x27;;</span><br></pre></td></tr></table></figure><p>以上的这条SQL语句会去name字段上扫描，为什么？<br>    因为查询条件是：name&#x3D;’jack’</p><p>如果name字段上没有添加索引（目录），或者说没有给name字段创建索引，<br>MySQL会进行全扫描，会将name字段上的每一个值都比对一遍。效率比较低。</p><p>MySQL在查询方面主要就是两种方式：<br>    第一种方式：全表扫描<br>    第二种方式：根据索引检索。</p><p><strong>注意：</strong><br>    在实际中，汉语字典前面的目录是排序的，按照a b c d e f….排序，为什么排序呢？</p><p>因为只有排序了才会有区间查找这一说！（缩小扫描范围其实就是扫描某个区间罢了！）</p><p>在mysql数据库当中索引也是需要排序的，并且这个所以的排序和TreeSet数据结构相同。TreeSet（TreeMap）底层是一个自平衡的二叉树！在mysql当中索引是一个B-Tree数据结构。</p><p>遵循左小又大原则存放。采用中序遍历方式遍历取数据。</p><h3 id="1-2-索引的实现原理"><a href="#1-2-索引的实现原理" class="headerlink" title="1.2 索引的实现原理"></a>1.2 索引的实现原理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">假设有一张用户表：t_user</span><br><span class="line"></span><br><span class="line">id(PK)name每一行记录在硬盘上都有物理存储编号</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">100zhangsan0x1111</span><br><span class="line">120lisi0x2222</span><br><span class="line">99wangwu0x8888</span><br><span class="line">88zhaoliu0x9999</span><br><span class="line">101jack0x6666</span><br><span class="line">55lucy0x5555</span><br><span class="line">130tom0x7777</span><br></pre></td></tr></table></figure><p><strong>提醒1：</strong>在任何数据库当中主键上都会自动添加索引对象，id字段上自动有索引，因为id是PK。另外在mysql当中，一个字段上如果有unique约束的话，也会自动创建索引对象。</p><p><strong>提醒2：</strong>在任何数据库当中，任何一张表的任何一条记录在硬盘存储上都有一个硬盘的物理存储编号。</p><p><strong>提醒3：</strong>在mysql当中，索引是一个单独的对象，不同的存储引擎以不同的形式存在，在MyISAM存储引擎中，索引存储在一个.MYI文件中。在InnoDB存储引擎中索引存储在一个逻辑名称叫做tablespace的当中。在MEMORY存储引擎当中索引被存储在内存当中。不管索引存储在哪里，索引在mysql当中都是一个树的形式存在。（自平衡二叉树：B-Tree）</p><h3 id="1-3-在mysql当中，主键上，以及unique字段上都会自动添加索引的！"><a href="#1-3-在mysql当中，主键上，以及unique字段上都会自动添加索引的！" class="headerlink" title="1.3 在mysql当中，主键上，以及unique字段上都会自动添加索引的！"></a>1.3 在mysql当中，主键上，以及unique字段上都会自动添加索引的！</h3><p>什么条件下，我们会考虑给字段添加索引呢？<br>    条件1：数据量庞大（到底有多么庞大算庞大，这个需要测试，因为每一个硬件环境不同）<br>    条件2：该字段经常出现在where的后面，以条件的形式存在，也就是说这个字段总是被扫描。<br>    条件3：该字段很少的DML(insert delete update)操作。（因为DML之后，索引需要重新排序。）</p><p>建议不要随意添加索引，因为索引也是需要维护的，太多的话反而会降低系统的性能。<br>建议通过主键查询，建议通过unique约束的字段进行查询，效率是比较高的。</p><h3 id="1-4-索引怎么创建，怎么删除，语法是什么"><a href="#1-4-索引怎么创建，怎么删除，语法是什么" class="headerlink" title="1.4 索引怎么创建，怎么删除，语法是什么"></a>1.4 索引怎么创建，怎么删除，语法是什么</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">创建索引：</span><br><span class="line">mysql&gt; create index emp_ename_index on emp(ename);</span><br><span class="line">给emp表的ename字段添加索引，起名：emp_ename_index</span><br><span class="line"></span><br><span class="line">删除索引：</span><br><span class="line">mysql&gt; drop index emp_ename_index on emp;</span><br><span class="line">将emp表上的emp_ename_index索引对象删除。</span><br></pre></td></tr></table></figure><h3 id="1-5-在mysql当中，怎么查看一个SQL语句是否使用了索引进行检索？"><a href="#1-5-在mysql当中，怎么查看一个SQL语句是否使用了索引进行检索？" class="headerlink" title="1.5 在mysql当中，怎么查看一个SQL语句是否使用了索引进行检索？"></a>1.5 在mysql当中，怎么查看一个SQL语句是否使用了索引进行检索？</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from emp where ename = &#x27;KING&#x27;;</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ALL  | NULL          | NULL | NULL    | NULL |   14 | Using where |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">扫描14条记录：说明没有使用索引。type=ALL</span><br><span class="line"></span><br><span class="line">mysql&gt; create index emp_ename_index on emp(ename);</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from emp where ename = &#x27;KING&#x27;;</span><br><span class="line">+----+-------------+-------+------+-----------------+-----------------+---------+-------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys   | key             | key_len | ref   | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+-----------------+-----------------+---------+-------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ref  | emp_ename_index | emp_ename_index | 33      | const |    1 | Using where |</span><br><span class="line">+----+-------------+-------+------+-----------------+-----------------+---------+-------+------+-------------+</span><br></pre></td></tr></table></figure><h3 id="1-6-索引有失效的时候，什么时候索引失效呢？"><a href="#1-6-索引有失效的时候，什么时候索引失效呢？" class="headerlink" title="1.6 索引有失效的时候，什么时候索引失效呢？"></a>1.6 索引有失效的时候，什么时候索引失效呢？</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">失效的第1种情况：</span><br><span class="line">select * from emp where ename like &#x27;%T&#x27;;</span><br><span class="line"></span><br><span class="line">ename上即使添加了索引，也不会走索引，为什么？</span><br><span class="line">原因是因为模糊匹配当中以“%”开头了！</span><br><span class="line">尽量避免模糊查询的时候以“%”开始。</span><br><span class="line">这是一种优化的手段/策略。</span><br><span class="line">mysql&gt; explain select * from emp where ename like &#x27;%T&#x27;;</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ALL  | NULL          | NULL | NULL    | NULL |   14 | Using where |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line"></span><br><span class="line">失效的第2种情况：</span><br><span class="line">使用or的时候会失效，如果使用or那么要求or两边的条件字段都要有</span><br><span class="line">索引，才会走索引，如果其中一边有一个字段没有索引，那么另一个</span><br><span class="line">字段上的索引也会实现。所以这就是为什么不建议使用or的原因。</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from emp where ename = &#x27;KING&#x27; or job = &#x27;MANAGER&#x27;;</span><br><span class="line">+----+-------------+-------+------+-----------------+------+---------+------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys   | key  | key_len | ref  | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+-----------------+------+---------+------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ALL  | emp_ename_index | NULL | NULL    | NULL |   14 | Using where |</span><br><span class="line">+----+-------------+-------+------+-----------------+------+---------+------+------+-------------+</span><br><span class="line"></span><br><span class="line">失效的第3种情况：</span><br><span class="line">使用复合索引的时候，没有使用左侧的列查找，索引失效</span><br><span class="line">什么是复合索引？</span><br><span class="line">两个字段，或者更多的字段联合起来添加一个索引，叫做复合索引。</span><br><span class="line"></span><br><span class="line">create index emp_job_sal_index on emp(job,sal);</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from emp where job = &#x27;MANAGER&#x27;;</span><br><span class="line">+----+-------------+-------+------+-------------------+-------------------+---------+-------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys     | key               | key_len | ref   | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+-------------------+-------------------+---------+-------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ref  | emp_job_sal_index | emp_job_sal_index | 30      | const |    3 | Using where |</span><br><span class="line">+----+-------------+-------+------+-------------------+-------------------+---------+-------+------+-------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from emp where sal = 800;</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ALL  | NULL          | NULL | NULL    | NULL |   14 | Using where |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line"></span><br><span class="line">失效的第4种情况：</span><br><span class="line">在where当中索引列参加了运算，索引失效。</span><br><span class="line">mysql&gt; create index emp_sal_index on emp(sal);</span><br><span class="line"></span><br><span class="line">explain select * from emp where sal = 800;</span><br><span class="line">+----+-------------+-------+------+---------------+---------------+---------+-------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys | key           | key_len | ref   | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+---------------+---------------+---------+-------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ref  | emp_sal_index | emp_sal_index | 9       | const |    1 | Using where |</span><br><span class="line">+----+-------------+-------+------+---------------+---------------+---------+-------+------+-------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from emp where sal+1 = 800;</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ALL  | NULL          | NULL | NULL    | NULL |   14 | Using where |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line"></span><br><span class="line">失效的第5种情况：</span><br><span class="line">在where当中索引列使用了函数</span><br><span class="line">explain select * from emp where lower(ename) = &#x27;smith&#x27;;</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br><span class="line">|  1 | SIMPLE      | emp   | ALL  | NULL          | NULL | NULL    | NULL |   14 | Using where |</span><br><span class="line">+----+-------------+-------+------+---------------+------+---------+------+------+-------------+</span><br></pre></td></tr></table></figure><p>失效的第6…<br>失效的第7…</p><h3 id="1-7-索引是各种数据库进行优化的重要手段，优化的时候优先考虑的因素就是索引。"><a href="#1-7-索引是各种数据库进行优化的重要手段，优化的时候优先考虑的因素就是索引。" class="headerlink" title="1.7 索引是各种数据库进行优化的重要手段，优化的时候优先考虑的因素就是索引。"></a>1.7 索引是各种数据库进行优化的重要手段，优化的时候优先考虑的因素就是索引。</h3><p>索引在数据库当中分了很多类？<br>    单一索引：一个字段上添加索引。<br>    复合索引：两个字段或者更多的字段上添加索引。</p><p>主键索引：主键上添加索引。<br>唯一性索引：具有unique约束的字段上添加索引。<br>…..</p><p>注意：唯一性比较弱的字段上添加索引用处不大。</p><h2 id="2、视图-view"><a href="#2、视图-view" class="headerlink" title="2、视图(view)"></a>2、视图(view)</h2><h3 id="2-1-什么是视图"><a href="#2-1-什么是视图" class="headerlink" title="2.1 什么是视图"></a>2.1 什么是视图</h3><p>​view:站在不同的角度去看待同一份数据。</p><h3 id="2-2-怎么创建视图对象？怎么删除视图对象？"><a href="#2-2-怎么创建视图对象？怎么删除视图对象？" class="headerlink" title="2.2 怎么创建视图对象？怎么删除视图对象？"></a>2.2 怎么创建视图对象？怎么删除视图对象？</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">表复制：</span><br><span class="line">mysql&gt; create table dept2 as select * from dept;</span><br><span class="line"></span><br><span class="line">dept2表中的数据：</span><br><span class="line">mysql&gt; select * from dept2;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line"></span><br><span class="line">创建视图对象：</span><br><span class="line">create view dept2_view as select * from dept2;</span><br><span class="line"></span><br><span class="line">删除视图对象：</span><br><span class="line">drop view dept2_view;</span><br><span class="line"></span><br><span class="line">注意：只有DQL语句才能以view的形式创建。</span><br><span class="line">create view view_name as 这里的语句必须是DQL语句;</span><br></pre></td></tr></table></figure><h3 id="2-3-用视图做什么"><a href="#2-3-用视图做什么" class="headerlink" title="2.3 用视图做什么"></a>2.3 用视图做什么</h3><p>我们可以面向视图对象进行增删改查，对视图对象的增删改查，会导致原表被操作！（视图的特点：通过对视图的操作，会影响到原表数据。）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">//面向视图查询</span><br><span class="line">select * from dept2_view; </span><br><span class="line"></span><br><span class="line">// 面向视图插入</span><br><span class="line">insert into dept2_view(deptno,dname,loc) values(60,&#x27;SALES&#x27;, &#x27;BEIJING&#x27;);</span><br><span class="line"></span><br><span class="line">// 查询原表数据</span><br><span class="line">mysql&gt; select * from dept2;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">|     60 | SALES      | BEIJING  |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line"></span><br><span class="line">// 面向视图删除</span><br><span class="line">mysql&gt; delete from dept2_view;</span><br><span class="line"></span><br><span class="line">// 查询原表数据</span><br><span class="line">mysql&gt; select * from dept2;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line">// 创建视图对象</span><br><span class="line">create view </span><br><span class="line">emp_dept_view</span><br><span class="line">as</span><br><span class="line">select </span><br><span class="line">e.ename,e.sal,d.dname</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">join</span><br><span class="line">dept d</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno;</span><br><span class="line"></span><br><span class="line">// 查询视图对象</span><br><span class="line">mysql&gt; select * from emp_dept_view;</span><br><span class="line">+--------+---------+------------+</span><br><span class="line">| ename  | sal     | dname      |</span><br><span class="line">+--------+---------+------------+</span><br><span class="line">| CLARK  | 2450.00 | ACCOUNTING |</span><br><span class="line">| KING   | 5000.00 | ACCOUNTING |</span><br><span class="line">| MILLER | 1300.00 | ACCOUNTING |</span><br><span class="line">| SMITH  |  800.00 | RESEARCH   |</span><br><span class="line">| JONES  | 2975.00 | RESEARCH   |</span><br><span class="line">| SCOTT  | 3000.00 | RESEARCH   |</span><br><span class="line">| ADAMS  | 1100.00 | RESEARCH   |</span><br><span class="line">| FORD   | 3000.00 | RESEARCH   |</span><br><span class="line">| ALLEN  | 1600.00 | SALES      |</span><br><span class="line">| WARD   | 1250.00 | SALES      |</span><br><span class="line">| MARTIN | 1250.00 | SALES      |</span><br><span class="line">| BLAKE  | 2850.00 | SALES      |</span><br><span class="line">| TURNER | 1500.00 | SALES      |</span><br><span class="line">| JAMES  |  950.00 | SALES      |</span><br><span class="line">+--------+---------+------------+</span><br><span class="line"></span><br><span class="line">// 面向视图更新</span><br><span class="line">update emp_dept_view set sal = 1000 where dname = &#x27;ACCOUNTING&#x27;;</span><br><span class="line"></span><br><span class="line">// 原表数据被更新</span><br><span class="line">mysql&gt; select * from emp;</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |</span><br><span class="line">|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |</span><br><span class="line">|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |</span><br><span class="line">|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |</span><br><span class="line">|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |</span><br><span class="line">|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |</span><br><span class="line">|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 1000.00 |    NULL |     10 |</span><br><span class="line">|  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 |</span><br><span class="line">|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 1000.00 |    NULL |     10 |</span><br><span class="line">|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |</span><br><span class="line">|  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 |</span><br><span class="line">|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |</span><br><span class="line">|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |</span><br><span class="line">|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1000.00 |    NULL |     10 |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br></pre></td></tr></table></figure><h3 id="2-4-视图对象在实际开发中到底有什么用？《方便，简化开发，利于维护》"><a href="#2-4-视图对象在实际开发中到底有什么用？《方便，简化开发，利于维护》" class="headerlink" title="2.4 视图对象在实际开发中到底有什么用？《方便，简化开发，利于维护》"></a>2.4 视图对象在实际开发中到底有什么用？《方便，简化开发，利于维护》</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create view </span><br><span class="line">emp_dept_view</span><br><span class="line">as</span><br><span class="line">select </span><br><span class="line">e.ename,e.sal,d.dname</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">join</span><br><span class="line">dept d</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno;</span><br></pre></td></tr></table></figure><p>假设有一条非常复杂的SQL语句，而这条SQL语句需要在不同的位置上反复使用。<br>    每一次使用这个sql语句的时候都需要重新编写，很长，很麻烦，怎么办？<br>        可以把这条复杂的SQL语句以视图对象的形式新建。<br>        在需要编写这条SQL语句的位置直接使用视图对象，可以大大简化开发。<br>        并且利于后期的维护，因为修改的时候也只需要修改一个位置就行，只需要<br>        修改视图对象所映射的SQL语句。<br>    我们以后面向视图开发的时候，使用视图的时候可以像使用table一样。<br>可以对视图进行增删改查等操作。视图不是在内存当中，视图对象也是<br>存储在硬盘上的，不会消失。</p><p>再提醒一下：<br>    视图对应的语句只能是DQL语句。<br>    但是视图对象创建完成之后，可以对视图进行增删改查等操作。</p><p>小插曲：<br>    增删改查，又叫做：CRUD。<br>    CRUD是在公司中程序员之间沟通的术语。一般我们很少说增删改查。<br>    一般都说CRUD。</p><p>C:Create（增）<br>R:Retrive（查：检索）<br>U:Update（改）<br>D:Delete（删）</p><h3 id="3-DBA常用命令"><a href="#3-DBA常用命令" class="headerlink" title="3 DBA常用命令"></a>3 DBA常用命令</h3><p>重点掌握：<br>    数据的导入和导出（数据的备份）<br>    其它命令了解一下即可。（这个培训日志文档留着，以后忘了，可以打开文档复制粘贴。）</p><p>数据导出？<br>    注意：在windows的dos命令窗口中：<br>        mysqldump bjpowernode&gt;D:\bjpowernode.sql -uroot -p123456</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可以导出指定的表吗？</span><br><span class="line">mysqldump bjpowernode emp&gt;D:\bjpowernode.sql -uroot -p123456</span><br></pre></td></tr></table></figure><p>数据导入<br>    注意：需要先登录到mysql数据库服务器上。<br>    然后创建数据库：create database bjpowernode;<br>    使用数据库：use bjpowernode<br>    然后初始化数据库：source D:\bjpowernode.sql</p><h2 id="4、数据库设计三范式"><a href="#4、数据库设计三范式" class="headerlink" title="4、数据库设计三范式"></a>4、数据库设计三范式</h2><h3 id="4-1-什么是数据库设计范式"><a href="#4-1-什么是数据库设计范式" class="headerlink" title="4.1 什么是数据库设计范式"></a>4.1 什么是数据库设计范式</h3><p>​数据库表的设计依据。教你怎么进行数据库表的设计。</p><h3 id="4-2-数据库设计范式共有3个"><a href="#4-2-数据库设计范式共有3个" class="headerlink" title="4.2 数据库设计范式共有3个"></a>4.2 数据库设计范式共有3个</h3><p>第一范式：要求任何一张表必须有主键，每一个字段原子性不可再分。</p><p>第二范式：建立在第一范式的基础之上，要求所有非主键字段完全依赖主键，<br>不要产生部分依赖。</p><p>第三范式：建立在第二范式的基础之上，要求所有非主键字段直接依赖主键，<br>不要产生传递依赖。</p><p>声明：三范式是面试官经常问的，所以一定要熟记在心！</p><p>设计数据库表的时候，按照以上的范式进行，可以避免表中数据的冗余，空间的浪费。</p><h3 id="4-3-第一范式"><a href="#4-3-第一范式" class="headerlink" title="4.3 第一范式"></a>4.3 第一范式</h3><p>​最核心，最重要的范式，所有表的设计都需要满足。<br>​必须有主键，并且每一个字段都是原子性不可再分。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">学生编号 学生姓名 联系方式</span><br><span class="line">------------------------------------------</span><br><span class="line">1001张三zs@gmail.com,1359999999</span><br><span class="line">1002李四ls@gmail.com,13699999999</span><br><span class="line">1001王五ww@163.net,13488888888</span><br><span class="line"></span><br><span class="line">以上是学生表，满足第一范式吗？</span><br><span class="line">不满足，第一：没有主键。第二：联系方式可以分为邮箱地址和电话</span><br><span class="line"></span><br><span class="line">学生编号(pk) 学生姓名邮箱地址联系电话</span><br><span class="line">----------------------------------------------------</span><br><span class="line">1001张三zs@gmail.com1359999999</span><br><span class="line">1002李四ls@gmail.com13699999999</span><br><span class="line">1003王五ww@163.net13488888888</span><br></pre></td></tr></table></figure><h3 id="4-4-第二范式"><a href="#4-4-第二范式" class="headerlink" title="4.4 第二范式"></a>4.4 第二范式</h3><p>​建立在第一范式的基础之上，<br>​要求所有非主键字段必须完全依赖主键，不要产生部分依赖。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">学生编号 学生姓名 教师编号 教师姓名</span><br><span class="line">----------------------------------------------------</span><br><span class="line">1001张三001王老师</span><br><span class="line">1002李四002赵老师</span><br><span class="line">1003王五001王老师</span><br><span class="line">1001张三002赵老师</span><br><span class="line"></span><br><span class="line">这张表描述了学生和老师的关系：（1个学生可能有多个老师，1个老师有多个学生）</span><br><span class="line">这是非常典型的：多对多关系！</span><br><span class="line"></span><br><span class="line">分析以上的表是否满足第一范式？</span><br><span class="line">不满足第一范式。</span><br><span class="line"></span><br><span class="line">怎么满足第一范式呢？修改</span><br><span class="line"></span><br><span class="line">学生编号+教师编号(pk)学生姓名  教师姓名</span><br><span class="line">----------------------------------------------------</span><br><span class="line">1001001张三王老师</span><br><span class="line">1002002李四赵老师</span><br><span class="line">1003001王五王老师</span><br><span class="line">1001002张三赵老师</span><br><span class="line"></span><br><span class="line">学生编号 教师编号，两个字段联合做主键，复合主键（PK: 学生编号+教师编号）</span><br><span class="line">经过修改之后，以上的表满足了第一范式。但是满足第二范式吗？</span><br><span class="line">不满足，“张三”依赖1001，“王老师”依赖001，显然产生了部分依赖。</span><br><span class="line">产生部分依赖有什么缺点？</span><br><span class="line">数据冗余了。空间浪费了。“张三”重复了，“王老师”重复了。</span><br><span class="line"></span><br><span class="line">为了让以上的表满足第二范式，你需要这样设计：</span><br><span class="line">使用三张表来表示多对多的关系！！！！</span><br><span class="line">学生表</span><br><span class="line">学生编号(pk)学生名字</span><br><span class="line">------------------------------------</span><br><span class="line">1001张三</span><br><span class="line">1002李四</span><br><span class="line">1003王五</span><br><span class="line"></span><br><span class="line">教师表</span><br><span class="line">教师编号(pk)教师姓名</span><br><span class="line">--------------------------------------</span><br><span class="line">001王老师</span><br><span class="line">002赵老师</span><br><span class="line"></span><br><span class="line">学生教师关系表</span><br><span class="line">id(pk)学生编号(fk)教师编号(fk)</span><br><span class="line">------------------------------------------------------</span><br><span class="line">11001001</span><br><span class="line">21002002</span><br><span class="line">31003001</span><br><span class="line">41001002</span><br></pre></td></tr></table></figure><p>背口诀：<br>    多对多怎么设计？<br>        <strong>多对多，三张表，关系表两个外键</strong></p><h3 id="4-5-第三范式"><a href="#4-5-第三范式" class="headerlink" title="4.5 第三范式"></a>4.5 第三范式</h3><p>​第三范式建立在第二范式的基础之上<br>​要求所有非主键字典必须直接依赖主键，不要产生传递依赖。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">学生编号（PK） 学生姓名 班级编号  班级名称</span><br><span class="line">---------------------------------------------------------</span><br><span class="line">1001张三01一年一班</span><br><span class="line">1002李四02一年二班</span><br><span class="line">1003王五03一年三班</span><br><span class="line">1004赵六03一年三班</span><br><span class="line"></span><br><span class="line">以上表的设计是描述：班级和学生的关系。很显然是1对多关系！</span><br><span class="line">一个教室中有多个学生。</span><br><span class="line"></span><br><span class="line">分析以上表是否满足第一范式？</span><br><span class="line">满足第一范式，有主键。</span><br><span class="line"></span><br><span class="line">分析以上表是否满足第二范式？</span><br><span class="line">满足第二范式，因为主键不是复合主键，没有产生部分依赖。主键是单一主键。</span><br><span class="line"></span><br><span class="line">分析以上表是否满足第三范式？</span><br><span class="line">第三范式要求：不要产生传递依赖！</span><br><span class="line">一年一班依赖01，01依赖1001，产生了传递依赖。</span><br><span class="line">不符合第三范式的要求。产生了数据的冗余。</span><br><span class="line"></span><br><span class="line">那么应该怎么设计一对多呢？</span><br><span class="line"></span><br><span class="line">班级表：一</span><br><span class="line">班级编号(pk)班级名称</span><br><span class="line">----------------------------------------</span><br><span class="line">01一年一班</span><br><span class="line">02一年二班</span><br><span class="line">03一年三班</span><br><span class="line"></span><br><span class="line">学生表：多</span><br><span class="line"></span><br><span class="line">学生编号（PK） 学生姓名 班级编号(fk)</span><br><span class="line">-------------------------------------------</span><br><span class="line">1001张三01</span><br><span class="line">1002李四02</span><br><span class="line">1003王五03</span><br><span class="line">1004赵六03</span><br></pre></td></tr></table></figure><p>背口诀：<strong>一对多，两张表，多的表加外键</strong></p><h3 id="4-6-总结表的设计"><a href="#4-6-总结表的设计" class="headerlink" title="4.6 总结表的设计"></a>4.6 总结表的设计</h3><p>一对多：<br>    一对多，两张表，多的表加外键</p><p>多对多：<br>    多对多，三张表，关系表两个外键</p><p>一对一：<br>    一对一放到一张表中不就行了吗？为啥还要拆分表？<br>    在实际的开发中，可能存在一张表字段太多，太庞大。这个时候要拆分表。<br>    一对一怎么设计？<br>        没有拆分表之前：一张表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">t_user</span><br><span class="line">idlogin_namelogin_pwdreal_nameemailaddress........</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">1zhangsan123张三zhangsan@xxx</span><br><span class="line">2lisi123李四lisi@xxx</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">这种庞大的表建议拆分为两张：</span><br><span class="line">t_login 登录信息表</span><br><span class="line">id(pk)login_namelogin_pwd</span><br><span class="line">---------------------------------</span><br><span class="line">1zhangsan123</span><br><span class="line">2lisi123</span><br><span class="line"></span><br><span class="line">t_user 用户详细信息表</span><br><span class="line">id(pk)real_nameemailaddress........login_id(fk+unique)</span><br><span class="line">-----------------------------------------------------------------------------------------</span><br><span class="line">100张三zhangsan@xxx1</span><br><span class="line">200李四lisi@xxx2</span><br></pre></td></tr></table></figure><p>口诀：<strong>一对一，外键唯一</strong></p><h3 id="4-7-嘱咐一句话："><a href="#4-7-嘱咐一句话：" class="headerlink" title="4.7 嘱咐一句话："></a>4.7 嘱咐一句话：</h3><p>数据库设计三范式是理论上的。</p><p>实践和理论有的时候有偏差。</p><p>最终的目的都是为了满足客户的需求，有的时候会拿冗余换执行速度。</p><p>因为在sql当中，表和表之间连接次数越多，效率越低。（笛卡尔积）</p><p>有的时候可能会存在冗余，但是为了减少表的连接次数，这样做也是合理的，<br>并且对于开发人员来说，sql语句的编写难度也会降低。</p>]]></content>
      
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL学习day03</title>
      <link href="/post/e331c8c3.html"/>
      <url>/post/e331c8c3.html</url>
      
        <content type="html"><![CDATA[<h1 id="mysql-day03课堂笔记"><a href="#mysql-day03课堂笔记" class="headerlink" title="mysql day03课堂笔记"></a>mysql day03课堂笔记</h1><h2 id="1、查询每一个员工的所在部门名称，要求显示员工名和部门名"><a href="#1、查询每一个员工的所在部门名称，要求显示员工名和部门名" class="headerlink" title="1、查询每一个员工的所在部门名称，要求显示员工名和部门名"></a>1、查询每一个员工的所在部门名称，要求显示员工名和部门名</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from emp;</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |</span><br><span class="line">|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |</span><br><span class="line">|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |</span><br><span class="line">|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |</span><br><span class="line">|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |</span><br><span class="line">|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |</span><br><span class="line">|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |</span><br><span class="line">|  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 |</span><br><span class="line">|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |</span><br><span class="line">|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |</span><br><span class="line">|  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 |</span><br><span class="line">|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |</span><br><span class="line">|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |</span><br><span class="line">|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br></pre></td></tr></table></figure><p>从emp表中取ename，从dept表中取dname，没有条件限制最终查询结果是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ENAMEDNAME</span><br><span class="line">SMITHACCOUNTING无效记录</span><br><span class="line">SMITHRESEARCH有效记录</span><br><span class="line">SMITHSALES无效记录</span><br><span class="line">SMITHOPERATIONS无效记录</span><br><span class="line"></span><br><span class="line">ALLENACCOUNTING</span><br><span class="line">ALLENRESEARCH</span><br><span class="line">ALLENSALES</span><br><span class="line">ALLENOPERATIONS</span><br><span class="line"></span><br><span class="line">.....</span><br><span class="line">56条记录。</span><br></pre></td></tr></table></figure><p>加个条件是为了达到4选1，也是为了数据的有效性。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">join</span><br><span class="line">dept d</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno;</span><br></pre></td></tr></table></figure><p>加条件只是为了避免笛卡尔积现象，只是为了查询出有效的组合记录，匹配的次数一次都没有少，还是56次。</p><h2 id="2、insert语句可以一次插入多条记录【掌握】"><a href="#2、insert语句可以一次插入多条记录【掌握】" class="headerlink" title="2、insert语句可以一次插入多条记录【掌握】"></a>2、insert语句可以一次插入多条记录【掌握】</h2><p><strong>语法</strong>：insert into t_user(字段名1,字段名2) values(),(),(),();</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; desc t_user;</span><br><span class="line">+-------------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field       | Type        | Null | Key | Default | Extra |</span><br><span class="line">+-------------+-------------+------+-----+---------+-------+</span><br><span class="line">| id          | int(11)     | YES  |     | NULL    |       |</span><br><span class="line">| name        | varchar(32) | YES  |     | NULL    |       |</span><br><span class="line">| birth       | date        | YES  |     | NULL    |       |</span><br><span class="line">| create_time | datetime    | YES  |     | NULL    |       |</span><br><span class="line">+-------------+-------------+------+-----+---------+-------+</span><br><span class="line">一次可以插入多条记录：</span><br><span class="line">insert into t_user(id,name,birth,create_time) values</span><br><span class="line">(1,&#x27;zs&#x27;,&#x27;1980-10-11&#x27;,now()), </span><br><span class="line">(2,&#x27;lisi&#x27;,&#x27;1981-10-11&#x27;,now()),</span><br><span class="line">(3,&#x27;wangwu&#x27;,&#x27;1982-10-11&#x27;,now());</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from t_user;</span><br><span class="line">+------+--------+------------+---------------------+</span><br><span class="line">| id   | name   | birth      | create_time         |</span><br><span class="line">+------+--------+------------+---------------------+</span><br><span class="line">|    1 | zs     | 1980-10-11 | 2020-03-19 09:37:01 |</span><br><span class="line">|    2 | lisi   | 1981-10-11 | 2020-03-19 09:37:01 |</span><br><span class="line">|    3 | wangwu | 1982-10-11 | 2020-03-19 09:37:01 |</span><br><span class="line">+------+--------+------------+---------------------+</span><br></pre></td></tr></table></figure><h2 id="3、快速创建表？【了解内容】"><a href="#3、快速创建表？【了解内容】" class="headerlink" title="3、快速创建表？【了解内容】"></a>3、快速创建表？【了解内容】</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table emp2 as select * from emp;</span><br><span class="line"></span><br><span class="line">原理：</span><br><span class="line">将一个查询结果当做一张表新建</span><br><span class="line">这个可以完成表的快速复制</span><br><span class="line">表创建出来，同时表中的数据也存在了</span><br><span class="line"></span><br><span class="line">create table mytable as select empno,ename from emp where job = &#x27;MANAGER&#x27;;</span><br></pre></td></tr></table></figure><h2 id="4、将查询结果插入到一张表当中，insert相关【了解内容】"><a href="#4、将查询结果插入到一张表当中，insert相关【了解内容】" class="headerlink" title="4、将查询结果插入到一张表当中，insert相关【了解内容】"></a>4、将查询结果插入到一张表当中，insert相关【了解内容】</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">create table dept_bak as select * from dept;</span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">insert into dept_bak select * from dept; //很少用！</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br></pre></td></tr></table></figure><h2 id="5、快速删除表中的数据【truncate比较重要，必须掌握】"><a href="#5、快速删除表中的数据【truncate比较重要，必须掌握】" class="headerlink" title="5、快速删除表中的数据【truncate比较重要，必须掌握】"></a>5、快速删除表中的数据【truncate比较重要，必须掌握】</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//删除dept_bak表中的数据</span><br><span class="line">delete from dept_bak; //这种删除数据的方式比较慢。</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure><p>delete语句删除数据的原理（delete属于DML语句）<br>    表中的数据被删除了，但是这个数据在硬盘上的真实存储空间不会被释放<br>    这种删除缺点是：删除效率比较低<br>    这种删除优点是：支持回滚，后悔了可以再<strong>恢复数据</strong></p><p>truncate语句删除数据的原理<br>    这种删除效率比较高，表被一次截断，物理删除<br>    这种删除缺点：不支持回滚<br>    这种删除优点：快速</p><p>用法：truncate table dept_bak; （这种操作属于DDL操作。）</p><p>大表非常大，上亿条记录<br>    删除的时候，使用delete，也许需要执行1个小时才能删除完，效率较低。<br>    可以选择使用truncate删除表中的数据。只需要不到1秒钟的时间就删除结束。效率较高。<br>    但是使用truncate之前，必须仔细询问客户是否真的要删除，并警告删除之后不可恢复！<br>    truncate是删除表中的数据，表还在！</p><p>删除表操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table 表名; // 这不是删除表中的数据，这是把表删除。</span><br></pre></td></tr></table></figure><p>6、对表结构的增删改</p><p>什么是对表结构的修改？<br>    添加一个字段，删除一个字段，修改一个字段</p><p>对表结构的修改需要使用：<strong>alter</strong><br>属于DDL语句</p><p>DDL包括：create drop alter</p><p>第一：在实际的开发中，需求一旦确定之后，表一旦设计好之后，很少的<br>进行表结构的修改。因为开发进行中的时候，修改表结构，成本比较高。<br>修改表的结构，对应的java代码就需要进行大量的修改。成本是比较高的。<br>这个责任应该由设计人员来承担！</p><p>第二：由于修改表结构的操作很少，所以我们不需要掌握，如果有一天<br>真的要修改表结构，你可以使用工具！</p><p>修改表结构的操作是不需要写到java程序中的，实际上也不是java程序员的范畴。</p><h2 id="7、约束（非常重要，五颗星-）"><a href="#7、约束（非常重要，五颗星-）" class="headerlink" title="7、约束（非常重要，五颗星*****）"></a>7、约束（非常重要，五颗星*****）</h2><h3 id="7-1-什么是约束"><a href="#7-1-什么是约束" class="headerlink" title="7.1 什么是约束"></a>7.1 什么是约束</h3><p>约束对应的英语单词：constraint<br>    在创建表的时候，我们可以给表中的字段加上一些约束，来保证这个表中数据的完整性、有效性，约束的作用就是为了保证：表中的数据有效！</p><h3 id="7-2-约束包括哪些"><a href="#7-2-约束包括哪些" class="headerlink" title="7.2 约束包括哪些"></a>7.2 约束包括哪些</h3><ul><li>非空约束：not null</li><li>唯一性约束: unique</li><li>主键约束: primary key （简称PK）</li><li>外键约束：foreign key（简称FK）</li><li>检查约束：check（mysql不支持，oracle支持）</li></ul><p>我们这里重点学习四个约束：<br>    not null<br>    unique<br>    primary key<br>    foreign key</p><h3 id="7-3-非空约束：not-null"><a href="#7-3-非空约束：not-null" class="headerlink" title="7.3 非空约束：not null"></a>7.3 非空约束：not null</h3><p>非空约束not null约束的字段不能为NULL。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table t_vip(</span><br><span class="line">id int,</span><br><span class="line">name varchar(255) not null  // not null只有列级约束，没有表级约束！</span><br><span class="line">);</span><br><span class="line">insert into t_vip(id,name) values(1,&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(id,name) values(2,&#x27;lisi&#x27;);</span><br><span class="line"></span><br><span class="line">insert into t_vip(id) values(3);</span><br><span class="line">ERROR 1364 (HY000): Field &#x27;name&#x27; doesn&#x27;t have a default value</span><br></pre></td></tr></table></figure><p><strong>小插曲：</strong><br>    xxxx.sql这种文件被称为sql脚本文件。<br>    sql脚本文件中编写了大量的sql语句。<br>    我们执行sql脚本文件的时候，该文件中所有的sql语句会全部执行！<br>    批量的执行SQL语句，可以使用sql脚本文件。<br>    在mysql当中怎么执行sql脚本呢？<br>        mysql&gt; source D:\course\03-MySQL\document\vip.sql<br>在实际的工作中，第一天到了公司，项目经理会给你一个xxx.sql文件，执行这个脚本文件，你电脑上的数据库数据就有了！</p><h3 id="7-4-唯一性约束-unique"><a href="#7-4-唯一性约束-unique" class="headerlink" title="7.4 唯一性约束: unique"></a>7.4 唯一性约束: unique</h3><p>唯一性约束unique约束的字段不能重复，但是可以为NULL。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_vip;</span><br><span class="line">create table t_vip(</span><br><span class="line">id int,</span><br><span class="line">name varchar(255) unique,</span><br><span class="line">email varchar(255)</span><br><span class="line">);</span><br><span class="line">insert into t_vip(id,name,email) values(1,&#x27;zhangsan&#x27;,&#x27;zhangsan@123.com&#x27;);</span><br><span class="line">insert into t_vip(id,name,email) values(2,&#x27;lisi&#x27;,&#x27;lisi@123.com&#x27;);</span><br><span class="line">insert into t_vip(id,name,email) values(3,&#x27;wangwu&#x27;,&#x27;wangwu@123.com&#x27;);</span><br><span class="line">select * from t_vip;</span><br><span class="line"></span><br><span class="line">insert into t_vip(id,name,email) values(4,&#x27;wangwu&#x27;,&#x27;wangwu@sina.com&#x27;);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;wangwu&#x27; for key &#x27;name&#x27;</span><br><span class="line"></span><br><span class="line">insert into t_vip(id) values(4);</span><br><span class="line">insert into t_vip(id) values(5);</span><br><span class="line">+------+----------+------------------+</span><br><span class="line">| id   | name     | email            |</span><br><span class="line">+------+----------+------------------+</span><br><span class="line">|    1 | zhangsan | zhangsan@123.com |</span><br><span class="line">|    2 | lisi     | lisi@123.com     |</span><br><span class="line">|    3 | wangwu   | wangwu@123.com   |</span><br><span class="line">|    4 | NULL     | NULL             |</span><br><span class="line">|    5 | NULL     | NULL             |</span><br><span class="line">+------+----------+------------------+</span><br></pre></td></tr></table></figure><p>name字段虽然被unique约束了，但是可以为NULL。</p><p>新需求：name和email两个字段联合起来具有唯一性</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_vip;</span><br><span class="line">create table t_vip(</span><br><span class="line">id int,</span><br><span class="line">name varchar(255) unique,  // 约束直接添加到列后面的，叫做列级约束。</span><br><span class="line">email varchar(255) unique</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>这张表这样创建是不符合我以上“新需求”的。<br>这样创建表示：name具有唯一性，email具有唯一性。各自唯一。</p><p>以下这样的数据是符合我“新需求”的。<br>但如果采用以上方式创建表的话，肯定创建失败，因为’zhangsan’和’zhangsan’重复了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">insert into t_vip(id,name,email) values(1,&#x27;zhangsan&#x27;,&#x27;zhangsan@123.com&#x27;);</span><br><span class="line">insert into t_vip(id,name,email) values(2,&#x27;zhangsan&#x27;,&#x27;zhangsan@sina.com&#x27;);</span><br><span class="line"></span><br><span class="line">怎么创建这样的表，才能符合新需求呢？</span><br><span class="line">drop table if exists t_vip;</span><br><span class="line">create table t_vip(</span><br><span class="line">id int,</span><br><span class="line">name varchar(255),</span><br><span class="line">email varchar(255),</span><br><span class="line">unique(name,email) // 约束没有添加在列的后面，这种约束被称为表级约束。</span><br><span class="line">);</span><br><span class="line">insert into t_vip(id,name,email) values(1,&#x27;zhangsan&#x27;,&#x27;zhangsan@123.com&#x27;);</span><br><span class="line">insert into t_vip(id,name,email) values(2,&#x27;zhangsan&#x27;,&#x27;zhangsan@sina.com&#x27;);</span><br><span class="line">select * from t_vip;</span><br><span class="line"></span><br><span class="line">name和email两个字段联合起来唯一！！！</span><br><span class="line">insert into t_vip(id,name,email) values(3,&#x27;zhangsan&#x27;,&#x27;zhangsan@sina.com&#x27;);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;zhangsan-zhangsan@sina.com&#x27; for key &#x27;name&#x27;</span><br></pre></td></tr></table></figure><p>什么时候使用表级约束呢？<br>    需要给多个字段联合起来添加某一个约束的时候，需要使用表级约束。</p><p>unique 和not null可以联合吗？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_vip;</span><br><span class="line">create table t_vip(</span><br><span class="line">id int,</span><br><span class="line">name varchar(255) not null unique</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">mysql&gt; desc t_vip;</span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type         | Null | Key | Default | Extra |</span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line">| id    | int(11)      | YES  |     | NULL    |       |</span><br><span class="line">| name  | varchar(255) | NO   | PRI | NULL    |       |</span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line"></span><br><span class="line">在mysql当中，如果一个字段同时被not null和unique约束的话，</span><br><span class="line">该字段自动变成主键字段。（注意：oracle中不一样！）</span><br><span class="line"></span><br><span class="line">insert into t_vip(id,name) values(1,&#x27;zhangsan&#x27;);</span><br><span class="line"></span><br><span class="line">insert into t_vip(id,name) values(2,&#x27;zhangsan&#x27;); //错误了：name不能重复</span><br><span class="line"></span><br><span class="line">insert into t_vip(id) values(2); //错误了：name不能为NULL。</span><br></pre></td></tr></table></figure><h3 id="7-5-主键约束（primary-key，简称PK）非常重要五颗星"><a href="#7-5-主键约束（primary-key，简称PK）非常重要五颗星" class="headerlink" title="7.5 主键约束（primary key，简称PK）非常重要五颗星*****"></a>7.5 主键约束（primary key，简称PK）非常重要五颗星*****</h3><p>主键约束的相关术语？<br>    主键约束：就是一种约束。<br>    主键字段：该字段上添加了主键约束，这样的字段叫做：主键字段<br>    主键值：主键字段中的每一个值都叫做：主键值。</p><p>什么是主键？有啥用？<br>    主键值是每一行记录的唯一标识。<br>    主键值是每一行记录的身份证号！！！</p><p>记住：任何一张表都应该有主键，没有主键，表无效！！</p><p>主键的特征：not null + unique（主键值不能是NULL，同时也不能重复！）</p><p>怎么给一张表添加主键约束呢？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_vip;</span><br><span class="line">// 1个字段做主键，叫做：单一主键</span><br><span class="line">create table t_vip(</span><br><span class="line">id int primary key,  //列级约束</span><br><span class="line">name varchar(255)</span><br><span class="line">);</span><br><span class="line">insert into t_vip(id,name) values(1,&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(id,name) values(2,&#x27;lisi&#x27;);</span><br><span class="line"></span><br><span class="line">//错误：不能重复</span><br><span class="line">insert into t_vip(id,name) values(2,&#x27;wangwu&#x27;);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;2&#x27; for key &#x27;PRIMARY&#x27;</span><br><span class="line"></span><br><span class="line">//错误：不能为NULL</span><br><span class="line">insert into t_vip(name) values(&#x27;zhaoliu&#x27;);</span><br><span class="line">ERROR 1364 (HY000): Field &#x27;id&#x27; doesn&#x27;t have a default value</span><br><span class="line"></span><br><span class="line">可以这样添加主键吗，使用表级约束？</span><br><span class="line">drop table if exists t_vip;</span><br><span class="line">create table t_vip(</span><br><span class="line">id int,</span><br><span class="line">name varchar(255),</span><br><span class="line">primary key(id)  // 表级约束</span><br><span class="line">);</span><br><span class="line">insert into t_vip(id,name) values(1,&#x27;zhangsan&#x27;);</span><br><span class="line"></span><br><span class="line">//错误</span><br><span class="line">insert into t_vip(id,name) values(1,&#x27;lisi&#x27;);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;1&#x27; for key &#x27;PRIMARY&#x27;</span><br><span class="line"></span><br><span class="line">表级约束主要是给多个字段联合起来添加约束？</span><br><span class="line">drop table if exists t_vip;</span><br><span class="line">// id和name联合起来做主键：复合主键！！！！</span><br><span class="line">create table t_vip(</span><br><span class="line">id int,</span><br><span class="line">name varchar(255),</span><br><span class="line">email varchar(255),</span><br><span class="line">primary key(id,name)</span><br><span class="line">);</span><br><span class="line">insert into t_vip(id,name,email) values(1,&#x27;zhangsan&#x27;,&#x27;zhangsan@123.com&#x27;);</span><br><span class="line">insert into t_vip(id,name,email) values(1,&#x27;lisi&#x27;,&#x27;lisi@123.com&#x27;);</span><br><span class="line"></span><br><span class="line">//错误：不能重复</span><br><span class="line">insert into t_vip(id,name,email) values(1,&#x27;lisi&#x27;,&#x27;lisi@123.com&#x27;);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;1-lisi&#x27; for key &#x27;PRIMARY&#x27;</span><br></pre></td></tr></table></figure><p>在实际开发中不建议使用：复合主键。建议使用单一主键！<br>因为主键值存在的意义就是这行记录的身份证号，只要意义达到即可，单一主键可以做到。<br>复合主键比较复杂，不建议使用！</p><p>一个表中主键约束能加两个吗？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_vip;</span><br><span class="line">create table t_vip(</span><br><span class="line">id int primary key,</span><br><span class="line">name varchar(255) primary key</span><br><span class="line">);</span><br><span class="line">ERROR 1068 (42000): Multiple primary key defined</span><br></pre></td></tr></table></figure><p>结论：一张表，主键约束只能添加1个。（主键只能有1个。）</p><p>主键值建议使用：<br>    int<br>    bigint<br>    char<br>    等类型。</p><p>不建议使用：varchar来做主键。主键值一般都是数字，一般都是定长的！</p><p>主键除了：单一主键和复合主键之外，还可以这样进行分类？<br>    自然主键：主键值是一个自然数，和业务没关系。<br>    业务主键：主键值和业务紧密关联，例如拿银行卡账号做主键值。这就是业务主键！</p><p>在实际开发中使用业务主键多，还是使用自然主键多一些？<br>    自然主键使用比较多，因为主键只要做到不重复就行，不需要有意义。<br>    业务主键不好，因为主键一旦和业务挂钩，那么当业务发生变动的时候，<br>    可能会影响到主键值，所以业务主键不建议使用。尽量使用自然主键。</p><p>在mysql当中，有一种机制，可以帮助我们自动维护一个主键值？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_vip;</span><br><span class="line">create table t_vip(</span><br><span class="line">id int primary key auto_increment, //auto_increment表示自增，从1开始，以1递增！</span><br><span class="line">name varchar(255)</span><br><span class="line">);</span><br><span class="line">insert into t_vip(name) values(&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(name) values(&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(name) values(&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(name) values(&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(name) values(&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(name) values(&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(name) values(&#x27;zhangsan&#x27;);</span><br><span class="line">insert into t_vip(name) values(&#x27;zhangsan&#x27;);</span><br><span class="line">select * from t_vip;</span><br><span class="line">+----+----------+</span><br><span class="line">| id | name     |</span><br><span class="line">+----+----------+</span><br><span class="line">|  1 | zhangsan |</span><br><span class="line">|  2 | zhangsan |</span><br><span class="line">|  3 | zhangsan |</span><br><span class="line">|  4 | zhangsan |</span><br><span class="line">|  5 | zhangsan |</span><br><span class="line">|  6 | zhangsan |</span><br><span class="line">|  7 | zhangsan |</span><br><span class="line">|  8 | zhangsan |</span><br><span class="line">+----+----------+</span><br></pre></td></tr></table></figure><h3 id="7-6-外键约束（foreign-key，简称FK）非常重要五颗星"><a href="#7-6-外键约束（foreign-key，简称FK）非常重要五颗星" class="headerlink" title="7.6 外键约束（foreign key，简称FK）非常重要五颗星*****"></a>7.6 外键约束（foreign key，简称FK）非常重要五颗星*****</h3><p>外键约束涉及到的相关术语：<br>    外键约束：一种约束（foreign key）<br>    外键字段：该字段上添加了外键约束<br>    外键值：外键字段当中的每一个值。</p><p>业务背景：<br>    请设计数据库表，来描述“班级和学生”的信息？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">第一种方案：班级和学生存储在一张表中？？？</span><br><span class="line">t_student</span><br><span class="line">no(pk)nameclassnoclassname</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">1jack100北京市大兴区亦庄镇第二中学高三1班</span><br><span class="line">2lucy100北京市大兴区亦庄镇第二中学高三1班</span><br><span class="line">3lilei100北京市大兴区亦庄镇第二中学高三1班</span><br><span class="line">4hanmeimei100北京市大兴区亦庄镇第二中学高三1班</span><br><span class="line">5zhangsan101北京市大兴区亦庄镇第二中学高三2班</span><br><span class="line">6lisi101北京市大兴区亦庄镇第二中学高三2班</span><br><span class="line">7wangwu101北京市大兴区亦庄镇第二中学高三2班</span><br><span class="line">8zhaoliu101北京市大兴区亦庄镇第二中学高三2班</span><br><span class="line">分析以上方案的缺点：</span><br><span class="line">数据冗余，空间浪费！！！！</span><br><span class="line">这个设计是比较失败的！</span><br><span class="line"></span><br><span class="line">第二种方案：班级一张表、学生一张表？？</span><br><span class="line"></span><br><span class="line">t_class 班级表</span><br><span class="line">classno(pk)classname</span><br><span class="line">------------------------------------------------------</span><br><span class="line">100北京市大兴区亦庄镇第二中学高三1班</span><br><span class="line">101北京市大兴区亦庄镇第二中学高三1班</span><br><span class="line"></span><br><span class="line">t_student 学生表</span><br><span class="line">no(pk)namecno(FK引用t_class这张表的classno)</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line">1jack100</span><br><span class="line">2lucy100</span><br><span class="line">3lilei100</span><br><span class="line">4hanmeimei100</span><br><span class="line">5zhangsan101</span><br><span class="line">6lisi101</span><br><span class="line">7wangwu101</span><br><span class="line">8zhaoliu101</span><br></pre></td></tr></table></figure><p>当cno字段没有任何约束的时候，可能会导致数据无效。可能出现一个102，但是102班级不存在。<br>所以为了保证cno字段中的值都是100和101，需要给cno字段添加外键约束。<br>那么：cno字段就是外键字段。cno字段中的每一个值都是外键值。</p><p>注意：<br>    t_class是父表<br>    t_student是子表</p><p>删除表的顺序？<br>    先删子，再删父。</p><p>创建表的顺序？<br>    先创建父，再创建子。</p><p>删除数据的顺序？<br>    先删子，再删父。</p><p>插入数据的顺序？<br>    先插入父，再插入子。</p><p>思考：子表中的外键引用的父表中的某个字段，被引用的这个字段必须是主键吗？<br>    不一定是主键，但至少具有unique约束。</p><p>测试：外键可以为NULL吗？<br>    外键值可以为NULL。</p><h2 id="8、存储引擎（了解内容）"><a href="#8、存储引擎（了解内容）" class="headerlink" title="8、存储引擎（了解内容）"></a>8、存储引擎（了解内容）</h2><h3 id="8-1-什么是存储引擎，有什么用"><a href="#8-1-什么是存储引擎，有什么用" class="headerlink" title="8.1 什么是存储引擎，有什么用"></a>8.1 什么是存储引擎，有什么用</h3><p>​存储引擎是MySQL中特有的一个术语，其它数据库中没有。（Oracle中有，但是不叫这个名字）<br>​存储引擎这个名字高端大气上档次。<br>​实际上存储引擎是一个表存储&#x2F;组织数据的方式。<br>​不同的存储引擎，表存储数据的方式不同。</p><h3 id="8-2-怎么给表添加-x2F-指定“存储引擎”"><a href="#8-2-怎么给表添加-x2F-指定“存储引擎”" class="headerlink" title="8.2 怎么给表添加&#x2F;指定“存储引擎”"></a>8.2 怎么给表添加&#x2F;指定“存储引擎”</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">show create table t_student;</span><br><span class="line">可以在建表的时候给表指定存储引擎。</span><br><span class="line">CREATE TABLE `t_student` (</span><br><span class="line">  `no` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(255) DEFAULT NULL,</span><br><span class="line">  `cno` int(11) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`no`),</span><br><span class="line">  KEY `cno` (`cno`),</span><br><span class="line">  CONSTRAINT `t_student_ibfk_1` FOREIGN KEY (`cno`) REFERENCES `t_class` (`classno`)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8</span><br></pre></td></tr></table></figure><p>在建表的时候可以在最后小括号的”)”的右边使用：<br>    ENGINE来指定存储引擎。<br>    CHARSET来指定这张表的字符编码方式。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">结论：</span><br><span class="line"><span class="code">mysql默认的存储引擎是：InnoDB</span></span><br><span class="line"><span class="code">mysql默认的字符编码方式是：utf8</span></span><br></pre></td></tr></table></figure><p>建表时指定存储引擎，以及字符编码方式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table t_product(</span><br><span class="line">id int primary key,</span><br><span class="line">name varchar(255)</span><br><span class="line">)engine=InnoDB default charset=gbk;</span><br></pre></td></tr></table></figure><h3 id="8-3-怎么查看mysql支持哪些存储引擎"><a href="#8-3-怎么查看mysql支持哪些存储引擎" class="headerlink" title="8.3 怎么查看mysql支持哪些存储引擎"></a>8.3 怎么查看mysql支持哪些存储引擎</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select version();</span><br><span class="line">+-----------+</span><br><span class="line">| version() |</span><br><span class="line">+-----------+</span><br><span class="line">| 5.5.36    |</span><br><span class="line">+-----------+</span><br><span class="line"></span><br><span class="line">命令： show engines \G</span><br><span class="line"></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">      Engine: FEDERATED</span><br><span class="line">     Support: NO</span><br><span class="line">     Comment: Federated MySQL storage engine</span><br><span class="line">Transactions: NULL</span><br><span class="line">          XA: NULL</span><br><span class="line">  Savepoints: NULL</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">      Engine: MRG_MYISAM</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Collection of identical MyISAM tables</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">      Engine: MyISAM</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: MyISAM storage engine</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** 4. row ***************************</span><br><span class="line">      Engine: BLACKHOLE</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: /dev/null storage engine (anything you write to it disappears</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** 5. row ***************************</span><br><span class="line">      Engine: CSV</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: CSV storage engine</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** 6. row ***************************</span><br><span class="line">      Engine: MEMORY</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Hash based, stored in memory, useful for temporary tables</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** 7. row ***************************</span><br><span class="line">      Engine: ARCHIVE</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Archive storage engine</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br><span class="line">*************************** 8. row ***************************</span><br><span class="line">      Engine: InnoDB</span><br><span class="line">     Support: DEFAULT</span><br><span class="line">     Comment: Supports transactions, row-level locking, and foreign keys</span><br><span class="line">Transactions: YES</span><br><span class="line">          XA: YES</span><br><span class="line">  Savepoints: YES</span><br><span class="line">*************************** 9. row ***************************</span><br><span class="line">      Engine: PERFORMANCE_SCHEMA</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Performance Schema</span><br><span class="line">Transactions: NO</span><br><span class="line">          XA: NO</span><br><span class="line">  Savepoints: NO</span><br></pre></td></tr></table></figure><p>mysql支持九大存储引擎，当前5.5.36支持8个。版本不同支持情况不同。</p><h3 id="8-4-关于mysql常用的存储引擎介绍一下"><a href="#8-4-关于mysql常用的存储引擎介绍一下" class="headerlink" title="8.4 关于mysql常用的存储引擎介绍一下"></a>8.4 关于mysql常用的存储引擎介绍一下</h3><p><strong>MyISAM存储引擎</strong><br>    它管理的表具有以下特征：<br>        使用三个文件表示每个表：<br>            格式文件 — 存储表结构的定义（mytable.frm）<br>            数据文件 — 存储表行的内容（mytable.MYD）<br>            索引文件 — 存储表上索引（mytable.MYI）：索引是一本书的目录，缩小扫描范围，提高查询效率的一种机制。<br>        可被转换为压缩、只读表来节省空间</p><p>提示一下：<br>        对于一张表来说，只要是主键，或者加有unique约束的字段上会自动创建索引。</p><p>MyISAM存储引擎特点：<br>    可被转换为压缩、只读表来节省空间，这是这种存储引擎的优势！</p><p>MyISAM不支持事务机制，安全性低。</p><p><strong>InnoDB存储引擎:</strong><br>    这是mysql默认的存储引擎，同时也是一个重量级的存储引擎。<br>    InnoDB支持事务，支持数据库崩溃后自动恢复机制。<br>    InnoDB存储引擎最主要的特点是：非常安全。</p><p>它管理的表具有下列主要特征：<br>    – 每个 InnoDB 表在数据库目录中以.frm 格式文件表示<br>    – InnoDB 表空间 tablespace 被用于存储表的内容（表空间是一个逻辑名称。表空间存储数据+索引。）</p><p>– 提供一组用来记录事务性活动的日志文件<br>– 用 COMMIT(提交)、SAVEPOINT 及ROLLBACK(回滚)支持事务处理<br>– 提供全 ACID 兼容<br>– 在 MySQL 服务器崩溃后提供自动恢复<br>– 多版本（MVCC）和行级锁定<br>– 支持外键及引用的完整性，包括级联删除和更新</p><p>InnoDB最大的特点就是支持事务：<br>    以保证数据的安全。效率不是很高，并且也不能压缩，不能转换为只读，<br>    不能很好的节省存储空间。</p><p><strong>MEMORY存储引擎</strong><br>    使用 MEMORY 存储引擎的表，其数据存储在内存中，且行的长度固定，<br>    这两个特点使得 MEMORY 存储引擎非常快。</p><p>MEMORY 存储引擎管理的表具有下列特征：<br>    – 在数据库目录内，每个表均以.frm 格式的文件表示。<br>    – 表数据及索引被存储在内存中。（目的就是快，查询快！）<br>    – 表级锁机制。<br>    – 不能包含 TEXT 或 BLOB 字段。</p><p>MEMORY 存储引擎以前被称为HEAP 引擎。</p><p>MEMORY引擎优点：查询效率是最高的。不需要和硬盘交互。<br>MEMORY引擎缺点：不安全，关机之后数据消失。因为数据和索引都是在内存当中。</p><h2 id="9、事务（重点：五颗星-，必须理解，必须掌握）"><a href="#9、事务（重点：五颗星-，必须理解，必须掌握）" class="headerlink" title="9、事务（重点：五颗星*****，必须理解，必须掌握）"></a>9、事务（重点：五颗星*****，必须理解，必须掌握）</h2><h3 id="9-1-什么是事务"><a href="#9-1-什么是事务" class="headerlink" title="9.1 什么是事务"></a>9.1 什么是事务</h3><p>一个事务其实就是一个完整的业务逻辑。<br>是一个最小的工作单元。不可再分。</p><p>什么是一个完整的业务逻辑？<br>    假设转账，从A账户向B账户中转账10000.<br>    将A账户的钱减去10000（update语句）<br>    将B账户的钱加上10000（update语句）<br>    这就是一个完整的业务逻辑。</p><p>以上的操作是一个最小的工作单元，要么同时成功，要么同时失败，不可再分。<br>这两个update语句要求必须同时成功或者同时失败，这样才能保证钱是正确的。</p><h3 id="9-2-只有DML语句才会有事务这一说，其它语句和事务无关"><a href="#9-2-只有DML语句才会有事务这一说，其它语句和事务无关" class="headerlink" title="9.2 只有DML语句才会有事务这一说，其它语句和事务无关"></a>9.2 只有DML语句才会有事务这一说，其它语句和事务无关</h3><p>​insert<br>​delete<br>​update<br>​只有以上的三个语句和事务有关系，其它都没有关系。</p><p>因为 只有以上的三个语句是数据库表中数据进行增、删、改的。<br>只要你的操作一旦涉及到数据的增、删、改，那么就一定要考虑安全问题。</p><p>数据安全第一位</p><h3 id="9-3-假设所有的业务，只要一条DML语句就能完成，还有必要存在事务机制吗？"><a href="#9-3-假设所有的业务，只要一条DML语句就能完成，还有必要存在事务机制吗？" class="headerlink" title="9.3 假设所有的业务，只要一条DML语句就能完成，还有必要存在事务机制吗？"></a>9.3 假设所有的业务，只要一条DML语句就能完成，还有必要存在事务机制吗？</h3><p>​正是因为做某件事的时候，需要多条DML语句共同联合起来才能完成，<br>​所以需要事务的存在。如果任何一件复杂的事儿都能一条DML语句搞定，<br>​那么事务则没有存在的价值了。</p><p>到底什么是事务呢？<br>    说到底，说到本质上，一个事务其实就是多条DML语句同时成功，或者同时失败！</p><p>事务：就是批量的DML语句同时成功，或者同时失败！</p><h3 id="9-4-事务是怎么做到多条DML语句同时成功和同时失败的"><a href="#9-4-事务是怎么做到多条DML语句同时成功和同时失败的" class="headerlink" title="9.4 事务是怎么做到多条DML语句同时成功和同时失败的"></a>9.4 事务是怎么做到多条DML语句同时成功和同时失败的</h3><p>InnoDB存储引擎：提供一组用来记录事务性活动的日志文件</p><p>事务开启了：<br>insert<br>insert<br>insert<br>delete<br>update<br>update<br>update<br>事务结束了！</p><p>在事务的执行过程中，每一条DML的操作都会记录到“事务性活动的日志文件”中。<br>在事务的执行过程中，我们可以提交事务，也可以回滚事务。</p><p><strong>提交事务</strong><br>    清空事务性活动的日志文件，将数据全部彻底持久化到数据库表中。<br>    提交事务标志着，事务的结束。并且是一种全部成功的结束。</p><p><strong>回滚事务</strong><br>    将之前所有的DML操作全部撤销，并且清空事务性活动的日志文件<br>    回滚事务标志着，事务的结束。并且是一种全部失败的结束。</p><h3 id="9-5-怎么提交事务，怎么回滚事务"><a href="#9-5-怎么提交事务，怎么回滚事务" class="headerlink" title="9.5 怎么提交事务，怎么回滚事务"></a>9.5 怎么提交事务，怎么回滚事务</h3><p>​提交事务：commit; 语句<br>​回滚事务：rollback; 语句（回滚永远都是只能回滚到上一次的提交点！）</p><p>事务对应的英语单词是：transaction</p><p>测试一下，在mysql当中默认的事务行为是怎样的？<br>    mysql默认情况下是支持自动提交事务的。（自动提交）<br>    什么是自动提交？<br>        每执行一条DML语句，则提交一次！</p><p>这种自动提交实际上是不符合我们的开发习惯，因为一个业务通常是需要多条DML语句共同执行才能完成的，为了保证数据的安全，必须要求同时成功之后再提交，所以不能执行一条就提交一条。</p><p>怎么将mysql的自动提交机制关闭掉呢？<br>    先执行这个命令：start transaction;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">演示事务：</span><br><span class="line">---------------------------------回滚事务----------------------------------------</span><br><span class="line">mysql&gt; use bjpowernode;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; start transaction;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into dept_bak values(10,&#x27;abc&#x27;, &#x27;tj&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into dept_bak values(10,&#x27;abc&#x27;, &#x27;tj&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">+--------+-------+------+</span><br><span class="line">| DEPTNO | DNAME | LOC  |</span><br><span class="line">+--------+-------+------+</span><br><span class="line">|     10 | abc   | tj   |</span><br><span class="line">|     10 | abc   | tj   |</span><br><span class="line">+--------+-------+------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; rollback;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------提交事务----------------------------------------</span><br><span class="line">mysql&gt; use bjpowernode;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">+--------+-------+------+</span><br><span class="line">| DEPTNO | DNAME | LOC  |</span><br><span class="line">+--------+-------+------+</span><br><span class="line">|     10 | abc   | bj   |</span><br><span class="line">+--------+-------+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; start transaction;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into dept_bak values(20,&#x27;abc</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into dept_bak values(20,&#x27;abc</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into dept_bak values(20,&#x27;abc</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; commit;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">+--------+-------+------+</span><br><span class="line">| DEPTNO | DNAME | LOC  |</span><br><span class="line">+--------+-------+------+</span><br><span class="line">|     10 | abc   | bj   |</span><br><span class="line">|     20 | abc   | tj   |</span><br><span class="line">|     20 | abc   | tj   |</span><br><span class="line">|     20 | abc   | tj   |</span><br><span class="line">+--------+-------+------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; rollback;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept_bak;</span><br><span class="line">+--------+-------+------+</span><br><span class="line">| DEPTNO | DNAME | LOC  |</span><br><span class="line">+--------+-------+------+</span><br><span class="line">|     10 | abc   | bj   |</span><br><span class="line">|     20 | abc   | tj   |</span><br><span class="line">|     20 | abc   | tj   |</span><br><span class="line">|     20 | abc   | tj   |</span><br><span class="line">+--------+-------+------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h3 id="9-6-事务包括4个特性"><a href="#9-6-事务包括4个特性" class="headerlink" title="9.6 事务包括4个特性"></a>9.6 事务包括4个特性</h3><p><strong>A：原子性</strong><br>    说明事务是最小的工作单元。不可再分。</p><p><strong>C：一致性</strong><br>    所有事务要求，在同一个事务当中，所有操作必须同时成功，或者同时失败，<br>    以保证数据的一致性。</p><p><strong>I：隔离性</strong><br>    A事务和B事务之间具有一定的隔离。<br>    教室A和教室B之间有一道墙，这道墙就是隔离性。<br>    A事务在操作一张表的时候，另一个事务B也操作这张表会那样？？？</p><p><strong>D：持久性</strong><br>    事务最终结束的一个保障。事务提交，就相当于将没有保存到硬盘上的数据<br>    保存到硬盘上！</p><h3 id="9-7-重点研究一下事务的隔离性"><a href="#9-7-重点研究一下事务的隔离性" class="headerlink" title="9.7 重点研究一下事务的隔离性"></a>9.7 重点研究一下事务的隔离性</h3><p>A教室和B教室中间有一道墙，这道墙可以很厚，也可以很薄。这就是事务的隔离级别。<br>这道墙越厚，表示隔离级别就越高。</p><p>事务和事务之间的隔离级别有哪些呢？4个级别</p><p>读未提交：read uncommitted（最低的隔离级别）《没有提交就读到了》<br>        事务A可以读取到事务B未提交的数据。<br>    这种隔离级别存在的问题就是：<br>        脏读现象！(Dirty Read)<br>        我们称读到了脏数据。<br>    这种隔离级别一般都是理论上的，大多数的数据库隔离级别都是二档起步！</p><p>读已提交：read committed《提交之后才能读到》<br>    什么是读已提交？<br>        事务A只能读取到事务B提交之后的数据。<br>    这种隔离级别解决了什么问题？<br>        解决了脏读的现象。<br>    这种隔离级别存在什么问题？<br>        不可重复读取数据。<br>        什么是不可重复读取数据呢？<br>            在事务开启之后，第一次读到的数据是3条，当前事务还没有<br>            结束，可能第二次再读取的时候，读到的数据是4条，3不等于4<br>            称为不可重复读取。</p><p>这种隔离级别是比较真实的数据，每一次读到的数据是绝对的真实。<br>oracle数据库默认的隔离级别是：read committed</p><p>可重复读：repeatable read《提交之后也读不到，永远读取的都是刚开启事务时的数据》<br>    什么是可重复读取？<br>        事务A开启之后，不管是多久，每一次在事务A中读取到的数据<br>        都是一致的。即使事务B将数据已经修改，并且提交了，事务A<br>        读取到的数据还是没有发生改变，这就是可重复读。<br>    可重复读解决了什么问题？<br>        解决了不可重复读取数据。<br>    可重复读存在的问题是什么？<br>        可以会出现幻影读。<br>        每一次读取到的数据都是幻象。不够真实！<br>    早晨9点开始开启了事务，只要事务不结束，到晚上9点，读到的数据还是那样！<br>读到的是假象。不够绝对的真实。</p><p>mysql中默认的事务隔离级别就是这个</p><p>序列化&#x2F;串行化：serializable（最高的隔离级别）<br>    这是最高隔离级别，效率最低。解决了所有的问题。<br>    这种隔离级别表示事务排队，不能并发！<br>    synchronized，线程同步（事务同步）<br>    每一次读取到的数据都是最真实的，并且效率是最低的。</p><h3 id="9-8-验证各种隔离级别"><a href="#9-8-验证各种隔离级别" class="headerlink" title="9.8 验证各种隔离级别"></a>9.8 验证各种隔离级别</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">查看隔离级别：SELECT @@tx_isolation</span><br><span class="line">+-----------------+</span><br><span class="line">| @@tx_isolation  |</span><br><span class="line">+-----------------+</span><br><span class="line">| REPEATABLE-READ |</span><br><span class="line">+-----------------+</span><br><span class="line">mysql默认的隔离级别</span><br><span class="line">被测试的表t_user</span><br><span class="line">验证：read uncommited</span><br><span class="line">mysql&gt; set global transaction isolation level read uncommitted;</span><br></pre></td></tr></table></figure><h4 id="事务A事务B"><a href="#事务A事务B" class="headerlink" title="事务A事务B"></a>事务A事务B</h4><p>use bjpowernode;<br>                                                    use bjpowernode;<br>start transaction;<br>select * from t_user;<br>                                                    start transaction;<br>                                                    insert into t_user values(‘zhangsan’);<br>select * from t_user;</p><p>验证：read commited<br>mysql&gt; set global transaction isolation level read committed;</p><h4 id="事务A事务B-1"><a href="#事务A事务B-1" class="headerlink" title="事务A事务B"></a>事务A事务B</h4><p>use bjpowernode;<br>                                                    use bjpowernode;<br>start transaction;<br>                                                    start transaction;<br>select * from t_user;<br>                                                    insert into t_user values(‘zhangsan’);<br>select * from t_user;<br>                                                    commit;<br>select * from t_user;</p><p>验证：repeatable read<br>mysql&gt; set global transaction isolation level repeatable read;</p><h4 id="事务A事务B-2"><a href="#事务A事务B-2" class="headerlink" title="事务A事务B"></a>事务A事务B</h4><p>use bjpowernode;<br>                                                    use bjpowernode;<br>start transaction;<br>                                                    start transaction;<br>select * from t_user;<br>                                                    insert into t_user values(‘lisi’);<br>                                                    insert into t_user values(‘wangwu’);<br>                                                    commit;<br>select * from t_user;</p><p>验证：serializable<br>mysql&gt; set global transaction isolation level serializable;</p><h4 id="事务A事务B-3"><a href="#事务A事务B-3" class="headerlink" title="事务A事务B"></a>事务A事务B</h4><p>use bjpowernode;<br>                                                    use bjpowernode;<br>start transaction;<br>                                                    start transaction;<br>select * from t_user;<br>insert into t_user values(‘abc’);<br>                                                    select * from t_user;</p>]]></content>
      
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL学习day02</title>
      <link href="/post/9436f855.html"/>
      <url>/post/9436f855.html</url>
      
        <content type="html"><![CDATA[<h1 id="MySQL学习-day02"><a href="#MySQL学习-day02" class="headerlink" title="MySQL学习-day02"></a>MySQL学习-day02</h1><h2 id="1、把查询结果去除重复记录【distinct】"><a href="#1、把查询结果去除重复记录【distinct】" class="headerlink" title="1、把查询结果去除重复记录【distinct】"></a>1、把查询结果去除重复记录【distinct】</h2><p><strong>注意：</strong>原表数据不会被修改，只是查询结果去重。<br>去重需要使用一个关键字：<code>distinct</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select distinct job from emp;</span><br><span class="line">+-----------+</span><br><span class="line">| job       |</span><br><span class="line">+-----------+</span><br><span class="line">| CLERK     |</span><br><span class="line">| SALESMAN  |</span><br><span class="line">| MANAGER   |</span><br><span class="line">| ANALYST   |</span><br><span class="line">| PRESIDENT |</span><br><span class="line">+-----------+</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ename,distinct job from emp;</span><br></pre></td></tr></table></figure><p>这样编写是错误的，语法错误：distinct只能出现在所有字段的最前方。</p><p>distinct出现在job,deptno两个字段之前，表示两个字段联合起来去重。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select distinct job,deptno from emp;</span><br><span class="line">+-----------+--------+</span><br><span class="line">| job       | deptno |</span><br><span class="line">+-----------+--------+</span><br><span class="line">| CLERK     |     20 |</span><br><span class="line">| SALESMAN  |     30 |</span><br><span class="line">| MANAGER   |     20 |</span><br><span class="line">| MANAGER   |     30 |</span><br><span class="line">| MANAGER   |     10 |</span><br><span class="line">| ANALYST   |     20 |</span><br><span class="line">| PRESIDENT |     10 |</span><br><span class="line">| CLERK     |     30 |</span><br><span class="line">| CLERK     |     10 |</span><br><span class="line">+-----------+--------+</span><br><span class="line"></span><br><span class="line">统计一下工作岗位的数量？</span><br><span class="line">select count(distinct job) from emp;</span><br><span class="line">+---------------------+</span><br><span class="line">| count(distinct job) |</span><br><span class="line">+---------------------+</span><br><span class="line">|                   5 |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure><h2 id="2、连接查询"><a href="#2、连接查询" class="headerlink" title="2、连接查询"></a>2、连接查询</h2><h3 id="2-1-什么是连接查询？"><a href="#2-1-什么是连接查询？" class="headerlink" title="2.1 什么是连接查询？"></a>2.1 什么是连接查询？</h3><p>​从一张表中单独查询，称为单表查询。<br>​emp表和dept表联合起来查询数据，从emp表中取员工名字，从dept表中取部门名字。<br>​这种跨表查询，多张表联合起来查询数据，被称为连接查询。</p><h3 id="2-2-连接查询的分类"><a href="#2-2-连接查询的分类" class="headerlink" title="2.2 连接查询的分类"></a>2.2 连接查询的分类</h3><p>根据语法的年代分类：<br>    SQL92：1992年的时候出现的语法<br>    SQL99：1999年的时候出现的语法<br>重点学习SQL99.(这个过程中简单演示一个SQL92的例子)</p><p>根据表连接的方式分类：<br>    内连接：<br>        等值连接<br>        非等值连接<br>        自连接</p><p>外连接：<br>    左外连接（左连接）<br>    右外连接（右连接）<br>​全连接</p><h3 id="2-3-当两张表进行连接查询时，没有任何条件的限制会发生什么现象？"><a href="#2-3-当两张表进行连接查询时，没有任何条件的限制会发生什么现象？" class="headerlink" title="2.3 当两张表进行连接查询时，没有任何条件的限制会发生什么现象？"></a>2.3 当两张表进行连接查询时，没有任何条件的限制会发生什么现象？</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">案例：查询每个员工所在部门名称？</span><br><span class="line">mysql&gt; select ename,deptno from emp;</span><br><span class="line">+--------+--------+</span><br><span class="line">| ename  | deptno |</span><br><span class="line">+--------+--------+</span><br><span class="line">| SMITH  |     20 |</span><br><span class="line">| ALLEN  |     30 |</span><br><span class="line">| WARD   |     30 |</span><br><span class="line">| JONES  |     20 |</span><br><span class="line">| MARTIN |     30 |</span><br><span class="line">| BLAKE  |     30 |</span><br><span class="line">| CLARK  |     10 |</span><br><span class="line">| SCOTT  |     20 |</span><br><span class="line">| KING   |     10 |</span><br><span class="line">| TURNER |     30 |</span><br><span class="line">| ADAMS  |     20 |</span><br><span class="line">| JAMES  |     30 |</span><br><span class="line">| FORD   |     20 |</span><br><span class="line">| MILLER |     10 |</span><br><span class="line">+--------+--------+</span><br><span class="line">mysql&gt; select * from dept;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line"></span><br><span class="line">两张表连接没有任何条件限制：</span><br><span class="line">select ename,dname from emp, dept;</span><br><span class="line">+--------+------------+</span><br><span class="line">| ename  | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">| SMITH  | ACCOUNTING |</span><br><span class="line">| SMITH  | RESEARCH   |</span><br><span class="line">| SMITH  | SALES      |</span><br><span class="line">| SMITH  | OPERATIONS |</span><br><span class="line">| ALLEN  | ACCOUNTING |</span><br><span class="line">| ALLEN  | RESEARCH   |</span><br><span class="line">| ALLEN  | SALES      |</span><br><span class="line">| ALLEN  | OPERATIONS |</span><br><span class="line">...</span><br><span class="line">56 rows in set (0.00 sec)</span><br><span class="line">14 * 4 = 56</span><br></pre></td></tr></table></figure><p>当两张表进行连接查询，没有任何条件限制的时候，最终查询结果条数，是两张表条数的乘积，这种现象被称为：<strong>笛卡尔积现象</strong>。（笛卡尔发现的，这是一个数学现象。）</p><h3 id="2-4-怎么避免笛卡尔积现象？"><a href="#2-4-怎么避免笛卡尔积现象？" class="headerlink" title="2.4 怎么避免笛卡尔积现象？"></a>2.4 怎么避免笛卡尔积现象？</h3><p>连接时加条件，满足这个条件的记录被筛选出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">ename,dname </span><br><span class="line">from </span><br><span class="line">emp, dept</span><br><span class="line">where</span><br><span class="line">emp.deptno = dept.deptno;</span><br><span class="line"></span><br><span class="line">select </span><br><span class="line">emp.ename,dept.dname </span><br><span class="line">from </span><br><span class="line">emp, dept</span><br><span class="line">where</span><br><span class="line">emp.deptno = dept.deptno;</span><br><span class="line"></span><br><span class="line">// 表起别名。很重要,效率问题。</span><br><span class="line">select </span><br><span class="line">e.ename,d.dname </span><br><span class="line">from </span><br><span class="line">emp e, dept d</span><br><span class="line">where</span><br><span class="line">e.deptno = d.deptno; //SQL92语法。</span><br><span class="line">+--------+------------+</span><br><span class="line">| ename  | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">| CLARK  | ACCOUNTING |</span><br><span class="line">| KING   | ACCOUNTING |</span><br><span class="line">| MILLER | ACCOUNTING |</span><br><span class="line">| SMITH  | RESEARCH   |</span><br><span class="line">| JONES  | RESEARCH   |</span><br><span class="line">| SCOTT  | RESEARCH   |</span><br><span class="line">| ADAMS  | RESEARCH   |</span><br><span class="line">| FORD   | RESEARCH   |</span><br><span class="line">| ALLEN  | SALES      |</span><br><span class="line">| WARD   | SALES      |</span><br><span class="line">| MARTIN | SALES      |</span><br><span class="line">| BLAKE  | SALES      |</span><br><span class="line">| TURNER | SALES      |</span><br><span class="line">| JAMES  | SALES      |</span><br><span class="line">+--------+------------+</span><br></pre></td></tr></table></figure><p><strong>思考：</strong>最终查询的结果条数是14条，但是匹配的过程中，匹配的次数减少了吗？还是56次，只不过进行了四选一。次数没有减少。</p><p><strong>注意</strong>：通过笛卡尔积现象得出，表的连接次数越多效率越低，尽量避免表的连接次数。</p><h3 id="2-5-内连接之等值连接。"><a href="#2-5-内连接之等值连接。" class="headerlink" title="2.5 内连接之等值连接。"></a>2.5 内连接之等值连接。</h3><p>案例：查询每个员工所在部门名称，显示员工名和部门名<br>emp e和dept d表进行连接，条件是：e.deptno &#x3D; d.deptno</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">SQL92语法：</span><br><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">emp e, dept d</span><br><span class="line">where</span><br><span class="line">e.deptno = d.deptno;</span><br><span class="line"></span><br><span class="line">SQL99语法：</span><br><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">join</span><br><span class="line">dept d</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno;</span><br><span class="line"></span><br><span class="line">//inner可以省略（带着inner可读性更好，一眼就能看出来是内连接）</span><br><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">inner join</span><br><span class="line">dept d</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno; // 条件是等量关系，所以被称为等值连接。</span><br></pre></td></tr></table></figure><p>​sql92的缺点：结构不清晰，表的连接条件，和后期进一步筛选的条件，都放到了where后面。<br>​sql99优点：表连接的条件是独立的，连接之后，如果还需要进一步筛选，再往后继续添加where</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SQL99语法：</span><br><span class="line">select </span><br><span class="line">...</span><br><span class="line">from</span><br><span class="line">a</span><br><span class="line">join</span><br><span class="line">b</span><br><span class="line">on</span><br><span class="line">a和b的连接条件</span><br><span class="line">where</span><br><span class="line">筛选条件</span><br></pre></td></tr></table></figure><h3 id="2-6-内连接之非等值连接"><a href="#2-6-内连接之非等值连接" class="headerlink" title="2.6 内连接之非等值连接"></a>2.6 内连接之非等值连接</h3><p>案例：找出每个员工的薪资等级，要求显示员工名、薪资、薪资等级</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from emp; </span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |</span><br><span class="line">|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |</span><br><span class="line">|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |</span><br><span class="line">|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from salgrade; </span><br><span class="line">+-------+-------+-------+</span><br><span class="line">| GRADE | LOSAL | HISAL |</span><br><span class="line">+-------+-------+-------+</span><br><span class="line">|     1 |   700 |  1200 |</span><br><span class="line">|     2 |  1201 |  1400 |</span><br><span class="line">|     3 |  1401 |  2000 |</span><br><span class="line">|     4 |  2001 |  3000 |</span><br><span class="line">|     5 |  3001 |  9999 |</span><br><span class="line">+-------+-------+-------+</span><br><span class="line"></span><br><span class="line">select </span><br><span class="line">e.ename, e.sal, s.grade</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">join</span><br><span class="line">salgrade s</span><br><span class="line">on</span><br><span class="line">e.sal between s.losal and s.hisal; // 条件不是一个等量关系，称为非等值连接。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select </span><br><span class="line">e.ename, e.sal, s.grade</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">inner join</span><br><span class="line">salgrade s</span><br><span class="line">on</span><br><span class="line">e.sal between s.losal and s.hisal;</span><br><span class="line"></span><br><span class="line">+--------+---------+-------+</span><br><span class="line">| ename  | sal     | grade |</span><br><span class="line">+--------+---------+-------+</span><br><span class="line">| SMITH  |  800.00 |     1 |</span><br><span class="line">| ALLEN  | 1600.00 |     3 |</span><br><span class="line">| WARD   | 1250.00 |     2 |</span><br><span class="line">| JONES  | 2975.00 |     4 |</span><br><span class="line">| MARTIN | 1250.00 |     2 |</span><br><span class="line">| BLAKE  | 2850.00 |     4 |</span><br><span class="line">| CLARK  | 2450.00 |     4 |</span><br><span class="line">| SCOTT  | 3000.00 |     4 |</span><br><span class="line">| KING   | 5000.00 |     5 |</span><br><span class="line">| TURNER | 1500.00 |     3 |</span><br><span class="line">| ADAMS  | 1100.00 |     1 |</span><br><span class="line">| JAMES  |  950.00 |     1 |</span><br><span class="line">| FORD   | 3000.00 |     4 |</span><br><span class="line">| MILLER | 1300.00 |     2 |</span><br><span class="line">+--------+---------+-------+</span><br></pre></td></tr></table></figure><h3 id="2-7-内连接之自连接"><a href="#2-7-内连接之自连接" class="headerlink" title="2.7 内连接之自连接"></a>2.7 内连接之自连接</h3><p>案例：查询员工的上级领导，要求显示员工名和对应的领导名？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select empno,ename,mgr from emp;</span><br><span class="line">+-------+--------+------+</span><br><span class="line">| empno | ename  | mgr  |</span><br><span class="line">+-------+--------+------+</span><br><span class="line">|  7369 | SMITH  | 7902 |</span><br><span class="line">|  7499 | ALLEN  | 7698 |</span><br><span class="line">|  7521 | WARD   | 7698 |</span><br><span class="line">|  7566 | JONES  | 7839 |</span><br><span class="line">|  7654 | MARTIN | 7698 |</span><br><span class="line">|  7698 | BLAKE  | 7839 |</span><br><span class="line">|  7782 | CLARK  | 7839 |</span><br><span class="line">|  7788 | SCOTT  | 7566 |</span><br><span class="line">|  7839 | KING   | NULL |</span><br><span class="line">|  7844 | TURNER | 7698 |</span><br><span class="line">|  7876 | ADAMS  | 7788 |</span><br><span class="line">|  7900 | JAMES  | 7698 |</span><br><span class="line">|  7902 | FORD   | 7566 |</span><br><span class="line">|  7934 | MILLER | 7782 |</span><br><span class="line">+-------+--------+------+</span><br><span class="line"></span><br><span class="line">技巧：一张表看成两张表。</span><br><span class="line">emp a 员工表</span><br><span class="line">+-------+--------+------+</span><br><span class="line">| empno | ename  | mgr  |</span><br><span class="line">+-------+--------+------+</span><br><span class="line">|  7369 | SMITH  | 7902 |</span><br><span class="line">|  7499 | ALLEN  | 7698 |</span><br><span class="line">|  7521 | WARD   | 7698 |</span><br><span class="line">|  7566 | JONES  | 7839 |</span><br><span class="line">|  7654 | MARTIN | 7698 |</span><br><span class="line">|  7698 | BLAKE  | 7839 |</span><br><span class="line">|  7782 | CLARK  | 7839 |</span><br><span class="line">|  7788 | SCOTT  | 7566 |</span><br><span class="line">|  7839 | KING   | NULL |</span><br><span class="line">|  7844 | TURNER | 7698 |</span><br><span class="line">|  7876 | ADAMS  | 7788 |</span><br><span class="line">|  7900 | JAMES  | 7698 |</span><br><span class="line">|  7902 | FORD   | 7566 |</span><br><span class="line">|  7934 | MILLER | 7782 |</span><br><span class="line">+-------+--------+------+</span><br><span class="line"></span><br><span class="line">emp b 领导表</span><br><span class="line">+-------+--------+------+</span><br><span class="line">| empno | ename  | mgr  |</span><br><span class="line">+-------+--------+------+</span><br><span class="line">|  7369 | SMITH  | 7902 |</span><br><span class="line">|  7499 | ALLEN  | 7698 |</span><br><span class="line">|  7521 | WARD   | 7698 |</span><br><span class="line">|  7566 | JONES  | 7839 |</span><br><span class="line">|  7654 | MARTIN | 7698 |</span><br><span class="line">|  7698 | BLAKE  | 7839 |</span><br><span class="line">|  7782 | CLARK  | 7839 |</span><br><span class="line">|  7788 | SCOTT  | 7566 |</span><br><span class="line">|  7839 | KING   | NULL |</span><br><span class="line">|  7844 | TURNER | 7698 |</span><br><span class="line">|  7876 | ADAMS  | 7788 |</span><br><span class="line">|  7900 | JAMES  | 7698 |</span><br><span class="line">|  7902 | FORD   | 7566 |</span><br><span class="line">|  7934 | MILLER | 7782 |</span><br><span class="line">+-------+--------+------+</span><br><span class="line"></span><br><span class="line">select </span><br><span class="line">a.ename as &#x27;员工名&#x27;, b.ename as &#x27;领导名&#x27;</span><br><span class="line">from</span><br><span class="line">emp a</span><br><span class="line">join</span><br><span class="line">emp b</span><br><span class="line">on</span><br><span class="line">a.mgr = b.empno; //员工的领导编号 = 领导的员工编号</span><br><span class="line"></span><br><span class="line">+--------+--------+</span><br><span class="line">| 员工名 | 领导名|</span><br><span class="line">+--------+--------+</span><br><span class="line">| SMITH  | FORD   |</span><br><span class="line">| ALLEN  | BLAKE  |</span><br><span class="line">| WARD   | BLAKE  |</span><br><span class="line">| JONES  | KING   |</span><br><span class="line">| MARTIN | BLAKE  |</span><br><span class="line">| BLAKE  | KING   |</span><br><span class="line">| CLARK  | KING   |</span><br><span class="line">| SCOTT  | JONES  |</span><br><span class="line">| TURNER | BLAKE  |</span><br><span class="line">| ADAMS  | SCOTT  |</span><br><span class="line">| JAMES  | BLAKE  |</span><br><span class="line">| FORD   | JONES  |</span><br><span class="line">| MILLER | CLARK  |</span><br><span class="line">+--------+--------+</span><br><span class="line">13条记录，没有KING。《内连接》</span><br></pre></td></tr></table></figure><p>以上就是内连接中的：自连接，技巧：<strong>一张表看做两张表</strong>。</p><h3 id="2-8-外连接"><a href="#2-8-外连接" class="headerlink" title="2.8 外连接"></a>2.8 外连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from emp;</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |</span><br><span class="line">|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |</span><br><span class="line">|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |</span><br><span class="line">|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |</span><br><span class="line">|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |</span><br><span class="line">|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |</span><br><span class="line">|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |</span><br><span class="line">|  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 |</span><br><span class="line">|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |</span><br><span class="line">|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |</span><br><span class="line">|  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 |</span><br><span class="line">|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |</span><br><span class="line">|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |</span><br><span class="line">|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br></pre></td></tr></table></figure><p>内连接：（A和B连接，AB两张表没有主次关系。平等的。）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">join</span><br><span class="line">dept d</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno; //内连接的特点：完成能够匹配上这个条件的数据查询出来。</span><br><span class="line"></span><br><span class="line">+--------+------------+</span><br><span class="line">| ename  | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">| CLARK  | ACCOUNTING |</span><br><span class="line">| KING   | ACCOUNTING |</span><br><span class="line">| MILLER | ACCOUNTING |</span><br><span class="line">| SMITH  | RESEARCH   |</span><br><span class="line">| JONES  | RESEARCH   |</span><br><span class="line">| SCOTT  | RESEARCH   |</span><br><span class="line">| ADAMS  | RESEARCH   |</span><br><span class="line">| FORD   | RESEARCH   |</span><br><span class="line">| ALLEN  | SALES      |</span><br><span class="line">| WARD   | SALES      |</span><br><span class="line">| MARTIN | SALES      |</span><br><span class="line">| BLAKE  | SALES      |</span><br><span class="line">| TURNER | SALES      |</span><br><span class="line">| JAMES  | SALES      |</span><br><span class="line">+--------+------------+</span><br></pre></td></tr></table></figure><p>外连接（右外连接）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">emp e </span><br><span class="line">right join </span><br><span class="line">dept d</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno;</span><br><span class="line"></span><br><span class="line">// outer是可以省略的，带着可读性强。</span><br><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">emp e </span><br><span class="line">right outer join </span><br><span class="line">dept d</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno;</span><br></pre></td></tr></table></figure><p>right代表什么：表示将join关键字右边的这张表看成主表，主要是为了将这张表的数据全部查询出来，捎带着关联查询左边的表。在外连接当中，两张表连接，产生了主次关系。</p><p>外连接（左外连接）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">dept d </span><br><span class="line">left join </span><br><span class="line">emp e</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno;</span><br><span class="line"></span><br><span class="line">// outer是可以省略的，带着可读性强。</span><br><span class="line">select </span><br><span class="line">e.ename,d.dname</span><br><span class="line">from</span><br><span class="line">dept d </span><br><span class="line">left outer join </span><br><span class="line">emp e</span><br><span class="line">on</span><br><span class="line">e.deptno = d.deptno;</span><br><span class="line">+--------+------------+</span><br><span class="line">| ename  | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">| CLARK  | ACCOUNTING |</span><br><span class="line">| KING   | ACCOUNTING |</span><br><span class="line">| MILLER | ACCOUNTING |</span><br><span class="line">| SMITH  | RESEARCH   |</span><br><span class="line">| JONES  | RESEARCH   |</span><br><span class="line">| SCOTT  | RESEARCH   |</span><br><span class="line">| ADAMS  | RESEARCH   |</span><br><span class="line">| FORD   | RESEARCH   |</span><br><span class="line">| ALLEN  | SALES      |</span><br><span class="line">| WARD   | SALES      |</span><br><span class="line">| MARTIN | SALES      |</span><br><span class="line">| BLAKE  | SALES      |</span><br><span class="line">| TURNER | SALES      |</span><br><span class="line">| JAMES  | SALES      |</span><br><span class="line">| NULL   | OPERATIONS |</span><br><span class="line">+--------+------------+</span><br></pre></td></tr></table></figure><p>带有right的是右外连接，又叫做右连接。<br>带有left的是左外连接，又叫做左连接。<br>任何一个右连接都有左连接的写法。<br>任何一个左连接都有右连接的写法。</p><p><strong>注意：</strong>外连接的查询结果条数一定是 &gt;&#x3D; 内连接的查询结果条数</p><p>案例：查询每个员工的上级领导，要求显示所有员工的名字和领导名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">a.ename as &#x27;员工名&#x27;, b.ename as &#x27;领导名&#x27;</span><br><span class="line">from</span><br><span class="line">emp a</span><br><span class="line">left join</span><br><span class="line">emp b</span><br><span class="line">on</span><br><span class="line">a.mgr = b.empno; </span><br><span class="line">+--------+--------+</span><br><span class="line">| 员工名      | 领导名     |</span><br><span class="line">+--------+--------+</span><br><span class="line">| SMITH  | FORD   |</span><br><span class="line">| ALLEN  | BLAKE  |</span><br><span class="line">| WARD   | BLAKE  |</span><br><span class="line">| JONES  | KING   |</span><br><span class="line">| MARTIN | BLAKE  |</span><br><span class="line">| BLAKE  | KING   |</span><br><span class="line">| CLARK  | KING   |</span><br><span class="line">| SCOTT  | JONES  |</span><br><span class="line">| KING   | NULL   |</span><br><span class="line">| TURNER | BLAKE  |</span><br><span class="line">| ADAMS  | SCOTT  |</span><br><span class="line">| JAMES  | BLAKE  |</span><br><span class="line">| FORD   | JONES  |</span><br><span class="line">| MILLER | CLARK  |</span><br><span class="line">+--------+--------+</span><br></pre></td></tr></table></figure><h3 id="2-9、三张表，四张表怎么连接？"><a href="#2-9、三张表，四张表怎么连接？" class="headerlink" title="2.9、三张表，四张表怎么连接？"></a>2.9、三张表，四张表怎么连接？</h3><p>​语法：<br>​select<br>​…<br>​from<br>​a<br>​join<br>​b<br>​on<br>​a和b的连接条件<br>​join<br>​c<br>​on<br>​a和c的连接条件<br>​right join<br>​d<br>​on<br>​a和d的连接条件<br>一条SQL中内连接和外连接可以混合，都可以出现。</p><p>案例：找出每个员工的部门名称以及工资等级，要求显示员工名、部门名、薪资、薪资等级</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">e.ename,e.sal,d.dname,s.grade</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">join</span><br><span class="line">dept d</span><br><span class="line">on </span><br><span class="line">e.deptno = d.deptno</span><br><span class="line">join</span><br><span class="line">salgrade s</span><br><span class="line">on</span><br><span class="line">e.sal between s.losal and s.hisal;</span><br><span class="line"></span><br><span class="line">+--------+---------+------------+-------+</span><br><span class="line">| ename  | sal     | dname      | grade |</span><br><span class="line">+--------+---------+------------+-------+</span><br><span class="line">| SMITH  |  800.00 | RESEARCH   |     1 |</span><br><span class="line">| ALLEN  | 1600.00 | SALES      |     3 |</span><br><span class="line">| WARD   | 1250.00 | SALES      |     2 |</span><br><span class="line">| JONES  | 2975.00 | RESEARCH   |     4 |</span><br><span class="line">| MARTIN | 1250.00 | SALES      |     2 |</span><br><span class="line">| BLAKE  | 2850.00 | SALES      |     4 |</span><br><span class="line">| CLARK  | 2450.00 | ACCOUNTING |     4 |</span><br><span class="line">| SCOTT  | 3000.00 | RESEARCH   |     4 |</span><br><span class="line">| KING   | 5000.00 | ACCOUNTING |     5 |</span><br><span class="line">| TURNER | 1500.00 | SALES      |     3 |</span><br><span class="line">| ADAMS  | 1100.00 | RESEARCH   |     1 |</span><br><span class="line">| JAMES  |  950.00 | SALES      |     1 |</span><br><span class="line">| FORD   | 3000.00 | RESEARCH   |     4 |</span><br><span class="line">| MILLER | 1300.00 | ACCOUNTING |     2 |</span><br><span class="line">+--------+---------+------------+-------+</span><br><span class="line"></span><br><span class="line">案例：找出每个员工的部门名称以及工资等级，还有上级领导，要求显示员工名、领导名、部门名、薪资、薪资等级</span><br><span class="line">select </span><br><span class="line">e.ename,e.sal,d.dname,s.grade,l.ename</span><br><span class="line">from</span><br><span class="line">emp e</span><br><span class="line">join</span><br><span class="line">dept d</span><br><span class="line">on </span><br><span class="line">e.deptno = d.deptno</span><br><span class="line">join</span><br><span class="line">salgrade s</span><br><span class="line">on</span><br><span class="line">e.sal between s.losal and s.hisal</span><br><span class="line">left join</span><br><span class="line">emp l</span><br><span class="line">on</span><br><span class="line">e.mgr = l.empno;</span><br><span class="line"></span><br><span class="line">+--------+---------+------------+-------+-------+</span><br><span class="line">| ename  | sal     | dname      | grade | ename |</span><br><span class="line">+--------+---------+------------+-------+-------+</span><br><span class="line">| SMITH  |  800.00 | RESEARCH   |     1 | FORD  |</span><br><span class="line">| ALLEN  | 1600.00 | SALES      |     3 | BLAKE |</span><br><span class="line">| WARD   | 1250.00 | SALES      |     2 | BLAKE |</span><br><span class="line">| JONES  | 2975.00 | RESEARCH   |     4 | KING  |</span><br><span class="line">| MARTIN | 1250.00 | SALES      |     2 | BLAKE |</span><br><span class="line">| BLAKE  | 2850.00 | SALES      |     4 | KING  |</span><br><span class="line">| CLARK  | 2450.00 | ACCOUNTING |     4 | KING  |</span><br><span class="line">| SCOTT  | 3000.00 | RESEARCH   |     4 | JONES |</span><br><span class="line">| KING   | 5000.00 | ACCOUNTING |     5 | NULL  |</span><br><span class="line">| TURNER | 1500.00 | SALES      |     3 | BLAKE |</span><br><span class="line">| ADAMS  | 1100.00 | RESEARCH   |     1 | SCOTT |</span><br><span class="line">| JAMES  |  950.00 | SALES      |     1 | BLAKE |</span><br><span class="line">| FORD   | 3000.00 | RESEARCH   |     4 | JONES |</span><br><span class="line">| MILLER | 1300.00 | ACCOUNTING |     2 | CLARK |</span><br><span class="line">+--------+---------+------------+-------+-------+</span><br></pre></td></tr></table></figure><h2 id="3、子查询"><a href="#3、子查询" class="headerlink" title="3、子查询"></a>3、子查询</h2><h3 id="3-1、什么是子查询？"><a href="#3-1、什么是子查询？" class="headerlink" title="3.1、什么是子查询？"></a>3.1、什么是子查询？</h3><p>​select语句中嵌套select语句，被嵌套的select语句称为子查询。</p><h3 id="3-2、子查询都可以出现在哪里"><a href="#3-2、子查询都可以出现在哪里" class="headerlink" title="3.2、子查询都可以出现在哪里"></a>3.2、子查询都可以出现在哪里</h3><p>​select<br>​..(select).<br>​from<br>​..(select).<br>​where<br>​..(select).</p><h3 id="3-3、where子句中的子查询"><a href="#3-3、where子句中的子查询" class="headerlink" title="3.3、where子句中的子查询"></a>3.3、where子句中的子查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">案例：找出比最低工资高的员工姓名和工资？</span><br><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp </span><br><span class="line">where</span><br><span class="line">sal &gt; min(sal);</span><br><span class="line"></span><br><span class="line">ERROR 1111 (HY000): Invalid use of group function</span><br><span class="line">where子句中不能直接使用分组函数。</span><br><span class="line"></span><br><span class="line">实现思路：</span><br><span class="line">第一步：查询最低工资是多少</span><br><span class="line">select min(sal) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| min(sal) |</span><br><span class="line">+----------+</span><br><span class="line">|   800.00 |</span><br><span class="line">+----------+</span><br><span class="line">第二步：找出&gt;800的</span><br><span class="line">select ename,sal from emp where sal &gt; 800;</span><br><span class="line"></span><br><span class="line">第三步：合并</span><br><span class="line">select ename,sal from emp where sal &gt; (select min(sal) from emp);</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| KING   | 5000.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><h3 id="3-4、from子句中的子查询"><a href="#3-4、from子句中的子查询" class="headerlink" title="3.4、from子句中的子查询"></a>3.4、from子句中的子查询</h3><p>注意：from后面的子查询，可以将子查询的查询结果当做一张临时表。（技巧）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">案例：找出每个岗位的平均工资的薪资等级。</span><br><span class="line"></span><br><span class="line">第一步：找出每个岗位的平均工资（按照岗位分组求平均值）</span><br><span class="line">select job,avg(sal) from emp group by job;</span><br><span class="line">+-----------+-------------+</span><br><span class="line">| job       | avgsal      |</span><br><span class="line">+-----------+-------------+</span><br><span class="line">| ANALYST   | 3000.000000 |</span><br><span class="line">| CLERK     | 1037.500000 |</span><br><span class="line">| MANAGER   | 2758.333333 |</span><br><span class="line">| PRESIDENT | 5000.000000 |</span><br><span class="line">| SALESMAN  | 1400.000000 |</span><br><span class="line">+-----------+-------------+t表</span><br><span class="line"></span><br><span class="line">第二步：克服心理障碍，把以上的查询结果就当做一张真实存在的表t。</span><br><span class="line">mysql&gt; select * from salgrade; s表</span><br><span class="line">+-------+-------+-------+</span><br><span class="line">| GRADE | LOSAL | HISAL |</span><br><span class="line">+-------+-------+-------+</span><br><span class="line">|     1 |   700 |  1200 |</span><br><span class="line">|     2 |  1201 |  1400 |</span><br><span class="line">|     3 |  1401 |  2000 |</span><br><span class="line">|     4 |  2001 |  3000 |</span><br><span class="line">|     5 |  3001 |  9999 |</span><br><span class="line">+-------+-------+-------+</span><br><span class="line">t表和s表进行表连接，条件：t表avg(sal) between s.losal and s.hisal;</span><br><span class="line"></span><br><span class="line">select </span><br><span class="line">t.*, s.grade</span><br><span class="line">from</span><br><span class="line">(select job,avg(sal) as avgsal from emp group by job) t</span><br><span class="line">join</span><br><span class="line">salgrade s</span><br><span class="line">on</span><br><span class="line">t.avgsal between s.losal and s.hisal;</span><br><span class="line"></span><br><span class="line">+-----------+-------------+-------+</span><br><span class="line">| job       | avgsal      | grade |</span><br><span class="line">+-----------+-------------+-------+</span><br><span class="line">| CLERK     | 1037.500000 |     1 |</span><br><span class="line">| SALESMAN  | 1400.000000 |     2 |</span><br><span class="line">| ANALYST   | 3000.000000 |     4 |</span><br><span class="line">| MANAGER   | 2758.333333 |     4 |</span><br><span class="line">| PRESIDENT | 5000.000000 |     5 |</span><br><span class="line">+-----------+-------------+-------+</span><br></pre></td></tr></table></figure><h3 id="3-5、select后面出现的子查询（这个内容不需要掌握，了解即可）"><a href="#3-5、select后面出现的子查询（这个内容不需要掌握，了解即可）" class="headerlink" title="3.5、select后面出现的子查询（这个内容不需要掌握，了解即可）"></a>3.5、select后面出现的子查询（这个内容不需要掌握，了解即可）</h3><p>案例：找出每个员工的部门名称，要求显示员工名，部门名？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">e.ename,e.deptno,(select d.dname from dept d where e.deptno = d.deptno) as dname </span><br><span class="line">from </span><br><span class="line">emp e;</span><br><span class="line">+--------+--------+------------+</span><br><span class="line">| ename  | deptno | dname      |</span><br><span class="line">+--------+--------+------------+</span><br><span class="line">| SMITH  |     20 | RESEARCH   |</span><br><span class="line">| ALLEN  |     30 | SALES      |</span><br><span class="line">| WARD   |     30 | SALES      |</span><br><span class="line">| JONES  |     20 | RESEARCH   |</span><br><span class="line">| MARTIN |     30 | SALES      |</span><br><span class="line">| BLAKE  |     30 | SALES      |</span><br><span class="line">| CLARK  |     10 | ACCOUNTING |</span><br><span class="line">| SCOTT  |     20 | RESEARCH   |</span><br><span class="line">| KING   |     10 | ACCOUNTING |</span><br><span class="line">| TURNER |     30 | SALES      |</span><br><span class="line">| ADAMS  |     20 | RESEARCH   |</span><br><span class="line">| JAMES  |     30 | SALES      |</span><br><span class="line">| FORD   |     20 | RESEARCH   |</span><br><span class="line">| MILLER |     10 | ACCOUNTING |</span><br><span class="line">+--------+--------+------------+</span><br><span class="line"></span><br><span class="line">//错误：ERROR 1242 (21000): Subquery returns more than 1 row</span><br><span class="line">select </span><br><span class="line">e.ename,e.deptno,(select dname from dept) as dname</span><br><span class="line">from</span><br><span class="line">emp e;</span><br><span class="line"></span><br><span class="line">注意：对于select后面的子查询来说，这个子查询只能一次返回1条结果，</span><br><span class="line">多于1条，就报错了。！</span><br></pre></td></tr></table></figure><h2 id="4、union合并查询结果集"><a href="#4、union合并查询结果集" class="headerlink" title="4、union合并查询结果集"></a>4、union合并查询结果集</h2><p>案例：查询工作岗位是MANAGER和SALESMAN的员工</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">select ename,job from emp where job = &#x27;MANAGER&#x27; or job = &#x27;SALESMAN&#x27;;</span><br><span class="line">select ename,job from emp where job in(&#x27;MANAGER&#x27;,&#x27;SALESMAN&#x27;);</span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | job      |</span><br><span class="line">+--------+----------+</span><br><span class="line">| ALLEN  | SALESMAN |</span><br><span class="line">| WARD   | SALESMAN |</span><br><span class="line">| JONES  | MANAGER  |</span><br><span class="line">| MARTIN | SALESMAN |</span><br><span class="line">| BLAKE  | MANAGER  |</span><br><span class="line">| CLARK  | MANAGER  |</span><br><span class="line">| TURNER | SALESMAN |</span><br><span class="line">+--------+----------+</span><br><span class="line">select ename,job from emp where job = &#x27;MANAGER&#x27;</span><br><span class="line">union</span><br><span class="line">select ename,job from emp where job = &#x27;SALESMAN&#x27;;</span><br><span class="line"></span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | job      |</span><br><span class="line">+--------+----------+</span><br><span class="line">| JONES  | MANAGER  |</span><br><span class="line">| BLAKE  | MANAGER  |</span><br><span class="line">| CLARK  | MANAGER  |</span><br><span class="line">| ALLEN  | SALESMAN |</span><br><span class="line">| WARD   | SALESMAN |</span><br><span class="line">| MARTIN | SALESMAN |</span><br><span class="line">| TURNER | SALESMAN |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure><p>union的效率要高一些。对于表连接来说，每连接一次新表，则匹配的次数满足笛卡尔积，成倍的翻<br>但是union可以减少匹配的次数。在减少匹配次数的情况下，还可以完成两个结果集的拼接。</p><p>a 连接 b 连接 c<br>a 10条记录<br>b 10条记录<br>c 10条记录<br>匹配次数是：1000</p><p>a 连接 b一个结果：10 * 10 –&gt; 100次<br>a 连接 c一个结果：10 * 10 –&gt; 100次<br>使用union的话是：100次 + 100次 &#x3D; 200次。（union把乘法变成了加法运算）</p><p>union在使用的时候有注意事项吗？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//错误的：union在进行结果集合并的时候，要求两个结果集的列数相同。</span><br><span class="line">select ename,job from emp where job = &#x27;MANAGER&#x27;</span><br><span class="line">union</span><br><span class="line">select ename from emp where job = &#x27;SALESMAN&#x27;;</span><br><span class="line"></span><br><span class="line">// MYSQL可以，oracle语法严格 ，不可以，报错。要求：结果集合并时列和列的数据类型也要一致。</span><br><span class="line">select ename,job from emp where job = &#x27;MANAGER&#x27;</span><br><span class="line">union</span><br><span class="line">select ename,sal from emp where job = &#x27;SALESMAN&#x27;;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | job     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| JONES  | MANAGER |</span><br><span class="line">| BLAKE  | MANAGER |</span><br><span class="line">| CLARK  | MANAGER |</span><br><span class="line">| ALLEN  | 1600    |</span><br><span class="line">| WARD   | 1250    |</span><br><span class="line">| MARTIN | 1250    |</span><br><span class="line">| TURNER | 1500    |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><h2 id="5、limit（非常重要）"><a href="#5、limit（非常重要）" class="headerlink" title="5、limit（非常重要）"></a>5、limit（非常重要）</h2><h3 id="5-1、limit作用"><a href="#5-1、limit作用" class="headerlink" title="5.1、limit作用"></a>5.1、limit作用</h3><p>将查询结果集的一部分取出来。通常使用在分页查询当中。</p><p>百度默认：一页显示10条记录。<br>分页的作用是为了提高用户的体验，因为一次全部都查出来，用户体验差。<br>可以一页一页翻页看。</p><h3 id="5-2、limit怎么用"><a href="#5-2、limit怎么用" class="headerlink" title="5.2、limit怎么用"></a>5.2、limit怎么用</h3><p>完整用法：limit startIndex, length<br>    startIndex是起始下标，length是长度。<br>    起始下标从0开始。</p><p>缺省用法：limit 5; 这是取前5.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">按照薪资降序，取出排名在前5名的员工？</span><br><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">order by </span><br><span class="line">sal desc</span><br><span class="line">limit 5; //取前5</span><br><span class="line"></span><br><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">order by </span><br><span class="line">sal desc</span><br><span class="line">limit 0,5;</span><br><span class="line"></span><br><span class="line">+-------+---------+</span><br><span class="line">| ename | sal     |</span><br><span class="line">+-------+---------+</span><br><span class="line">| KING  | 5000.00 |</span><br><span class="line">| SCOTT | 3000.00 |</span><br><span class="line">| FORD  | 3000.00 |</span><br><span class="line">| JONES | 2975.00 |</span><br><span class="line">| BLAKE | 2850.00 |</span><br><span class="line">+-------+---------+</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>mysql当中limit在order by之后执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">取出工资排名在[3-5]名的员工</span><br><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">order by</span><br><span class="line">sal desc</span><br><span class="line">limit</span><br><span class="line">2, 3;</span><br><span class="line">2表示起始位置从下标2开始，就是第三条记录。</span><br><span class="line">3表示长度。</span><br><span class="line"></span><br><span class="line">+-------+---------+</span><br><span class="line">| ename | sal     |</span><br><span class="line">+-------+---------+</span><br><span class="line">| FORD  | 3000.00 |</span><br><span class="line">| JONES | 2975.00 |</span><br><span class="line">| BLAKE | 2850.00 |</span><br><span class="line">+-------+---------+</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">取出工资排名在[5-9]名的员工</span><br><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">order by </span><br><span class="line">sal desc</span><br><span class="line">limit</span><br><span class="line">4, 5;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><h3 id="5-3、分页"><a href="#5-3、分页" class="headerlink" title="5.3、分页"></a>5.3、分页</h3><p>每页显示3条记录<br>    第1页：limit 0,3[0 1 2]<br>    第2页：limit 3,3[3 4 5]<br>    第3页：limit 6,3[6 7 8]<br>    第4页：limit 9,3[9 10 11]</p><p>每页显示pageSize条记录<br>    第pageNo页：limit (pageNo - 1) * pageSize  , pageSize</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line"><span class="comment">// 用户提交过来一个页码，以及每页显示的记录条数</span></span><br><span class="line"><span class="type">int</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">5</span>; <span class="comment">//第5页</span></span><br><span class="line"><span class="type">int</span> <span class="variable">pageSize</span> <span class="operator">=</span> <span class="number">10</span>; <span class="comment">//每页显示10条</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">startIndex</span> <span class="operator">=</span> (pageNo - <span class="number">1</span>) * pageSize;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select ...limit &quot;</span> + startIndex + <span class="string">&quot;, &quot;</span> + pageSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>记公式：<br>    limit (pageNo-1)*pageSize , pageSize</p><h2 id="6、关于DQL语句的大总结："><a href="#6、关于DQL语句的大总结：" class="headerlink" title="6、关于DQL语句的大总结："></a>6、关于DQL语句的大总结：</h2><p>​select<br>​…<br>​from<br>​…<br>​where<br>​…<br>​group by<br>​…<br>​having<br>​…<br>​order by<br>​…<br>​limit<br>​…</p><p>执行顺序？<br>    1.from<br>    2.where<br>    3.group by<br>    4.having<br>    5.select<br>    6.order by<br>    7.limit..</p><h2 id="7、表的创建（建表）"><a href="#7、表的创建（建表）" class="headerlink" title="7、表的创建（建表）"></a>7、表的创建（建表）</h2><h3 id="7-1、建表的语法格式："><a href="#7-1、建表的语法格式：" class="headerlink" title="7.1、建表的语法格式："></a>7.1、建表的语法格式：</h3><p>建表属于DDL语句，DDL包括：create drop alter</p><p>create table 表名(字段名1 数据类型, 字段名2 数据类型, 字段名3 数据类型);</p><p>create table 表名(<br>    字段名1 数据类型,<br>    字段名2 数据类型,<br>    字段名3 数据类型<br>);</p><p>表名：建议以t_ 或者 tbl_开始，可读性强。见名知意。<br>字段名：见名知意。<br>表名和字段名都属于标识符。</p><h3 id="7-2、关于mysql中的数据类型"><a href="#7-2、关于mysql中的数据类型" class="headerlink" title="7.2、关于mysql中的数据类型"></a>7.2、关于mysql中的数据类型</h3><p>很多数据类型，我们只需要掌握一些常见的数据类型即可。</p><p>varchar(最长255)<br>    可变长度的字符串<br>    比较智能，节省空间。<br>    会根据实际的数据长度动态分配空间。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">优点：节省空间</span><br><span class="line">缺点：需要动态分配空间，速度慢。</span><br></pre></td></tr></table></figure><p>char(最长255)<br>    定长字符串<br>    不管实际的数据长度是多少。<br>    分配固定长度的空间去存储数据。<br>    使用不恰当的时候，可能会导致空间的浪费。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">优点：不需要动态分配空间，速度快。</span><br><span class="line">缺点：使用不当可能会导致空间的浪费。</span><br><span class="line"></span><br><span class="line">varchar和char我们应该怎么选择？</span><br><span class="line"><span class="code">性别字段你选什么？因为性别是固定长度的字符串，所以选择char。</span></span><br><span class="line"><span class="code">姓名字段你选什么？每一个人的名字长度不同，所以选择varchar。</span></span><br></pre></td></tr></table></figure><p>int(最长11)<br>    数字中的整数型。等同于java的int。</p><p>bigint<br>    数字中的长整型。等同于java中的long。</p><p>float<br>    单精度浮点型数据</p><p>double<br>    双精度浮点型数据</p><p>date<br>    短日期类型</p><p>datetime<br>    长日期类型</p><p>clob<br>    字符大对象<br>    最多可以存储4G的字符串。<br>    比如：存储一篇文章，存储一个说明。<br>    超过255个字符的都要采用CLOB字符大对象来存储。<br>    Character Large OBject:CLOB</p><p>blob</p><p>​二进制大对象<br>​Binary Large OBject<br>​专门用来存储图片、声音、视频等流媒体数据。<br>​往BLOB类型的字段上插入数据的时候，例如插入一个图片、视频等，<br>​你需要使用IO流才行。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">t_movie 电影表（专门存储电影信息的）</span><br><span class="line"></span><br><span class="line">编号名字故事情节上映日期时长海报类型</span><br><span class="line">no(bigint)name(varchar)history(clob)playtime(date)time(double)image(blob)type(char)</span><br><span class="line">------------------------------------------------------------------------------------------------------------------</span><br><span class="line">10000哪吒...........2019-10-112.5....&#x27;1&#x27;</span><br><span class="line">10001林正英之娘娘   ...........2019-11-111.5....&#x27;2&#x27;</span><br><span class="line">....</span><br></pre></td></tr></table></figure><h3 id="7-3、创建一个学生表"><a href="#7-3、创建一个学生表" class="headerlink" title="7.3、创建一个学生表"></a>7.3、创建一个学生表</h3><p>​学号、姓名、年龄、性别、邮箱地址<br>​create table t_student(<br>​no int,<br>​name varchar(32),<br>​sex char(1),<br>​age int(3),<br>​email varchar(255)<br>​);</p><p>删除表：<br>    drop table t_student; &#x2F;&#x2F; 当这张表不存在的时候会报错！</p><p>​drop table if exists t_student;&#x2F;&#x2F; 如果这张表存在的话，删除</p><h3 id="7-4、插入数据insert-（DML）"><a href="#7-4、插入数据insert-（DML）" class="headerlink" title="7.4、插入数据insert （DML）"></a>7.4、插入数据insert （DML）</h3><p>语法格式：insert into 表名(字段名1,字段名2,字段名3…) values(值1,值2,值3);<br>注意：字段名和值要一一对应：数量要对应，数据类型要对应</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">insert into t_student(no,name,sex,age,email) values(1,&#x27;zhangsan&#x27;,&#x27;m&#x27;,20,&#x27;zhangsan@123.com&#x27;);</span><br><span class="line">insert into t_student(email,name,sex,age,no) values(&#x27;lisi@123.com&#x27;,&#x27;lisi&#x27;,&#x27;f&#x27;,20,2);</span><br><span class="line"></span><br><span class="line">insert into t_student(no) values(3);</span><br><span class="line"></span><br><span class="line">+------+----------+------+------+------------------+</span><br><span class="line">| no   | name     | sex  | age  | email            |</span><br><span class="line">+------+----------+------+------+------------------+</span><br><span class="line">|    1 | zhangsan | m    |   20 | zhangsan@123.com |</span><br><span class="line">|    2 | lisi     | f    |   20 | lisi@123.com     |</span><br><span class="line">|    3 | NULL     | NULL | NULL | NULL             |</span><br><span class="line">+------+----------+------+------+------------------+</span><br><span class="line">insert into t_student(name) values(&#x27;wangwu&#x27;);</span><br><span class="line">+------+----------+------+------+------------------+</span><br><span class="line">| no   | name     | sex  | age  | email            |</span><br><span class="line">+------+----------+------+------+------------------+</span><br><span class="line">|    1 | zhangsan | m    |   20 | zhangsan@123.com |</span><br><span class="line">|    2 | lisi     | f    |   20 | lisi@123.com     |</span><br><span class="line">|    3 | NULL     | NULL | NULL | NULL             |</span><br><span class="line">| NULL | wangwu   | NULL | NULL | NULL             |</span><br><span class="line">+------+----------+------+------+------------------+</span><br><span class="line">注意：insert语句但凡是执行成功了，那么必然会多一条记录。</span><br><span class="line">没有给其它字段指定值的话，默认值是NULL。</span><br><span class="line"></span><br><span class="line">drop table if exists t_student;</span><br><span class="line">create table t_student(</span><br><span class="line">no int,</span><br><span class="line">name varchar(32),</span><br><span class="line">sex char(1) default &#x27;m&#x27;,</span><br><span class="line">age int(3),</span><br><span class="line">email varchar(255)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type         | Null | Key | Default | Extra |</span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line">| no    | int(11)      | YES  |     | NULL    |       |</span><br><span class="line">| name  | varchar(32)  | YES  |     | NULL    |       |</span><br><span class="line">| sex   | char(1)      | YES  |     | m       |       |</span><br><span class="line">| age   | int(3)       | YES  |     | NULL    |       |</span><br><span class="line">| email | varchar(255) | YES  |     | NULL    |       |</span><br><span class="line">+-------+--------------+------+-----+---------+-------+</span><br><span class="line">insert into t_student(no) values(1);</span><br><span class="line">mysql&gt; select * from t_student;</span><br><span class="line">+------+------+------+------+-------+</span><br><span class="line">| no   | name | sex  | age  | email |</span><br><span class="line">+------+------+------+------+-------+</span><br><span class="line">|    1 | NULL | m    | NULL | NULL  |</span><br><span class="line">+------+------+------+------+-------+</span><br><span class="line"></span><br><span class="line">insert语句中的“字段名”可以省略吗？可以</span><br><span class="line">insert into t_student values(2); //错误的</span><br><span class="line"></span><br><span class="line">// 注意：前面的字段名省略的话，等于都写上了！所以值也要都写上！</span><br><span class="line">insert into t_student values(2, &#x27;lisi&#x27;, &#x27;f&#x27;, 20, &#x27;lisi@123.com&#x27;);</span><br><span class="line">+------+------+------+------+--------------+</span><br><span class="line">| no   | name | sex  | age  | email        |</span><br><span class="line">+------+------+------+------+--------------+</span><br><span class="line">|    1 | NULL | m    | NULL | NULL         |</span><br><span class="line">|    2 | lisi | f    |   20 | lisi@123.com |</span><br><span class="line">+------+------+------+------+--------------+</span><br></pre></td></tr></table></figure><h3 id="7-5、insert插入日期"><a href="#7-5、insert插入日期" class="headerlink" title="7.5、insert插入日期"></a>7.5、insert插入日期</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">数字格式化：format</span><br><span class="line">select ename,sal from emp;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| SMITH  |  800.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| KING   | 5000.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">+--------+---------+</span><br><span class="line"></span><br><span class="line">格式化数字：format(数字, &#x27;格式&#x27;)</span><br><span class="line">select ename,format(sal, &#x27;$999,999&#x27;) as sal from emp;</span><br><span class="line">+--------+-------+</span><br><span class="line">| ename  | sal   |</span><br><span class="line">+--------+-------+</span><br><span class="line">| SMITH  | 800   |</span><br><span class="line">| ALLEN  | 1,600 |</span><br><span class="line">| WARD   | 1,250 |</span><br><span class="line">| JONES  | 2,975 |</span><br><span class="line">| MARTIN | 1,250 |</span><br><span class="line">| BLAKE  | 2,850 |</span><br><span class="line">| CLARK  | 2,450 |</span><br><span class="line">| SCOTT  | 3,000 |</span><br><span class="line">| KING   | 5,000 |</span><br><span class="line">| TURNER | 1,500 |</span><br><span class="line">| ADAMS  | 1,100 |</span><br><span class="line">| JAMES  | 950   |</span><br><span class="line">| FORD   | 3,000 |</span><br><span class="line">| MILLER | 1,300 |</span><br><span class="line">+--------+-------+</span><br><span class="line"></span><br><span class="line">str_to_date：将字符串varchar类型转换成date类型</span><br><span class="line">date_format：将date类型转换成具有一定格式的varchar字符串类型。</span><br><span class="line"></span><br><span class="line">drop table if exists t_user;</span><br><span class="line">create table t_user(</span><br><span class="line">id int,</span><br><span class="line">name varchar(32),</span><br><span class="line">birth date // 生日也可以使用date日期类型</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table t_user(</span><br><span class="line">id int,</span><br><span class="line">name varchar(32),</span><br><span class="line">birth char(10) // 生日可以使用字符串，没问题。</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">生日：1990-10-11 （10个字符）</span><br><span class="line"></span><br><span class="line">注意：数据库中的有一条命名规范：</span><br><span class="line">所有的标识符都是全部小写，单词和单词之间使用下划线进行衔接。</span><br><span class="line"></span><br><span class="line">mysql&gt; desc t_user;</span><br><span class="line">+-------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type        | Null | Key | Default | Extra |</span><br><span class="line">+-------+-------------+------+-----+---------+-------+</span><br><span class="line">| id    | int(11)     | YES  |     | NULL    |       |</span><br><span class="line">| name  | varchar(32) | YES  |     | NULL    |       |</span><br><span class="line">| birth | date        | YES  |     | NULL    |       |</span><br><span class="line">+-------+-------------+------+-----+---------+-------+</span><br></pre></td></tr></table></figure><p>插入数据？<br>    insert into t_user(id,name,birth) values(1, ‘zhangsan’, ‘01-10-1990’); &#x2F;&#x2F; 1990年10月1日<br>    出问题了：原因是类型不匹配。数据库birth是date类型，这里给了一个字符串varchar。</p><p>怎么办？可以使用str_to_date函数进行类型转换。<br>str_to_date函数可以将字符串转换成日期类型date？<br>语法格式：<br>    str_to_date(‘字符串日期’, ‘日期格式’)</p><p>mysql的日期格式：<br>    %Y年<br>    %m 月<br>    %d 日<br>    %h时<br>    %i分<br>    %s秒</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into t_user(id,name,birth) values(1, &#x27;zhangsan&#x27;, str_to_date(&#x27;01-10-1990&#x27;,&#x27;%d-%m-%Y&#x27;));</span><br></pre></td></tr></table></figure><p>str_to_date函数可以把字符串varchar转换成日期date类型数据，<br>通常使用在插入insert方面，因为插入的时候需要一个日期类型的数据，<br>需要通过该函数将字符串转换成date。</p><p>好消息？<br>    如果你提供的日期字符串是这个格式，str_to_date函数就不需要了<br>        %Y-%m-%d</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into t_user(id,name,birth) values(2, &#x27;lisi&#x27;, &#x27;1990-10-01&#x27;);</span><br></pre></td></tr></table></figure><p>查询的时候可以以某个特定的日期格式展示吗？<br>    date_format<br>    这个函数可以将日期类型转换成特定格式的字符串。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select id,name,date_format(birth, &#x27;%m/%d/%Y&#x27;) as birth from t_user;</span><br><span class="line">+------+----------+------------+</span><br><span class="line">| id   | name     | birth      |</span><br><span class="line">+------+----------+------------+</span><br><span class="line">|    1 | zhangsan | 10/01/1990 |</span><br><span class="line">|    2 | lisi     | 10/01/1990 |</span><br><span class="line">+------+----------+------------+</span><br></pre></td></tr></table></figure><p>date_format函数怎么用？<br>    date_format(日期类型数据, ‘日期格式’)<br>    这个函数通常使用在查询日期方面。设置展示的日期格式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select id,name,birth from t_user;</span><br><span class="line">+------+----------+------------+</span><br><span class="line">| id   | name     | birth      |</span><br><span class="line">+------+----------+------------+</span><br><span class="line">|    1 | zhangsan | 1990-10-01 |</span><br><span class="line">|    2 | lisi     | 1990-10-01 |</span><br><span class="line">+------+----------+------------+</span><br></pre></td></tr></table></figure><p>以上的SQL语句实际上是进行了默认的日期格式化，<br>自动将数据库中的date类型转换成varchar类型。<br>并且采用的格式是mysql默认的日期格式：’%Y-%m-%d’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select id,name,date_format(birth,&#x27;%Y/%m/%d&#x27;) as birth from t_user;</span><br></pre></td></tr></table></figure><p>java中的日期格式？<br>    yyyy-MM-dd HH:mm:ss SSS</p><h3 id="7-6、date和datetime两个类型的区别"><a href="#7-6、date和datetime两个类型的区别" class="headerlink" title="7.6、date和datetime两个类型的区别"></a>7.6、date和datetime两个类型的区别</h3><p>date是短日期：只包括年月日信息。<br>​datetime是长日期：包括年月日时分秒信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists t_user;</span><br><span class="line">create table t_user(</span><br><span class="line">id int,</span><br><span class="line">name varchar(32),</span><br><span class="line">birth date,</span><br><span class="line">create_time datetime</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>id是整数<br>name是字符串<br>birth是短日期<br>create_time是这条记录的创建时间：长日期类型</p><p>mysql短日期默认格式：%Y-%m-%d<br>mysql长日期默认格式：%Y-%m-%d %h:%i:%s</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into t_user(id,name,birth,create_time) values(1,&#x27;zhangsan&#x27;,&#x27;1990-10-01&#x27;,&#x27;2020-03-18 15:49:50&#x27;);</span><br><span class="line">在mysql当中怎么获取系统当前时间？</span><br><span class="line">now() 函数，并且获取的时间带有：时分秒信息！！！！是datetime类型的。</span><br><span class="line">insert into t_user(id,name,birth,create_time) values(2,&#x27;lisi&#x27;,&#x27;1991-10-01&#x27;,now());</span><br></pre></td></tr></table></figure><h3 id="7-7、修改update（DML）"><a href="#7-7、修改update（DML）" class="headerlink" title="7.7、修改update（DML）"></a>7.7、修改update（DML）</h3><p>语法格式：<br>    update 表名 set 字段名1&#x3D;值1,字段名2&#x3D;值2,字段名3&#x3D;值3… where 条件;</p><p>注意：没有条件限制会导致所有数据全部更新。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">update t_user set name = &#x27;jack&#x27;, birth = &#x27;2000-10-11&#x27; where id = 2;</span><br><span class="line">+------+----------+------------+---------------------+</span><br><span class="line">| id   | name     | birth      | create_time         |</span><br><span class="line">+------+----------+------------+---------------------+</span><br><span class="line">|    1 | zhangsan | 1990-10-01 | 2020-03-18 15:49:50 |</span><br><span class="line">|    2 | jack     | 2000-10-11 | 2020-03-18 15:51:23 |</span><br><span class="line">+------+----------+------------+---------------------+</span><br><span class="line"></span><br><span class="line">update t_user set name = &#x27;jack&#x27;, birth = &#x27;2000-10-11&#x27;, create_time = now() where id = 2;</span><br><span class="line"></span><br><span class="line">更新所有？</span><br><span class="line">update t_user set name = &#x27;abc&#x27;;</span><br></pre></td></tr></table></figure><p>7.8、删除数据 delete （DML）<br>语法格式：<br>        delete from 表名 where 条件;</p><p>注意：没有条件，整张表的数据会全部删除！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">delete from t_user where id = 2;</span><br><span class="line"></span><br><span class="line">insert into t_user(id) values(2);</span><br><span class="line"></span><br><span class="line">delete from t_user; // 删除所有！</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL学习day01</title>
      <link href="/post/d3fa9ef.html"/>
      <url>/post/d3fa9ef.html</url>
      
        <content type="html"><![CDATA[<h1 id="Mysql学习-day01"><a href="#Mysql学习-day01" class="headerlink" title="Mysql学习-day01"></a>Mysql学习-day01</h1><h2 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h2><p>什么是数据库？什么是数据库管理系统？什么是SQL？他们之间的关系是什么？</p><p>数据库：<br>    英文单词DataBase，简称DB。按照一定格式存储数据的一些文件的组合。<br>    顾名思义：存储数据的仓库，实际上就是一堆文件。这些文件中存储了<br>    具有特定格式的数据。</p><p>数据库管理系统：<br>    DataBaseManagement，简称DBMS。<br>    数据库管理系统是专门用来管理数据库中数据的，数据库管理系统可以<br>    对数据库当中的数据进行增删改查。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">常见的数据库管理系统：</span><br><span class="line"><span class="code">MySQL、Oracle、MS SqlServer、DB2、sybase等....</span></span><br></pre></td></tr></table></figure><p>SQL：结构化查询语言<br>    程序员需要学习SQL语句，程序员通过编写SQL语句，然后DBMS负责执行SQL<br>    语句，最终来完成数据库中数据的增删改查操作。</p><p>SQL是一套标准，程序员主要学习的就是SQL语句，这个SQL在mysql中可以使用，<br>同时在Oracle中也可以使用，在DB2中也可以使用。</p><p>三者之间的关系？<br>    DBMS–执行–&gt; SQL –操作–&gt; DB</p><p>先安装数据库管理系统MySQL，然后学习SQL语句怎么写，编写SQL语句之后，DBMS<br>对SQL语句进行执行，最终来完成数据库的数据管理。</p><h2 id="2、安装MySQL数据库管理系统"><a href="#2、安装MySQL数据库管理系统" class="headerlink" title="2、安装MySQL数据库管理系统"></a>2、安装MySQL数据库管理系统</h2><p>​第一步：先安装，选择“经典版”<br>​第二步：需要进行MySQL数据库实例配置。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">注意：一路下一步就行了！！！！！</span><br><span class="line">需要注意的事项？</span><br><span class="line"><span class="code">端口号：</span></span><br><span class="line"><span class="code">端口号port是任何一个软件/应用都会有的，端口号是应用的唯一代表。</span></span><br><span class="line"><span class="code">端口号通常和IP地址在一块，IP地址用来定位计算机的，端口号port</span></span><br><span class="line"><span class="code">是用来定位计算机上某个服务的/某个应用的！</span></span><br><span class="line"><span class="code">在同一台计算机上，端口号不能重复。具有唯一性。</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">mysql数据库启动的时候，这个服务占有的默认端口号是3306</span></span><br><span class="line"><span class="code">这是大家都知道的事儿。记住。</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">字符编码方式？</span></span><br><span class="line"><span class="code">设置mysql数据库的字符编码方式为 UTF8</span></span><br><span class="line"><span class="code">一定要注意：先选中第3个单选按钮，然后再选择utf8字符集。</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">服务名称？</span></span><br><span class="line"><span class="code">默认是：MySQL</span></span><br><span class="line"><span class="code">不用改。</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">选择配置环境变量path：</span></span><br><span class="line"><span class="code">如果没有选择怎么办？你可以手动配置</span></span><br><span class="line"><span class="code">path=其它路径;C:\Program Files (x86)\MySQL\MySQL Server 5.5\bin</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">mysql超级管理员用户名不能改，一定是：root</span></span><br><span class="line"><span class="code">你需要设置mysql数据库超级管理员的密码。</span></span><br><span class="line"><span class="code">我们设置为123456</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">设置密码的同时，可以激活root账户远程访问。</span></span><br><span class="line"><span class="code">激活：表示root账号可以在外地登录。</span></span><br><span class="line"><span class="code">不激活：表示root账号只能在本机上使用。</span></span><br><span class="line"><span class="code">我这里选择激活了！</span></span><br></pre></td></tr></table></figure><h2 id="3、MySQL数据库的完美卸载"><a href="#3、MySQL数据库的完美卸载" class="headerlink" title="3、MySQL数据库的完美卸载"></a>3、MySQL数据库的完美卸载</h2><p>​第一步：双击安装包进行卸载删除。<br>​第二步：删除目录：<br>​把C:\ProgramData下面的MySQL目录干掉。<br>​把C:\Program Files (x86)下面的MySQL目录干掉。</p><p>这样就卸载结束了！</p><h1 id="4、查找计算机上MySQL的服务"><a href="#4、查找计算机上MySQL的服务" class="headerlink" title="4、查找计算机上MySQL的服务"></a>4、查找计算机上MySQL的服务</h1><p>​计算机–&gt;右键–&gt;管理–&gt;服务和应用程序–&gt;服务–&gt;找mysql服务<br>​MySQL的服务，默认是“启动”的状态，只有启动了mysql才能用。<br>​默认情况下是“自动”启动，自动启动表示下一次重启操作系统的时候<br>​自动启动该服务。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">可以在服务上点击右键：</span><br><span class="line"><span class="code">启动</span></span><br><span class="line"><span class="code">重启服务</span></span><br><span class="line"><span class="code">停止服务</span></span><br><span class="line"><span class="code">...</span></span><br><span class="line"><span class="code">还可以改变服务的默认配置：</span></span><br><span class="line"><span class="code">服务上点击右键，属性，然后可以选择启动方式：</span></span><br><span class="line"><span class="code">自动（延迟启动）</span></span><br><span class="line"><span class="code">自动</span></span><br><span class="line"><span class="code">手动</span></span><br><span class="line"><span class="code">禁用</span></span><br></pre></td></tr></table></figure><h2 id="5、在windows操作系统当中，使用命令来启动和关闭mysql服务"><a href="#5、在windows操作系统当中，使用命令来启动和关闭mysql服务" class="headerlink" title="5、在windows操作系统当中，使用命令来启动和关闭mysql服务"></a>5、在windows操作系统当中，使用命令来启动和关闭mysql服务</h2><p>​语法：<br>​net stop 服务名称;<br>​net start 服务名称;</p><p>​其它服务的启停都可以采用以上的命令。</p><h2 id="6、使用客户端登录mysql数据库"><a href="#6、使用客户端登录mysql数据库" class="headerlink" title="6、使用客户端登录mysql数据库"></a>6、使用客户端登录mysql数据库</h2><p>​使用bin目录下的mysql.exe命令来连接mysql数据库服务器</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">本地登录（显示编写密码的形式）：</span><br><span class="line"><span class="code">C:\Users\Administrator&gt;mysql -uroot -p123456</span></span><br><span class="line"><span class="code">Welcome to the MySQL monitor.  Commands end with ; or \g.</span></span><br><span class="line"><span class="code">Your MySQL connection id is 1</span></span><br><span class="line"><span class="code">Server version: 5.5.36 MySQL Community Server (GPL)</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">Oracle is a registered trademark of Oracle Corporation and/or its</span></span><br><span class="line"><span class="code">affiliates. Other names may be trademarks of their respective</span></span><br><span class="line"><span class="code">owners.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">mysql&gt;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">本地登录（隐藏密码的形式）：</span><br><span class="line"><span class="code">C:\Users\Administrator&gt;mysql -uroot -p</span></span><br><span class="line"><span class="code">Enter password: ******</span></span><br><span class="line"><span class="code">Welcome to the MySQL monitor.  Commands end with ; or \g.</span></span><br><span class="line"><span class="code">Your MySQL connection id is 2</span></span><br><span class="line"><span class="code">Server version: 5.5.36 MySQL Community Server (GPL)</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">Oracle is a registered trademark of Oracle Corporation and/or its</span></span><br><span class="line"><span class="code">affiliates. Other names may be trademarks of their respective</span></span><br><span class="line"><span class="code">owners.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">mysql&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7、mysql常用命令："><a href="#7、mysql常用命令：" class="headerlink" title="7、mysql常用命令："></a>7、mysql常用命令：</h2><p>退出mysql ：exit</p><p>查看mysql中有哪些数据库？<br>    show databases;<br>    注意：以分号结尾，分号是英文的分号。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| test               |</span><br><span class="line">+--------------------+mysql默认自带了4个数据库。</span><br></pre></td></tr></table></figure><p>怎么选择使用某个数据库呢？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use test;</span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure><p>表示正在使用一个名字叫做test的数据库。</p><p>怎么创建数据库呢？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database bjpowernode;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| bjpowernode        |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| test               |</span><br><span class="line">+--------------------+</span><br></pre></td></tr></table></figure><p>查看某个数据库下有哪些表？</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br></pre></td></tr></table></figure><p>注意：以上的命令不区分大小写，都行。</p><p>查看mysql数据库的版本号：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select version();</span><br><span class="line">+-----------+</span><br><span class="line">| version() |</span><br><span class="line">+-----------+</span><br><span class="line">| 5.5.36    |</span><br><span class="line">+-----------+</span><br></pre></td></tr></table></figure><p>查看当前使用的是哪个数据库？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select database();</span><br><span class="line">+-------------+</span><br><span class="line">| database()  |</span><br><span class="line">+-------------+</span><br><span class="line">| bjpowernode |</span><br><span class="line">+-------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; show</span><br><span class="line">-&gt; databases</span><br><span class="line">-&gt; ;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| bjpowernode        |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| test               |</span><br><span class="line">+--------------------+</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>mysql是不见“;”不执行，“;”表示结束！</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show</span><br><span class="line">-&gt;</span><br><span class="line">-&gt;</span><br><span class="line">-&gt; \c</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>\c用来终止一条命令的输入。</p><h2 id="8、数据库当中最基本的单元是表：table"><a href="#8、数据库当中最基本的单元是表：table" class="headerlink" title="8、数据库当中最基本的单元是表：table"></a>8、数据库当中最基本的单元是表：table</h2><p>什么是表table？为什么用表来存储数据呢？</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">姓名性别年龄(列：字段) </span></span><br><span class="line"><span class="section">---------------------------</span></span><br><span class="line">张三男20            -------&gt;行（记录）</span><br><span class="line">李四女21            -------&gt;行（记录）</span><br><span class="line">王五男22            -------&gt;行（记录）</span><br></pre></td></tr></table></figure><p>数据库当中是以表格的形式表示数据的。<br>因为表比较直观。</p><p>任何一张表都有行和列：<br>    行（row）：被称为数据&#x2F;记录。<br>    列（column）：被称为字段。</p><p>姓名字段、性别字段、年龄字段。</p><p>了解一下：<br>    每一个字段都有：字段名、数据类型、约束等属性。<br>    字段名可以理解，是一个普通的名字，见名知意就行。<br>    数据类型：字符串，数字，日期等</p><p>约束：约束也有很多，其中一个叫做唯一性约束，<br>    这种约束添加之后，该字段中的数据不能重复。</p><h2 id="9、关于SQL语句的分类？"><a href="#9、关于SQL语句的分类？" class="headerlink" title="9、关于SQL语句的分类？"></a>9、关于SQL语句的分类？</h2><p>SQL语句有很多，最好进行分门别类，这样更容易记忆。<br>分为：<br><code>DQL：</code><br>    数据查询语言（凡是带有select关键字的都是查询语句）<br>    select…<br><code>DML：</code><br>    数据操作语言（凡是对表当中的数据进行增删改的都是DML）<br>    insert delete update<br>    insert 增<br>    delete 删<br>    update 改<br>    这个主要是操作表中的数据data。</p><p><code>DDL：</code><br>    数据定义语言<br>    凡是带有create、drop、alter的都是DDL。<br>    DDL主要操作的是表的结构。不是表中的数据。<br>    create：新建，等同于增<br>    drop：删除<br>    alter：修改<br>    这个增删改和DML不同，这个主要是对表结构进行操作。</p><p><code>TCL：</code><br>    不是王牌电视。<br>    是事务控制语言<br>    包括：<br>        事务提交：commit;<br>        事务回滚：rollback;</p><p><code>DCL：</code><br>    是数据控制语言。<br>例如：授权grant、撤销权限revoke….</p><h2 id="10、导入一下提前准备好的数据："><a href="#10、导入一下提前准备好的数据：" class="headerlink" title="10、导入一下提前准备好的数据："></a>10、导入一下提前准备好的数据：</h2><p>​bjpowernode.sql 这个文件中是提前为大家练习准备的数据库表。<br>​怎么将sql文件中的数据导入呢？</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; source D:\course\03-MySQL\document\bjpowernode.sql</span><br></pre></td></tr></table></figure><p><strong>注意：路径中不要有中文！！！！</strong></p><h2 id="11、关于导入的这几张表"><a href="#11、关于导入的这几张表" class="headerlink" title="11、关于导入的这几张表"></a>11、关于导入的这几张表</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line">+-----------------------+</span><br><span class="line">| Tables_in_bjpowernode |</span><br><span class="line">+-----------------------+</span><br><span class="line">| dept                  |</span><br><span class="line">| emp                   |</span><br><span class="line">| salgrade              |</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure><p>dept是部门表<br>emp是员工表<br>salgrade 是工资等级表</p><h3 id="11-1-查看表中的数据"><a href="#11-1-查看表中的数据" class="headerlink" title="11.1 查看表中的数据"></a>11.1 查看表中的数据</h3><p>​<strong>select * from 表名;</strong> &#x2F;&#x2F;统一执行这个SQL语句。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from emp; // 从emp表查询所有数据。</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line">|  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |</span><br><span class="line">|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |</span><br><span class="line">|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |</span><br><span class="line">|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |</span><br><span class="line">|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |</span><br><span class="line">|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |</span><br><span class="line">|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |</span><br><span class="line">|  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 |</span><br><span class="line">|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |</span><br><span class="line">|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |</span><br><span class="line">|  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 |</span><br><span class="line">|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |</span><br><span class="line">|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |</span><br><span class="line">|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |</span><br><span class="line">+-------+--------+-----------+------+------------+---------+---------+--------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from dept;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from salgrade;</span><br><span class="line">+-------+-------+-------+</span><br><span class="line">| GRADE | LOSAL | HISAL |</span><br><span class="line">+-------+-------+-------+</span><br><span class="line">|     1 |   700 |  1200 |</span><br><span class="line">|     2 |  1201 |  1400 |</span><br><span class="line">|     3 |  1401 |  2000 |</span><br><span class="line">|     4 |  2001 |  3000 |</span><br><span class="line">|     5 |  3001 |  9999 |</span><br><span class="line">+-------+-------+-------+</span><br></pre></td></tr></table></figure><h3 id="11-2-不看表中的数据，只看表的结构："><a href="#11-2-不看表中的数据，只看表的结构：" class="headerlink" title="11.2 不看表中的数据，只看表的结构："></a>11.2 不看表中的数据，只看表的结构：</h3><p>​<strong>desc 表名;</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; desc dept;</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type        | Null | Key | Default | Extra |</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br><span class="line">| DEPTNO | int(2)      | NO   | PRI | NULL    |       |部门编号</span><br><span class="line">| DNAME  | varchar(14) | YES  |     | NULL    |       |部门名字</span><br><span class="line">| LOC    | varchar(13) | YES  |     | NULL    |       |地理位置</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br><span class="line">mysql&gt; desc emp;</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type        | Null | Key | Default | Extra |</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">| EMPNO    | int(4)      | NO   | PRI | NULL    |       |员工编号</span><br><span class="line">| ENAME    | varchar(10) | YES  |     | NULL    |       |员工姓名</span><br><span class="line">| JOB      | varchar(9)  | YES  |     | NULL    |       |工作岗位</span><br><span class="line">| MGR      | int(4)      | YES  |     | NULL    |       |上级编号</span><br><span class="line">| HIREDATE | date        | YES  |     | NULL    |       |入职日期</span><br><span class="line">| SAL      | double(7,2) | YES  |     | NULL    |       |工资</span><br><span class="line">| COMM     | double(7,2) | YES  |     | NULL    |       |补助</span><br><span class="line">| DEPTNO   | int(2)      | YES  |     | NULL    |       |部门编号</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">mysql&gt; desc salgrade;</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| GRADE | int(11) | YES  |     | NULL    |       |工资等级</span><br><span class="line">| LOSAL | int(11) | YES  |     | NULL    |       |最低工资</span><br><span class="line">| HISAL | int(11) | YES  |     | NULL    |       |最高工资</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br></pre></td></tr></table></figure><p>describe缩写为：desc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; describe dept;</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type        | Null | Key | Default | Extra |</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br><span class="line">| DEPTNO | int(2)      | NO   | PRI | NULL    |       |</span><br><span class="line">| DNAME  | varchar(14) | YES  |     | NULL    |       |</span><br><span class="line">| LOC    | varchar(13) | YES  |     | NULL    |       |</span><br><span class="line">+--------+-------------+------+-----+---------+-------+</span><br></pre></td></tr></table></figure><h2 id="12、简单查询"><a href="#12、简单查询" class="headerlink" title="12、简单查询"></a>12、简单查询</h2><h3 id="12-1-查询一个字段"><a href="#12-1-查询一个字段" class="headerlink" title="12.1 查询一个字段"></a>12.1 查询一个字段</h3><p>​<strong>select 字段名 from 表名;</strong><br>​其中要注意：<br>​select和from都是关键字。<br>​字段名和表名都是标识符。<br>​<strong>强调：</strong><br>​对于SQL语句来说，是通用的;<br>​所有的SQL语句以<code>;</code>结尾;<br>​另外SQL语句不区分大小写。<br>​查询部门名字</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select dname from dept;</span><br><span class="line">+------------+</span><br><span class="line">| dname      |</span><br><span class="line">+------------+</span><br><span class="line">| ACCOUNTING |</span><br><span class="line">| RESEARCH   |</span><br><span class="line">| SALES      |</span><br><span class="line">| OPERATIONS |</span><br><span class="line">+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line">mysql&gt; SELECT DNAME FROM DEPT;</span><br><span class="line">+------------+</span><br><span class="line">| DNAME      |</span><br><span class="line">+------------+</span><br><span class="line">| ACCOUNTING |</span><br><span class="line">| RESEARCH   |</span><br><span class="line">| SALES      |</span><br><span class="line">| OPERATIONS |</span><br><span class="line">+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h3 id="12-2-查询两个字段，或者多个字段"><a href="#12-2-查询两个字段，或者多个字段" class="headerlink" title="12.2 查询两个字段，或者多个字段"></a>12.2 查询两个字段，或者多个字段</h3><p>​使用逗号隔开<code>,</code><br>​查询部门编号和部门名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select deptno,dname from dept;</span><br><span class="line">+--------+------------+</span><br><span class="line">| deptno | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">|     10 | ACCOUNTING |</span><br><span class="line">|     20 | RESEARCH   |</span><br><span class="line">|     30 | SALES      |</span><br><span class="line">|     40 | OPERATIONS |</span><br><span class="line">+--------+------------+</span><br></pre></td></tr></table></figure><h3 id="12-3-查询所有字段"><a href="#12-3-查询所有字段" class="headerlink" title="12.3 查询所有字段"></a>12.3 查询所有字段</h3><p>第一种方式：可以把每个字段都写上<br>    select a,b,c,d,e,f… from tablename;</p><p>第二种方式：可以使用<code>*</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * from dept;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| DEPTNO | DNAME      | LOC      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 | SALES      | CHICAGO  |</span><br><span class="line">|     40 | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br></pre></td></tr></table></figure><p>这种方式的缺点：<br>1、效率低<br>2、可读性差。在实际开发中不建议，可以自己玩没问题。<br>你可以在DOS命令窗口中想快速的看一看全表数据可以采用这种方式。</p><h3 id="12-4-给查询的列起别名"><a href="#12-4-给查询的列起别名" class="headerlink" title="12.4 给查询的列起别名"></a>12.4 给查询的列起别名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select deptno,dname as deptname from dept;</span><br><span class="line">+--------+------------+</span><br><span class="line">| deptno | deptname   |</span><br><span class="line">+--------+------------+</span><br><span class="line">|     10 | ACCOUNTING |</span><br><span class="line">|     20 | RESEARCH   |</span><br><span class="line">|     30 | SALES      |</span><br><span class="line">|     40 | OPERATIONS |</span><br><span class="line">+--------+------------+</span><br></pre></td></tr></table></figure><p>使用<code>as</code>关键字起别名。<br>​注意：只是将显示的查询结果列名显示为deptname，原表列名还是叫：dname<br>​记住：select语句是永远都不会进行修改操作的。（因为只负责查询）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">as关键字可以省略吗？可以的</span><br><span class="line">mysql&gt; select deptno,dname deptname from dept;</span><br><span class="line">假设起别名的时候，别名里面有空格，怎么办？</span><br><span class="line">mysql&gt; select deptno,dname dept name from dept;</span><br><span class="line">DBMS看到这样的语句，进行SQL语句的编译，不符合语法，编译报错。</span><br><span class="line">怎么解决？</span><br><span class="line">select deptno,dname &#x27;dept name&#x27; from dept; //加单引号</span><br><span class="line">select deptno,dname &quot;dept name&quot; from dept; //加双引号</span><br><span class="line">+--------+------------+</span><br><span class="line">| deptno | dept name  |</span><br><span class="line">+--------+------------+</span><br><span class="line">|     10 | ACCOUNTING |</span><br><span class="line">|     20 | RESEARCH   |</span><br><span class="line">|     30 | SALES      |</span><br><span class="line">|     40 | OPERATIONS |</span><br><span class="line">+--------+------------+</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>在所有的数据库当中，字符串统一使用<code>单引号</code>括起来，<br>单引号是标准，双引号在oracle数据库中用不了。但是在mysql<br>中可以使用。<br><strong>再次强调：</strong>数据库中的字符串都是采用<code>单引号</code>括起来,这是标准的,双引号不标准。</p><h3 id="12-5-计算员工年薪？sal-12"><a href="#12-5-计算员工年薪？sal-12" class="headerlink" title="12.5 计算员工年薪？sal * 12"></a>12.5 计算员工年薪？sal * 12</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ename,sal from emp;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| SMITH  |  800.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| KING   | 5000.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">+--------+---------+</span><br><span class="line">mysql&gt; select ename,sal*12 from emp; // 结论：字段可以使用数学表达式！</span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | sal*12   |</span><br><span class="line">+--------+----------+</span><br><span class="line">| SMITH  |  9600.00 |</span><br><span class="line">| ALLEN  | 19200.00 |</span><br><span class="line">| WARD   | 15000.00 |</span><br><span class="line">| JONES  | 35700.00 |</span><br><span class="line">| MARTIN | 15000.00 |</span><br><span class="line">| BLAKE  | 34200.00 |</span><br><span class="line">| CLARK  | 29400.00 |</span><br><span class="line">| SCOTT  | 36000.00 |</span><br><span class="line">| KING   | 60000.00 |</span><br><span class="line">| TURNER | 18000.00 |</span><br><span class="line">| ADAMS  | 13200.00 |</span><br><span class="line">| JAMES  | 11400.00 |</span><br><span class="line">| FORD   | 36000.00 |</span><br><span class="line">| MILLER | 15600.00 |</span><br><span class="line">+--------+----------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select ename,sal*12 as yearsal from emp; //起别名</span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | yearsal  |</span><br><span class="line">+--------+----------+</span><br><span class="line">| SMITH  |  9600.00 |</span><br><span class="line">| ALLEN  | 19200.00 |</span><br><span class="line">| WARD   | 15000.00 |</span><br><span class="line">| JONES  | 35700.00 |</span><br><span class="line">| MARTIN | 15000.00 |</span><br><span class="line">| BLAKE  | 34200.00 |</span><br><span class="line">| CLARK  | 29400.00 |</span><br><span class="line">| SCOTT  | 36000.00 |</span><br><span class="line">| KING   | 60000.00 |</span><br><span class="line">| TURNER | 18000.00 |</span><br><span class="line">| ADAMS  | 13200.00 |</span><br><span class="line">| JAMES  | 11400.00 |</span><br><span class="line">| FORD   | 36000.00 |</span><br><span class="line">| MILLER | 15600.00 |</span><br><span class="line">+--------+----------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select ename,sal*12 as &#x27;年薪&#x27; from emp; //别名是中文，用单引号括起来。</span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | 年薪        |</span><br><span class="line">+--------+----------+</span><br><span class="line">| SMITH  |  9600.00 |</span><br><span class="line">| ALLEN  | 19200.00 |</span><br><span class="line">| WARD   | 15000.00 |</span><br><span class="line">| JONES  | 35700.00 |</span><br><span class="line">| MARTIN | 15000.00 |</span><br><span class="line">| BLAKE  | 34200.00 |</span><br><span class="line">| CLARK  | 29400.00 |</span><br><span class="line">| SCOTT  | 36000.00 |</span><br><span class="line">| KING   | 60000.00 |</span><br><span class="line">| TURNER | 18000.00 |</span><br><span class="line">| ADAMS  | 13200.00 |</span><br><span class="line">| JAMES  | 11400.00 |</span><br><span class="line">| FORD   | 36000.00 |</span><br><span class="line">| MILLER | 15600.00 |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure><h2 id="13、条件查询"><a href="#13、条件查询" class="headerlink" title="13、条件查询"></a>13、条件查询</h2><h3 id="13-1-什么是条件查询？"><a href="#13-1-什么是条件查询？" class="headerlink" title="13.1 什么是条件查询？"></a>13.1 什么是条件查询？</h3><p>​不是将表中所有数据都查出来。是查询出来符合条件的。<br>​语法格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">字段1,字段2,字段3....</span><br><span class="line">from</span><br><span class="line">表名</span><br><span class="line">where</span><br><span class="line">条件;</span><br></pre></td></tr></table></figure><h3 id="13-2-都有哪些条件？"><a href="#13-2-都有哪些条件？" class="headerlink" title="13.2 都有哪些条件？"></a>13.2 都有哪些条件？</h3><h4 id="x3D-等于"><a href="#x3D-等于" class="headerlink" title="&#x3D; 等于"></a>&#x3D; 等于</h4><p>查询薪资等于800的员工姓名和编号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select empno,ename from emp where sal = 800;</span><br><span class="line">查询SMITH的编号和薪资？</span><br><span class="line">select empno,sal from emp where ename = &#x27;SMITH&#x27;; //字符串使用单引号</span><br></pre></td></tr></table></figure><h4 id="lt-gt-或-x3D-不等于"><a href="#lt-gt-或-x3D-不等于" class="headerlink" title="&lt;&gt;或!&#x3D; 不等于"></a>&lt;&gt;或!&#x3D; 不等于</h4><p>查询薪资不等于800的员工姓名和编号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select empno,ename from emp where sal != 800;</span><br><span class="line">select empno,ename from emp where sal &lt;&gt; 800; // 小于号和大于号组成的不等号</span><br></pre></td></tr></table></figure><h4 id="lt-小于"><a href="#lt-小于" class="headerlink" title="&lt; 小于"></a>&lt; 小于</h4><p>查询薪资小于2000的员工姓名和编号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select empno,ename,sal from emp where sal &lt; 2000;</span><br><span class="line">+-------+--------+---------+</span><br><span class="line">| empno | ename  | sal     |</span><br><span class="line">+-------+--------+---------+</span><br><span class="line">|  7369 | SMITH  |  800.00 |</span><br><span class="line">|  7499 | ALLEN  | 1600.00 |</span><br><span class="line">|  7521 | WARD   | 1250.00 |</span><br><span class="line">|  7654 | MARTIN | 1250.00 |</span><br><span class="line">|  7844 | TURNER | 1500.00 |</span><br><span class="line">|  7876 | ADAMS  | 1100.00 |</span><br><span class="line">|  7900 | JAMES  |  950.00 |</span><br><span class="line">|  7934 | MILLER | 1300.00 |</span><br><span class="line">+-------+--------+---------+</span><br></pre></td></tr></table></figure><h4 id="lt-x3D-小于等于"><a href="#lt-x3D-小于等于" class="headerlink" title="&lt;&#x3D; 小于等于"></a>&lt;&#x3D; 小于等于</h4><p>查询薪资小于等于3000的员工姓名和编号？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select empno,ename,sal from emp where sal &lt;= 3000;</span><br></pre></td></tr></table></figure><h4 id="大于"><a href="#大于" class="headerlink" title="大于"></a>大于</h4><p>查询薪资大于3000的员工姓名和编号？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select empno,ename,sal from emp where sal &gt; 3000;</span><br></pre></td></tr></table></figure><h4 id="x3D-大于等于"><a href="#x3D-大于等于" class="headerlink" title="&#x3D; 大于等于"></a>&#x3D; 大于等于</h4><p>查询薪资大于等于3000的员工姓名和编号？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select empno,ename,sal from emp where sal &gt;= 3000;</span><br></pre></td></tr></table></figure><h4 id="between-…-and-…-两个值之间-等同于-gt-x3D-and-lt-x3D"><a href="#between-…-and-…-两个值之间-等同于-gt-x3D-and-lt-x3D" class="headerlink" title="between … and …. 两个值之间, 等同于 &gt;&#x3D; and &lt;&#x3D;"></a>between … and …. 两个值之间, 等同于 &gt;&#x3D; and &lt;&#x3D;</h4><p>查询薪资在2450和3000之间的员工信息？包括2450和3000</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">第一种方式：&gt;= and &lt;= （and是并且的意思。）</span><br><span class="line">select empno,ename,sal from emp where sal &gt;= 2450 and sal &lt;= 3000;</span><br><span class="line">+-------+-------+---------+</span><br><span class="line">| empno | ename | sal     |</span><br><span class="line">+-------+-------+---------+</span><br><span class="line">|  7566 | JONES | 2975.00 |</span><br><span class="line">|  7698 | BLAKE | 2850.00 |</span><br><span class="line">|  7782 | CLARK | 2450.00 |</span><br><span class="line">|  7788 | SCOTT | 3000.00 |</span><br><span class="line">|  7902 | FORD  | 3000.00 |</span><br><span class="line">+-------+-------+---------+</span><br><span class="line">第二种方式：between … and …</span><br><span class="line">select </span><br><span class="line">empno,ename,sal </span><br><span class="line">from </span><br><span class="line">emp </span><br><span class="line">where </span><br><span class="line">sal between 2450 and 3000;</span><br></pre></td></tr></table></figure><p><strong>注意：</strong><br>使用between and的时候，必须遵循左小右大。<br>between and是<strong>闭区间</strong>，包括两端的值。</p><h4 id="is-null-为-null（is-not-null-不为空"><a href="#is-null-为-null（is-not-null-不为空" class="headerlink" title="is null 为 null（is not null 不为空)"></a>is null 为 null（is not null 不为空)</h4><p>查询哪些员工的津贴&#x2F;补助为null？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select empno,ename,sal,comm from emp where comm = null;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line">mysql&gt; select empno,ename,sal,comm from emp where comm is null;</span><br><span class="line">+-------+--------+---------+------+</span><br><span class="line">| empno | ename  | sal     | comm |</span><br><span class="line">+-------+--------+---------+------+</span><br><span class="line">|  7369 | SMITH  |  800.00 | NULL |</span><br><span class="line">|  7566 | JONES  | 2975.00 | NULL |</span><br><span class="line">|  7698 | BLAKE  | 2850.00 | NULL |</span><br><span class="line">|  7782 | CLARK  | 2450.00 | NULL |</span><br><span class="line">|  7788 | SCOTT  | 3000.00 | NULL |</span><br><span class="line">|  7839 | KING   | 5000.00 | NULL |</span><br><span class="line">|  7876 | ADAMS  | 1100.00 | NULL |</span><br><span class="line">|  7900 | JAMES  |  950.00 | NULL |</span><br><span class="line">|  7902 | FORD   | 3000.00 | NULL |</span><br><span class="line">|  7934 | MILLER | 1300.00 | NULL |</span><br><span class="line">+-------+--------+---------+------+</span><br><span class="line">10 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>在数据库当中null不能使用等号进行衡量。需要使用is null<br>因为数据库中的null代表什么也没有，它不是一个值，所以不能使用<br>等号衡量。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">查询哪些员工的津贴/补助不为null？</span><br><span class="line">select empno,ename,sal,comm from emp where comm is not null;</span><br><span class="line">+-------+--------+---------+---------+</span><br><span class="line">| empno | ename  | sal     | comm    |</span><br><span class="line">+-------+--------+---------+---------+</span><br><span class="line">|  7499 | ALLEN  | 1600.00 |  300.00 |</span><br><span class="line">|  7521 | WARD   | 1250.00 |  500.00 |</span><br><span class="line">|  7654 | MARTIN | 1250.00 | 1400.00 |</span><br><span class="line">|  7844 | TURNER | 1500.00 |    0.00 |</span><br><span class="line">+-------+--------+---------+---------+</span><br></pre></td></tr></table></figure><h4 id="and-并且"><a href="#and-并且" class="headerlink" title="and 并且"></a><strong>and 并且</strong></h4><p>查询工作岗位是MANAGER并且工资大于2500的员工信息？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">empno,ename,job,sal </span><br><span class="line">from </span><br><span class="line">emp </span><br><span class="line">where </span><br><span class="line">job = &#x27;MANAGER&#x27; and sal &gt; 2500;</span><br><span class="line">+-------+-------+---------+---------+</span><br><span class="line">| empno | ename | job     | sal     |</span><br><span class="line">+-------+-------+---------+---------+</span><br><span class="line">|  7566 | JONES | MANAGER | 2975.00 |</span><br><span class="line">|  7698 | BLAKE | MANAGER | 2850.00 |</span><br><span class="line">+-------+-------+---------+---------+</span><br></pre></td></tr></table></figure><h4 id="or-或者"><a href="#or-或者" class="headerlink" title="or 或者"></a><strong>or 或者</strong></h4><p>查询工作岗位是MANAGER和SALESMAN的员工？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">select empno,ename,job from emp where job = &#x27;MANAGER&#x27;;</span><br><span class="line">select empno,ename,job from emp where job = &#x27;SALESMAN&#x27;;</span><br><span class="line">select </span><br><span class="line">empno,ename,job</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">where </span><br><span class="line">job = &#x27;MANAGER&#x27; or job = &#x27;SALESMAN&#x27;;</span><br><span class="line">+-------+--------+----------+</span><br><span class="line">| empno | ename  | job      |</span><br><span class="line">+-------+--------+----------+</span><br><span class="line">|  7499 | ALLEN  | SALESMAN |</span><br><span class="line">|  7521 | WARD   | SALESMAN |</span><br><span class="line">|  7566 | JONES  | MANAGER  |</span><br><span class="line">|  7654 | MARTIN | SALESMAN |</span><br><span class="line">|  7698 | BLAKE  | MANAGER  |</span><br><span class="line">|  7782 | CLARK  | MANAGER  |</span><br><span class="line">|  7844 | TURNER | SALESMAN |</span><br><span class="line">+-------+--------+----------+</span><br></pre></td></tr></table></figure><p>and和or同时出现的话，有优先级问题吗？<br>查询工资大于2500，并且部门编号为10或20部门的员工？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">*</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">where</span><br><span class="line">sal &gt; 2500 and deptno = 10 or deptno = 20;</span><br></pre></td></tr></table></figure><p>分析以上语句的问题？<br>​<strong>and优先级比or高</strong>。<br>以上语句会先执行and，然后执行or。<br>​以上这个语句表示什么含义？<br>​找出工资大于2500并且部门编号为10的员工，或者20部门所有员工找出来。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">*</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">where</span><br><span class="line">sal &gt; 2500 and (deptno = 10 or deptno = 20);</span><br></pre></td></tr></table></figure><p><strong>and和or同时出现，and优先级较高</strong>。如果想让or先执行，需要加“小括号”<br>以后在开发中，如果不确定优先级，就加小括号就行了。</p><h4 id="in-包含，相当于多个-or-（not-in-不在这个范围中）"><a href="#in-包含，相当于多个-or-（not-in-不在这个范围中）" class="headerlink" title="in 包含，相当于多个 or （not in 不在这个范围中）"></a><strong>in 包含，相当于多个 or （not in 不在这个范围中）</strong></h4><p>​查询工作岗位是MANAGER和SALESMAN的员工？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">select empno,ename,job from emp where job = &#x27;MANAGER&#x27; or job = &#x27;SALESMAN&#x27;;</span><br><span class="line">select empno,ename,job from emp where job in(&#x27;MANAGER&#x27;, &#x27;SALESMAN&#x27;);</span><br><span class="line">+-------+--------+----------+</span><br><span class="line">| empno | ename  | job      |</span><br><span class="line">+-------+--------+----------+</span><br><span class="line">|  7499 | ALLEN  | SALESMAN |</span><br><span class="line">|  7521 | WARD   | SALESMAN |</span><br><span class="line">|  7566 | JONES  | MANAGER  |</span><br><span class="line">|  7654 | MARTIN | SALESMAN |</span><br><span class="line">|  7698 | BLAKE  | MANAGER  |</span><br><span class="line">|  7782 | CLARK  | MANAGER  |</span><br><span class="line">|  7844 | TURNER | SALESMAN |</span><br><span class="line">+-------+--------+----------+</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>in不是一个区间，in后面跟的是具体的值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">查询薪资是800和5000的员工信息？</span><br><span class="line">select ename,sal from emp where sal = 800 or sal = 5000;</span><br><span class="line">select ename,sal from emp where sal in(800, 5000); //这个不是表示800到5000都找出来。</span><br><span class="line">+-------+---------+</span><br><span class="line">| ename | sal     |</span><br><span class="line">+-------+---------+</span><br><span class="line">| SMITH |  800.00 |</span><br><span class="line">| KING  | 5000.00 |</span><br><span class="line">+-------+---------+</span><br><span class="line">select ename,sal from emp where sal in(800, 5000, 3000);</span><br><span class="line">// not in 表示不在这几个值当中的数据。</span><br><span class="line">select ename,sal from emp where sal not in(800, 5000, 3000);</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><h4 id="not-可以取非，主要用在-is-或-in-中"><a href="#not-可以取非，主要用在-is-或-in-中" class="headerlink" title="not 可以取非，主要用在 is 或 in 中"></a><strong>not 可以取非，主要用在 is 或 in 中</strong></h4><p>​is null<br>​is not null<br>​in<br>​not in</p><h4 id="like"><a href="#like" class="headerlink" title="like"></a>like</h4><p>​称为模糊查询，支持%或下划线匹配<br>​%匹配任意多个字符<br>​下划线：任意一个字符。<br>​（%是一个特殊的符号，_ 也是一个特殊符号）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">找出名字中含有O的？</span><br><span class="line">mysql&gt; select ename from emp where ename like &#x27;%O%&#x27;;</span><br><span class="line">+-------+</span><br><span class="line">| ename |</span><br><span class="line">+-------+</span><br><span class="line">| JONES |</span><br><span class="line">| SCOTT |</span><br><span class="line">| FORD  |</span><br><span class="line">+-------+</span><br><span class="line"></span><br><span class="line">找出名字以T结尾的？</span><br><span class="line">select ename from emp where ename like &#x27;%T&#x27;;</span><br><span class="line"></span><br><span class="line">找出名字以K开始的？</span><br><span class="line">select ename from emp where ename like &#x27;K%&#x27;;</span><br><span class="line"></span><br><span class="line">找出第二个字每是A的？</span><br><span class="line">select ename from emp where ename like &#x27;_A%&#x27;;</span><br><span class="line"></span><br><span class="line">找出第三个字母是R的？</span><br><span class="line">select ename from emp where ename like &#x27;__R%&#x27;;</span><br><span class="line"></span><br><span class="line">找出名字中有“_”的？</span><br><span class="line">select name from t_student where name like &#x27;%_%&#x27;; //这样不行。</span><br><span class="line"></span><br><span class="line">mysql&gt; select name from t_student where name like &#x27;%\_%&#x27;; // \转义字符。</span><br><span class="line">+----------+</span><br><span class="line">| name     |</span><br><span class="line">+----------+</span><br><span class="line">| jack_son |</span><br><span class="line">+----------+</span><br></pre></td></tr></table></figure><h2 id="14、排序"><a href="#14、排序" class="headerlink" title="14、排序"></a>14、排序</h2><h3 id="14-1-查询所有员工薪资，排序"><a href="#14-1-查询所有员工薪资，排序" class="headerlink" title="14.1 查询所有员工薪资，排序"></a>14.1 查询所有员工薪资，排序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">order by</span><br><span class="line">sal; // 默认是升序！！！</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| SMITH  |  800.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| KING   | 5000.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><h3 id="14-2-降序"><a href="#14-2-降序" class="headerlink" title="14.2 降序"></a>14.2 降序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">指定降序：</span><br><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">order by</span><br><span class="line">sal desc;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| KING   | 5000.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| SMITH  |  800.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">指定升序？</span><br><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">order by</span><br><span class="line">sal asc;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| SMITH  |  800.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| KING   | 5000.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><h3 id="14-3-可以两个字段排序吗？或者说按照多个字段排序？"><a href="#14-3-可以两个字段排序吗？或者说按照多个字段排序？" class="headerlink" title="14.3 可以两个字段排序吗？或者说按照多个字段排序？"></a>14.3 可以两个字段排序吗？或者说按照多个字段排序？</h3><p>​查询员工名字和薪资，要求按照薪资升序，如果薪资一样的话，<br>​再按照名字升序排列。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">order by</span><br><span class="line">sal asc, ename asc; // sal在前，起主导，只有sal相等的时候，才会考虑启用ename排序。</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| SMITH  |  800.00 |</span><br><span class="line">| JAMES  |  950.00 |</span><br><span class="line">| ADAMS  | 1100.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| KING   | 5000.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><h3 id="14-4-了解：根据字段的位置也可以排序"><a href="#14-4-了解：根据字段的位置也可以排序" class="headerlink" title="14.4 了解：根据字段的位置也可以排序"></a>14.4 了解：根据字段的位置也可以排序</h3><p>​select ename,sal from emp order by 2; &#x2F;&#x2F; 2表示第二列。第二列是sal<br>​按照查询结果的第2列sal排序。</p><p>了解一下，不建议在开发中这样写，因为不健壮。<br>因为列的顺序很容易发生改变，列顺序修改之后，2就废了。</p><h2 id="15、综合案例："><a href="#15、综合案例：" class="headerlink" title="15、综合案例："></a>15、综合案例：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">找出工资在1250到3000之间的员工信息，要求按照薪资降序排列。</span><br><span class="line">select </span><br><span class="line">ename,sal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">where</span><br><span class="line">sal between 1250 and 3000</span><br><span class="line">order by</span><br><span class="line">sal desc;</span><br><span class="line"></span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | sal     |</span><br><span class="line">+--------+---------+</span><br><span class="line">| FORD   | 3000.00 |</span><br><span class="line">| SCOTT  | 3000.00 |</span><br><span class="line">| JONES  | 2975.00 |</span><br><span class="line">| BLAKE  | 2850.00 |</span><br><span class="line">| CLARK  | 2450.00 |</span><br><span class="line">| ALLEN  | 1600.00 |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| MILLER | 1300.00 |</span><br><span class="line">| MARTIN | 1250.00 |</span><br><span class="line">| WARD   | 1250.00 |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><p>​关键字顺序不能变：<br>​select<br>​…<br>​from<br>​…<br>​where<br>​…<br>​order by<br>​…<br>以上语句的执行顺序必须掌握：<br>​第一步：from<br>​第二步：where<br>​第三步：select<br>​第四步：order by（排序总是在最后执行！）</p><h2 id="16、数据处理函数"><a href="#16、数据处理函数" class="headerlink" title="16、数据处理函数"></a>16、数据处理函数</h2><h3 id="16-1-数据处理函数又被称为单行处理函数"><a href="#16-1-数据处理函数又被称为单行处理函数" class="headerlink" title="16.1 数据处理函数又被称为单行处理函数"></a>16.1 数据处理函数又被称为单行处理函数</h3><p>单行处理函数的特点：一个输入对应一个输出。</p><p>和单行处理函数相对的是：多行处理函数。（多行处理函数特点：多个输入，对应1个输出！）</p><h3 id="16-2-单行处理函数常见的有哪些？"><a href="#16-2-单行处理函数常见的有哪些？" class="headerlink" title="16.2 单行处理函数常见的有哪些？"></a>16.2 单行处理函数常见的有哪些？</h3><h4 id="lower-转换小写"><a href="#lower-转换小写" class="headerlink" title="lower 转换小写"></a>lower 转换小写</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select lower(ename) as ename from emp;</span><br><span class="line">+--------+</span><br><span class="line">| ename  |</span><br><span class="line">+--------+</span><br><span class="line">| smith  |</span><br><span class="line">| allen  |</span><br><span class="line">| ward   |</span><br><span class="line">| jones  |</span><br><span class="line">| martin |</span><br><span class="line">| blake  |</span><br><span class="line">| clark  |</span><br><span class="line">| scott  |</span><br><span class="line">| king   |</span><br><span class="line">| turner |</span><br><span class="line">| adams  |</span><br><span class="line">| james  |</span><br><span class="line">| ford   |</span><br><span class="line">| miller |</span><br><span class="line">+--------+</span><br><span class="line">14个输入，最后还是14个输出。这是单行处理函数的特点。</span><br></pre></td></tr></table></figure><h4 id="upper-转换大写"><a href="#upper-转换大写" class="headerlink" title="upper 转换大写"></a>upper 转换大写</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select upper(name) as name from t_student;</span><br><span class="line">+----------+</span><br><span class="line">| name     |</span><br><span class="line">+----------+</span><br><span class="line">| ZHANGSAN |</span><br><span class="line">| LISI     |</span><br><span class="line">| WANGWU   |</span><br><span class="line">| JACK_SON |</span><br><span class="line">+----------+</span><br></pre></td></tr></table></figure><h4 id="substr-取子串"><a href="#substr-取子串" class="headerlink" title="substr 取子串"></a>substr 取子串</h4><p>substr( 被截取的字符串, 起始下标,截取的长度)<br>    select substr(ename, 1, 1) as ename from emp;<br>    注意：起始下标从1开始，没有0.<br>    找出员工名字第一个字母是A的员工信息？<br>        第一种方式：模糊查询<br>            select ename from emp where ename like ‘A%’;<br>        第二种方式：substr函数<br>            select<br>                ename<br>            from<br>                emp<br>            where<br>                substr(ename,1,1) &#x3D; ‘A’;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">首字母大写</span><br><span class="line">select name from t_student;</span><br><span class="line">select upper(substr(name,1,1)) from t_student;</span><br><span class="line">select substr(name,2,length(name) - 1) from t_student;</span><br><span class="line">select concat(upper(substr(name,1,1)),substr(name,2,length(name) - 1)) as result from t_student;</span><br><span class="line">+----------+</span><br><span class="line">| result   |</span><br><span class="line">+----------+</span><br><span class="line">| Zhangsan |</span><br><span class="line">| Lisi     |</span><br><span class="line">| Wangwu   |</span><br><span class="line">| Jack_son |</span><br><span class="line">+----------+</span><br></pre></td></tr></table></figure><h4 id="concat函数进行字符串的拼接"><a href="#concat函数进行字符串的拼接" class="headerlink" title="concat函数进行字符串的拼接"></a>concat函数进行字符串的拼接</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">select concat(empno,ename) from emp;</span><br><span class="line">+---------------------+</span><br><span class="line">| concat(empno,ename) |</span><br><span class="line">+---------------------+</span><br><span class="line">| 7369SMITH           |</span><br><span class="line">| 7499ALLEN           |</span><br><span class="line">| 7521WARD            |</span><br><span class="line">| 7566JONES           |</span><br><span class="line">| 7654MARTIN          |</span><br><span class="line">| 7698BLAKE           |</span><br><span class="line">| 7782CLARK           |</span><br><span class="line">| 7788SCOTT           |</span><br><span class="line">| 7839KING            |</span><br><span class="line">| 7844TURNER          |</span><br><span class="line">| 7876ADAMS           |</span><br><span class="line">| 7900JAMES           |</span><br><span class="line">| 7902FORD            |</span><br><span class="line">| 7934MILLER          |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure><h4 id="length-取长度"><a href="#length-取长度" class="headerlink" title="length 取长度"></a>length 取长度</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">select length(ename) enamelength from emp;</span><br><span class="line">+-------------+</span><br><span class="line">| enamelength |</span><br><span class="line">+-------------+</span><br><span class="line">|           5 |</span><br><span class="line">|           5 |</span><br><span class="line">|           4 |</span><br><span class="line">|           5 |</span><br><span class="line">|           6 |</span><br><span class="line">|           5 |</span><br><span class="line">|           5 |</span><br><span class="line">|           5 |</span><br><span class="line">|           4 |</span><br><span class="line">|           6 |</span><br><span class="line">|           5 |</span><br><span class="line">|           5 |</span><br><span class="line">|           4 |</span><br><span class="line">|           6 |</span><br><span class="line">+-------------+</span><br></pre></td></tr></table></figure><h4 id="trim-去空格"><a href="#trim-去空格" class="headerlink" title="trim 去空格"></a>trim 去空格</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from emp where ename = &#x27;  KING&#x27;;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line">mysql&gt; select * from emp where ename = trim(&#x27;   KING&#x27;);</span><br><span class="line">+-------+-------+-----------+------+------------+---------+------+--------+</span><br><span class="line">| EMPNO | ENAME | JOB       | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |</span><br><span class="line">+-------+-------+-----------+------+------------+---------+------+--------+</span><br><span class="line">|  7839 | KING  | PRESIDENT | NULL | 1981-11-17 | 5000.00 | NULL |     10 |</span><br><span class="line">+-------+-------+-----------+------+------------+---------+------+--------+</span><br></pre></td></tr></table></figure><p>str_to_date 将字符串转换成日期<br>date_format 格式化日期<br>format 设置千分位</p><h4 id="case-when-then-when-then-else-end"><a href="#case-when-then-when-then-else-end" class="headerlink" title="case..when..then..when..then..else..end"></a>case..when..then..when..then..else..end</h4><p>​当员工的工作岗位是MANAGER的时候，工资上调10%，当工作岗位是SALESMAN的时候，工资上调50%,其它正常。<br>​（注意：不修改数据库，只是将查询结果显示为工资上调）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">ename,</span><br><span class="line">job, </span><br><span class="line">sal as oldsal,</span><br><span class="line">(case job when &#x27;MANAGER&#x27; then sal*1.1 when &#x27;SALESMAN&#x27; then sal*1.5 else sal end) as newsal </span><br><span class="line">from </span><br><span class="line">emp;</span><br><span class="line">+--------+-----------+---------+---------+</span><br><span class="line">| ename  | job       | oldsal  | newsal  |</span><br><span class="line">+--------+-----------+---------+---------+</span><br><span class="line">| SMITH  | CLERK     |  800.00 |  800.00 |</span><br><span class="line">| ALLEN  | SALESMAN  | 1600.00 | 2400.00 |</span><br><span class="line">| WARD   | SALESMAN  | 1250.00 | 1875.00 |</span><br><span class="line">| JONES  | MANAGER   | 2975.00 | 3272.50 |</span><br><span class="line">| MARTIN | SALESMAN  | 1250.00 | 1875.00 |</span><br><span class="line">| BLAKE  | MANAGER   | 2850.00 | 3135.00 |</span><br><span class="line">| CLARK  | MANAGER   | 2450.00 | 2695.00 |</span><br><span class="line">| SCOTT  | ANALYST   | 3000.00 | 3000.00 |</span><br><span class="line">| KING   | PRESIDENT | 5000.00 | 5000.00 |</span><br><span class="line">| TURNER | SALESMAN  | 1500.00 | 2250.00 |</span><br><span class="line">| ADAMS  | CLERK     | 1100.00 | 1100.00 |</span><br><span class="line">| JAMES  | CLERK     |  950.00 |  950.00 |</span><br><span class="line">| FORD   | ANALYST   | 3000.00 | 3000.00 |</span><br><span class="line">| MILLER | CLERK     | 1300.00 | 1300.00 |</span><br><span class="line">+--------+-----------+---------+---------+</span><br></pre></td></tr></table></figure><h4 id="round-四舍五入"><a href="#round-四舍五入" class="headerlink" title="round 四舍五入"></a>round 四舍五入</h4><p>​select 字段 from 表名;<br>​select ename from emp;<br>​select ‘abc’ from emp; &#x2F;&#x2F; select后面直接跟“字面量&#x2F;字面值”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select &#x27;abc&#x27; as bieming from emp;</span><br><span class="line">+---------+</span><br><span class="line">| bieming |</span><br><span class="line">+---------+</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">| abc     |</span><br><span class="line">+---------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select abc from emp;</span><br><span class="line">ERROR 1054 (42S22): Unknown column &#x27;abc&#x27; in &#x27;field list&#x27;</span><br><span class="line">这样肯定报错，因为会把abc当做一个字段的名字，去emp表中找abc字段去了。</span><br><span class="line">select 1000 as num from emp; // 1000 也是被当做一个字面量/字面值。</span><br><span class="line">+------+</span><br><span class="line">| num  |</span><br><span class="line">+------+</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">| 1000 |</span><br><span class="line">+------+</span><br><span class="line"></span><br><span class="line">结论：select后面可以跟某个表的字段名（可以等同看做变量名），也可以跟字面量/字面值（数据）。</span><br><span class="line">select 21000 as num from dept;</span><br><span class="line">+-------+</span><br><span class="line">| num   |</span><br><span class="line">+-------+</span><br><span class="line">| 21000 |</span><br><span class="line">| 21000 |</span><br><span class="line">| 21000 |</span><br><span class="line">| 21000 |</span><br><span class="line">+-------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select round(1236.567, 0) as result from emp; //保留整数位。</span><br><span class="line">+--------+</span><br><span class="line">| result |</span><br><span class="line">+--------+</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">|   1237 |</span><br><span class="line">+--------+</span><br><span class="line"></span><br><span class="line">select round(1236.567, 1) as result from emp; //保留1个小数</span><br><span class="line">select round(1236.567, 2) as result from emp; //保留2个小数</span><br><span class="line">select round(1236.567, -1) as result from emp; // 保留到十位。</span><br><span class="line">+--------+</span><br><span class="line">| result |</span><br><span class="line">+--------+</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">|   1240 |</span><br><span class="line">+--------+</span><br><span class="line"></span><br><span class="line">select round(1236.567, -2) as result from emp;// 保留到百位。</span><br><span class="line">+--------+</span><br><span class="line">| result |</span><br><span class="line">+--------+</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">|   1200 |</span><br><span class="line">+--------+</span><br></pre></td></tr></table></figure><h4 id="rand-生成随机数"><a href="#rand-生成随机数" class="headerlink" title="rand() 生成随机数"></a>rand() 生成随机数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select round(rand()*100,0) from emp; // 100以内的随机数</span><br><span class="line">+---------------------+</span><br><span class="line">| round(rand()*100,0) |</span><br><span class="line">+---------------------+</span><br><span class="line">|                  76 |</span><br><span class="line">|                  29 |</span><br><span class="line">|                  15 |</span><br><span class="line">|                  88 |</span><br><span class="line">|                  95 |</span><br><span class="line">|                   9 |</span><br><span class="line">|                  63 |</span><br><span class="line">|                  89 |</span><br><span class="line">|                  54 |</span><br><span class="line">|                   3 |</span><br><span class="line">|                  54 |</span><br><span class="line">|                  61 |</span><br><span class="line">|                  42 |</span><br><span class="line">|                  28 |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure><h4 id="ifnull空处理函数"><a href="#ifnull空处理函数" class="headerlink" title="ifnull空处理函数"></a>ifnull空处理函数</h4><p>ifnull 可以将 null 转换成一个具体值，它是专门处理空的。<br>在所有数据库当中，只要有NULL参与的数学运算，最终结果就是NULL。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ename, sal + comm as salcomm from emp;</span><br><span class="line">+--------+---------+</span><br><span class="line">| ename  | salcomm |</span><br><span class="line">+--------+---------+</span><br><span class="line">| SMITH  |    NULL |</span><br><span class="line">| ALLEN  | 1900.00 |</span><br><span class="line">| WARD   | 1750.00 |</span><br><span class="line">| JONES  |    NULL |</span><br><span class="line">| MARTIN | 2650.00 |</span><br><span class="line">| BLAKE  |    NULL |</span><br><span class="line">| CLARK  |    NULL |</span><br><span class="line">| SCOTT  |    NULL |</span><br><span class="line">| KING   |    NULL |</span><br><span class="line">| TURNER | 1500.00 |</span><br><span class="line">| ADAMS  |    NULL |</span><br><span class="line">| JAMES  |    NULL |</span><br><span class="line">| FORD   |    NULL |</span><br><span class="line">| MILLER |    NULL |</span><br><span class="line">+--------+---------+</span><br></pre></td></tr></table></figure><p>计算每个员工的年薪？<br>    年薪 &#x3D; (月薪 + 月补助) * 12</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">select ename, (sal + comm) * 12 as yearsal from emp;</span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | yearsal  |</span><br><span class="line">+--------+----------+</span><br><span class="line">| SMITH  |     NULL |</span><br><span class="line">| ALLEN  | 22800.00 |</span><br><span class="line">| WARD   | 21000.00 |</span><br><span class="line">| JONES  |     NULL |</span><br><span class="line">| MARTIN | 31800.00 |</span><br><span class="line">| BLAKE  |     NULL |</span><br><span class="line">| CLARK  |     NULL |</span><br><span class="line">| SCOTT  |     NULL |</span><br><span class="line">| KING   |     NULL |</span><br><span class="line">| TURNER | 18000.00 |</span><br><span class="line">| ADAMS  |     NULL |</span><br><span class="line">| JAMES  |     NULL |</span><br><span class="line">| FORD   |     NULL |</span><br><span class="line">| MILLER |     NULL |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>NULL只要参与运算，最终结果一定是NULL。为了避免这个现象，需要使用ifnull函数。<br>    ifnull函数用法：ifnull(数据, 被当做哪个值)<br>        如果“数据”为NULL的时候，把这个数据结构当做哪个值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">补助为NULL的时候，将补助当做0</span><br><span class="line">select ename, (sal + ifnull(comm, 0)) * 12 as yearsal from emp;</span><br><span class="line">+--------+----------+</span><br><span class="line">| ename  | yearsal  |</span><br><span class="line">+--------+----------+</span><br><span class="line">| SMITH  |  9600.00 |</span><br><span class="line">| ALLEN  | 22800.00 |</span><br><span class="line">| WARD   | 21000.00 |</span><br><span class="line">| JONES  | 35700.00 |</span><br><span class="line">| MARTIN | 31800.00 |</span><br><span class="line">| BLAKE  | 34200.00 |</span><br><span class="line">| CLARK  | 29400.00 |</span><br><span class="line">| SCOTT  | 36000.00 |</span><br><span class="line">| KING   | 60000.00 |</span><br><span class="line">| TURNER | 18000.00 |</span><br><span class="line">| ADAMS  | 13200.00 |</span><br><span class="line">| JAMES  | 11400.00 |</span><br><span class="line">| FORD   | 36000.00 |</span><br><span class="line">| MILLER | 15600.00 |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure><h2 id="17、分组函数（多行处理函数）"><a href="#17、分组函数（多行处理函数）" class="headerlink" title="17、分组函数（多行处理函数）"></a>17、分组函数（多行处理函数）</h2><p>多行处理函数的特点：<strong>输入多行，最终输出一行</strong>。</p><p>5个：<br>    count计数<br>    sum求和<br>    avg平均值<br>    max最大值<br>    min最小值</p><p><strong>注意:</strong><br>    分组函数在使用的时候必须先进行分组，然后才能用。<br>    如果你没有对数据进行分组，整张表默认为一组。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">找出最高工资？</span><br><span class="line">mysql&gt; select max(sal) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| max(sal) |</span><br><span class="line">+----------+</span><br><span class="line">|  5000.00 |</span><br><span class="line">+----------+</span><br><span class="line"></span><br><span class="line">找出最低工资？</span><br><span class="line">mysql&gt; select min(sal) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| min(sal) |</span><br><span class="line">+----------+</span><br><span class="line">|   800.00 |</span><br><span class="line">+----------+</span><br><span class="line"></span><br><span class="line">计算工资和：</span><br><span class="line">mysql&gt; select sum(sal) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| sum(sal) |</span><br><span class="line">+----------+</span><br><span class="line">| 29025.00 |</span><br><span class="line">+----------+</span><br><span class="line"></span><br><span class="line">计算平均工资：</span><br><span class="line">mysql&gt; select avg(sal) from emp;</span><br><span class="line">+-------------+</span><br><span class="line">| avg(sal)    |</span><br><span class="line">+-------------+</span><br><span class="line">| 2073.214286 |</span><br><span class="line">+-------------+</span><br><span class="line">14个工资全部加起来，然后除以14。</span><br><span class="line"></span><br><span class="line">计算员工数量？</span><br><span class="line">mysql&gt; select count(ename) from emp;</span><br><span class="line">+--------------+</span><br><span class="line">| count(ename) |</span><br><span class="line">+--------------+</span><br><span class="line">|           14 |</span><br><span class="line">+--------------+</span><br></pre></td></tr></table></figure><p>分组函数在使用的时候需要注意哪些？</p><p><strong>第一点：</strong>分组函数自动忽略NULL，你不需要提前对NULL进行处理。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select sum(comm) from emp;</span><br><span class="line">+-----------+</span><br><span class="line">| sum(comm) |</span><br><span class="line">+-----------+</span><br><span class="line">|   2200.00 |</span><br><span class="line">+-----------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select count(comm) from emp;</span><br><span class="line">+-------------+</span><br><span class="line">| count(comm) |</span><br><span class="line">+-------------+</span><br><span class="line">|           4 |</span><br><span class="line">+-------------+</span><br><span class="line">mysql&gt; select avg(comm) from emp;</span><br><span class="line">+------------+</span><br><span class="line">| avg(comm)  |</span><br><span class="line">+------------+</span><br><span class="line">| 550.000000 |</span><br><span class="line">+------------+</span><br></pre></td></tr></table></figure><p><strong>第二点：</strong>分组函数中count(*)和count(具体字段)有什么区别？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select count(comm) from emp;</span><br><span class="line">+-------------+</span><br><span class="line">| count(comm) |</span><br><span class="line">+-------------+</span><br><span class="line">|           4 |</span><br><span class="line">+-------------+</span><br><span class="line">mysql&gt; select count(*) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|       14 |</span><br><span class="line">+----------+</span><br></pre></td></tr></table></figure><p><code>count(具体字段)</code>：表示统计该字段下所有不为NULL的元素的总数。<br><code>count(*)</code>：统计表当中的总行数。（只要有一行数据count则++）<br>因为每一行记录不可能都为NULL，一行数据中有一列不为NULL，则这行数据就是有效的。</p><p><strong>第三点</strong>：分组函数不能够直接使用在where子句中。<br>    找出比最低工资高的员工信息。<br>        select ename,sal from emp where sal &gt; min(sal);<br>        表面上没问题，运行一下？<br>            ERROR 1111 (HY000): Invalid use of group function…<br>    说完分组查询(group by)之后就明白了了。</p><p><strong>第四点：</strong>所有的分组函数可以组合起来一起用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select sum(sal),min(sal),max(sal),avg(sal),count(*) from emp;</span><br><span class="line">+----------+----------+----------+-------------+----------+</span><br><span class="line">| sum(sal) | min(sal) | max(sal) | avg(sal)    | count(*) |</span><br><span class="line">+----------+----------+----------+-------------+----------+</span><br><span class="line">| 29025.00 |   800.00 |  5000.00 | 2073.214286 |       14 |</span><br><span class="line">+----------+----------+----------+-------------+----------+</span><br></pre></td></tr></table></figure><h2 id="18、分组查询（非常重要：五颗星-）"><a href="#18、分组查询（非常重要：五颗星-）" class="headerlink" title="18、分组查询（非常重要：五颗星*****）"></a>18、分组查询（非常重要：五颗星*****）</h2><h3 id="18-1-什么是分组查询？"><a href="#18-1-什么是分组查询？" class="headerlink" title="18.1 什么是分组查询？"></a>18.1 什么是分组查询？</h3><p>​在实际的应用中，可能有这样的需求，需要先进行分组，然后对每一组的数据进行操作。<br>​这个时候我们需要使用分组查询，怎么进行分组查询呢？<br>​select<br>​…<br>​from<br>​…<br>​group by<br>​…<br>​计算每个部门的工资和？<br>​计算每个工作岗位的平均薪资？<br>​找出每个工作岗位的最高薪资？<br>​….</p><h3 id="18-2-将之前的关键字全部组合在一起，来看一下他们的执行顺序？"><a href="#18-2-将之前的关键字全部组合在一起，来看一下他们的执行顺序？" class="headerlink" title="18.2 将之前的关键字全部组合在一起，来看一下他们的执行顺序？"></a>18.2 将之前的关键字全部组合在一起，来看一下他们的执行顺序？</h3><p>​select<br>​…<br>​from<br>​…<br>​where<br>​…<br>​group by<br>​…<br>​order by<br>​…<br>以上关键字的顺序不能颠倒，需要记忆。<br>执行顺序是什么？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. from</span><br><span class="line">2. where</span><br><span class="line">3. group by</span><br><span class="line">4. select</span><br><span class="line">5. order by</span><br></pre></td></tr></table></figure><p>为什么分组函数不能直接使用在where后面？<br>    select ename,sal from emp where sal &gt; min(sal);&#x2F;&#x2F;报错。<br>    因为分组函数在使用的时候必须先分组之后才能使用。<br>    where执行的时候，还没有分组。所以where后面不能出现分组函数。</p><p>select sum(sal) from emp;<br>这个没有分组，为啥sum()函数可以用呢？<br>    因为select在group by之后执行。</p><h3 id="18-3-找出每个工作岗位的工资和？"><a href="#18-3-找出每个工作岗位的工资和？" class="headerlink" title="18.3 找出每个工作岗位的工资和？"></a>18.3 找出每个工作岗位的工资和？</h3><p>实现思路：按照工作岗位分组，然后对工资求和</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">job,sum(sal)</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">group by</span><br><span class="line">job;</span><br><span class="line"></span><br><span class="line">+-----------+----------+</span><br><span class="line">| job       | sum(sal) |</span><br><span class="line">+-----------+----------+</span><br><span class="line">| ANALYST   |  6000.00 |</span><br><span class="line">| CLERK        |  4150.00 |</span><br><span class="line">| MANAGER   |  8275.00 |</span><br><span class="line">| PRESIDENT |  5000.00 |</span><br><span class="line">| SALESMAN  |  5600.00 |</span><br><span class="line">+-----------+----------+</span><br><span class="line">以上这个语句的执行顺序？</span><br><span class="line">先从emp表中查询数据。</span><br><span class="line">根据job字段进行分组。</span><br><span class="line">然后对每一组的数据进行sum(sal)</span><br><span class="line"></span><br><span class="line">select ename,job,sum(sal) from emp group by job;</span><br><span class="line">+-------+-----------+----------+</span><br><span class="line">| ename | job       | sum(sal) |</span><br><span class="line">+-------+-----------+----------+</span><br><span class="line">| SCOTT | ANALYST   |  6000.00 |</span><br><span class="line">| SMITH | CLERK     |  4150.00 |</span><br><span class="line">| JONES | MANAGER   |  8275.00 |</span><br><span class="line">| KING  | PRESIDENT |  5000.00 |</span><br><span class="line">| ALLEN | SALESMAN  |  5600.00 |</span><br><span class="line">+-------+-----------+----------+</span><br><span class="line">以上语句在mysql中可以执行，但是毫无意义。</span><br><span class="line">以上语句在oracle中执行报错。</span><br><span class="line">oracle的语法比mysql的语法严格。（mysql的语法相对来说松散一些！）</span><br></pre></td></tr></table></figure><p><strong>重点结论：</strong><br>    在一条select语句当中，如果有group by语句的话，<br>    select后面只能跟：参加分组的字段，以及分组函数。<br>    其它的一律不能跟。</p><h3 id="18-4-找出每个部门的最高薪资"><a href="#18-4-找出每个部门的最高薪资" class="headerlink" title="18.4 找出每个部门的最高薪资"></a>18.4 找出每个部门的最高薪资</h3><p>​实现思路是什么？<br>​按照部门编号分组，求每一组的最大值。</p><p>​select后面添加ename字段没有意义，另外oracle会报错。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ename,deptno,max(sal) from emp group by deptno;</span><br><span class="line">+-------+--------+----------+</span><br><span class="line">| ename | deptno | max(sal) |</span><br><span class="line">+-------+--------+----------+</span><br><span class="line">| CLARK |     10 |  5000.00 |</span><br><span class="line">| SMITH |     20 |  3000.00 |</span><br><span class="line">| ALLEN |     30 |  2850.00 |</span><br><span class="line">+-------+--------+----------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select deptno,max(sal) from emp group by deptno;</span><br><span class="line">+--------+----------+</span><br><span class="line">| deptno | max(sal) |</span><br><span class="line">+--------+----------+</span><br><span class="line">|     10 |  5000.00 |</span><br><span class="line">|     20 |  3000.00 |</span><br><span class="line">|     30 |  2850.00 |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure><h3 id="18-5-找出“每个部门，不同工作岗位”的最高薪资？"><a href="#18-5-找出“每个部门，不同工作岗位”的最高薪资？" class="headerlink" title="18.5 找出“每个部门，不同工作岗位”的最高薪资？"></a>18.5 找出“每个部门，不同工作岗位”的最高薪资？</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">+--------+-----------+---------+--------+</span><br><span class="line">| ename  | job       | sal     | deptno |</span><br><span class="line">+--------+-----------+---------+--------+</span><br><span class="line">| MILLER | CLERK     | 1300.00 |     10 |</span><br><span class="line">| KING   | PRESIDENT | 5000.00 |     10 |</span><br><span class="line">| CLARK  | MANAGER   | 2450.00 |     10 |</span><br><span class="line">| FORD   | ANALYST   | 3000.00 |     20 |</span><br><span class="line">| ADAMS  | CLERK     | 1100.00 |     20 |</span><br><span class="line">| SCOTT  | ANALYST   | 3000.00 |     20 |</span><br><span class="line">| JONES  | MANAGER   | 2975.00 |     20 |</span><br><span class="line">| SMITH  | CLERK     |  800.00 |     20 |</span><br><span class="line"></span><br><span class="line">| BLAKE  | MANAGER   | 2850.00 |     30 |</span><br><span class="line">| MARTIN | SALESMAN  | 1250.00 |     30 |</span><br><span class="line">| ALLEN  | SALESMAN  | 1600.00 |     30 |</span><br><span class="line">| TURNER | SALESMAN  | 1500.00 |     30 |</span><br><span class="line">| WARD   | SALESMAN  | 1250.00 |     30 |</span><br><span class="line">| JAMES  | CLERK     |  950.00 |     30 |</span><br><span class="line">+--------+-----------+---------+--------+</span><br><span class="line">技巧：两个字段联合成1个字段看。（两个字段联合分组）</span><br><span class="line">select </span><br><span class="line">deptno, job, max(sal)</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">group by</span><br><span class="line">deptno, job;</span><br><span class="line"></span><br><span class="line">+--------+-----------+----------+</span><br><span class="line">| deptno | job       | max(sal) |</span><br><span class="line">+--------+-----------+----------+</span><br><span class="line">|     10 | CLERK     |  1300.00 |</span><br><span class="line">|     10 | MANAGER   |  2450.00 |</span><br><span class="line">|     10 | PRESIDENT |  5000.00 |</span><br><span class="line">|     20 | ANALYST   |  3000.00 |</span><br><span class="line">|     20 | CLERK     |  1100.00 |</span><br><span class="line">|     20 | MANAGER   |  2975.00 |</span><br><span class="line">|     30 | CLERK     |   950.00 |</span><br><span class="line">|     30 | MANAGER   |  2850.00 |</span><br><span class="line">|     30 | SALESMAN  |  1600.00 |</span><br><span class="line">+--------+-----------+----------+</span><br></pre></td></tr></table></figure><h3 id="18-6-使用having可以对分完组之后的数据进一步过滤。"><a href="#18-6-使用having可以对分完组之后的数据进一步过滤。" class="headerlink" title="18.6 使用having可以对分完组之后的数据进一步过滤。"></a>18.6 使用having可以对分完组之后的数据进一步过滤。</h3><p>having不能单独使用，having不能代替where，having必须<br>和group by联合使用。</p><p>找出每个部门最高薪资，要求显示最高薪资大于3000的？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">第一步：找出每个部门最高薪资</span><br><span class="line">按照部门编号分组，求每一组最大值。</span><br><span class="line">select deptno,max(sal) from emp group by deptno;</span><br><span class="line">+--------+----------+</span><br><span class="line">| deptno | max(sal) |</span><br><span class="line">+--------+----------+</span><br><span class="line">|     10 |  5000.00 |</span><br><span class="line">|     20 |  3000.00 |</span><br><span class="line">|     30 |  2850.00 |</span><br><span class="line">+--------+----------+</span><br><span class="line"></span><br><span class="line">第二步：要求显示最高薪资大于3000</span><br><span class="line">select </span><br><span class="line">deptno,max(sal) </span><br><span class="line">from </span><br><span class="line">emp </span><br><span class="line">group by </span><br><span class="line">deptno</span><br><span class="line">having</span><br><span class="line">max(sal) &gt; 3000;</span><br><span class="line"></span><br><span class="line">+--------+----------+</span><br><span class="line">| deptno | max(sal) |</span><br><span class="line">+--------+----------+</span><br><span class="line">|     10 |  5000.00 |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure><p>思考一个问题：以上的sql语句执行效率是不是低？<br>比较低，实际上可以这样考虑：先将大于3000的都找出来，然后再分组。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">deptno,max(sal)</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">where</span><br><span class="line">sal &gt; 3000</span><br><span class="line">group by</span><br><span class="line">deptno;</span><br><span class="line"></span><br><span class="line">+--------+----------+</span><br><span class="line">| deptno | max(sal) |</span><br><span class="line">+--------+----------+</span><br><span class="line">|     10 |  5000.00 |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure><p><strong>优化策略：</strong><br>        where和having，优先选择where，where实在完成不了了，再选择having。</p><h3 id="18-7-where没办法的"><a href="#18-7-where没办法的" class="headerlink" title="18.7 where没办法的"></a>18.7 where没办法的</h3><p>​找出每个部门平均薪资，要求显示平均薪资高于2500的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">第一步：找出每个部门平均薪资</span><br><span class="line">select deptno,avg(sal) from emp group by deptno;</span><br><span class="line">+--------+-------------+</span><br><span class="line">| deptno | avg(sal)    |</span><br><span class="line">+--------+-------------+</span><br><span class="line">|     10 | 2916.666667 |</span><br><span class="line">|     20 | 2175.000000 |</span><br><span class="line">|     30 | 1566.666667 |</span><br><span class="line">+--------+-------------+</span><br><span class="line">第二步：要求显示平均薪资高于2500的</span><br><span class="line">select </span><br><span class="line">deptno,avg(sal) </span><br><span class="line">from </span><br><span class="line">emp </span><br><span class="line">group by </span><br><span class="line">deptno</span><br><span class="line">having</span><br><span class="line">avg(sal) &gt; 2500;</span><br><span class="line"></span><br><span class="line">+--------+-------------+</span><br><span class="line">| deptno | avg(sal)    |</span><br><span class="line">+--------+-------------+</span><br><span class="line">|     10 | 2916.666667 |</span><br><span class="line">+--------+-------------+</span><br></pre></td></tr></table></figure><h3 id="19、大总结（单表的查询学完了）"><a href="#19、大总结（单表的查询学完了）" class="headerlink" title="19、大总结（单表的查询学完了）"></a>19、大总结（单表的查询学完了）</h3><p>​select<br>​…<br>​from<br>​…<br>​where<br>​…<br>​group by<br>​…<br>​having<br>​…<br>​order by<br>​…</p><p>以上关键字只能按照这个顺序来，不能颠倒。</p><p><strong>执行顺序</strong><br>    1. from<br>    2. where<br>    3. group by<br>    4. having<br>    5. select<br>    6. order by</p><p>从某张表中查询数据，<br>先经过where条件筛选出有价值的数据。<br>对这些有价值的数据进行分组。<br>分组之后可以使用having继续筛选。<br>select查询出来。<br>最后排序输出！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">找出每个岗位的平均薪资，要求显示平均薪资大于1500的，除MANAGER岗位之外，</span><br><span class="line">要求按照平均薪资降序排。</span><br><span class="line">select </span><br><span class="line">job, avg(sal) as avgsal</span><br><span class="line">from</span><br><span class="line">emp</span><br><span class="line">where</span><br><span class="line">job &lt;&gt; &#x27;MANAGER&#x27;</span><br><span class="line">group by</span><br><span class="line">job</span><br><span class="line">having</span><br><span class="line">avg(sal) &gt; 1500</span><br><span class="line">order by</span><br><span class="line">avgsal desc;</span><br><span class="line">+-----------+-------------+</span><br><span class="line">| job       | avgsal      |</span><br><span class="line">+-----------+-------------+</span><br><span class="line">| PRESIDENT | 5000.000000 |</span><br><span class="line">| ANALYST   | 3000.000000 |</span><br><span class="line">+-----------+-------------+</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux学习</title>
      <link href="/post/deb5175a.html"/>
      <url>/post/deb5175a.html</url>
      
        <content type="html"><![CDATA[<p>本文来源：<strong><a href="https://segmentfault.com/a/1190000021950993">https://segmentfault.com/a/1190000021950993</a></strong>，有部分修改</p><p>视频推荐：**<a href="https://www.bilibili.com/video/BV1pE411C7ho?p=1&vd_source=63053d55e8751329afed633909c51f3f">0101-Linux操作系统零基础学员学习方法_哔哩哔哩_bilibili</a>**</p><h2 id="1-命令的基本格式"><a href="#1-命令的基本格式" class="headerlink" title="1 命令的基本格式"></a>1 命令的基本格式</h2><h3 id="1-1-命令的提示符"><a href="#1-1-命令的提示符" class="headerlink" title="1.1 命令的提示符"></a>1.1 命令的提示符</h3><p><strong>[root@localhost ~]#</strong></p><ul><li><code>[]</code>：这是提示符的分隔符号，没有特殊含义。</li><li><code>root</code>：显示的是当前的登录用户， 目前使用的是root用户登录。</li><li><code>@</code>：分隔符号，没有特殊含义。</li><li><code>localhost</code>：当前系统的简写主机名（完整主机名是 localhost.localdomain）。</li><li><code>~</code>：代表用户当前所在的目录，此例中用户当前所在的目录是家目录。</li><li><code>#</code>：命令提示符。超级用户是#，普通用户是$</li></ul><h3 id="1-2-命令的基本格式"><a href="#1-2-命令的基本格式" class="headerlink" title="1.2 命令的基本格式"></a>1.2 命令的基本格式</h3><p><strong>[root@localhost ~]# 命令 [选项] [参数]</strong></p><ul><li><code>选项</code>：是用于调整命令的功能的</li><li><code>参数</code>：是命令的操作对象</li></ul><h2 id="2-目录操作命令"><a href="#2-目录操作命令" class="headerlink" title="2 目录操作命令"></a>2 目录操作命令</h2><h3 id="2-1-ls命令"><a href="#2-1-ls命令" class="headerlink" title="2.1 ls命令"></a>2.1 ls命令</h3><p>ls 是最常见的目录操作命令，主要作用是显示目录下的内容</p><ul><li>命令名称：ls</li><li>英文原意：list</li><li>所在路径：&#x2F;bin&#x2F;ls</li><li>执行权限：所有用户</li><li>功能描述：显示目录下的内容</li></ul><p>命令格式：<code>ls [选项] [目录名]</code></p><ul><li>选项<ul><li>-a: 显示所有文件</li><li>–color&#x3D;when: 支持颜色输出，when的值默认是<em>always</em>(总显示颜色)，也可以是<em>never</em>(从不显示颜色)和<em>auto</em>(自动)</li><li>-d: 显示目录信息，而不是目录下的文件</li><li>-h: 人性化显示，按照我们习惯的单位显示文件大小</li><li>-i: 显示文件的节点号</li><li>-l: 长格式显示</li></ul></li></ul><p>示例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ls -l</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">权限 引用计数 所有者 所属组 大小 文件修改时间 文件名</span></span><br><span class="line">-rw-------. 1 root root  1446 12月 19 16:15 anaconda-ks.cfg</span><br></pre></td></tr></table></figure><blockquote><p>“-l” 选项用于显示文件的详细信息，那么“-l”选项显示的这 7 列分别是什么含义？<br>第一列：权限。<br>第二列：引用计数。文件的引用计数代表该文件的硬链接个数，而目录的引用计数代表该目录<br>有多少个一级子目录。<br>第三列：所有者，也就是这个文件属于哪个用户。默认所有者是文件的建立用户<br>第四列：所属组。默认所属组是文件建立用户的有效组，一般情况下就是建立用户的所在组。<br>第五列：大小。默认单位是字节。<br>第六列：文件修改时间。文件状态修改时间或文件数据修改时间都会更改这个时间，注意这个<br>时间不是文件的创建时间。<br>第七列：文件名。</p></blockquote><p>ls通配符学习</p><p><code>*</code>代表一个或多个字符</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls *.txt #查找后缀为txt的文件</span><br><span class="line">ls 1* #查找以1开头的文件</span><br><span class="line">ls 1*.txt #查找以1开头,后缀为txt的文件</span><br></pre></td></tr></table></figure><p><code>?</code>代表一个字符</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls ???.txt #查找有3个字符且后缀为txt的文件</span><br></pre></td></tr></table></figure><p><code>[]</code>只要包含其中一项都罗列出来，里面可以是[1-4]、[ab23]、[1234]</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls [1234]2.txt #查找开头为1234且后面为2.txt的文件</span><br><span class="line">12.txt 32.txt #查出来两项</span><br></pre></td></tr></table></figure><h3 id="2-2-cd命令"><a href="#2-2-cd命令" class="headerlink" title="2.2 cd命令"></a>2.2 cd命令</h3><p>cd是切换所在<strong>目录</strong>的命令，基本信息如下：</p><ul><li>命令名称：cd</li><li>英文原意：change directory</li><li>所在路径：shell内置命令</li><li>执行权限：所有用户</li><li>功能描述：切换所在目录</li></ul><p>命令格式：<code>cd [-L|-P] [dir]</code></p><ul><li>选项：<ul><li><code>-L</code>:（默认值）如果要切换到的目标目录是一个符号连接，那么切换到符号连接的目录。</li><li><code>-P</code>: 如果要切换到的目标目录是一个符号连接，那么切换到它指向的物理位置目录。</li></ul></li><li>参数:<ul><li>可以是绝对路径(以根目录为参照物)或相对路径(以当前目录为参照物)</li></ul></li></ul><blockquote><p>简化用法<br><code>cd ~</code>: 当前用户的加目录<br><code>cd -</code>：上一次所在目录<br><code>cd .</code>: 当前目录<br><code>cd ..</code>: 上级目录</p></blockquote><h3 id="2-3-pwd命令"><a href="#2-3-pwd命令" class="headerlink" title="2.3 pwd命令"></a>2.3 pwd命令</h3><p>pwd命令是查询所在目录的命令，基本信息如下：</p><ul><li>命令名称：pwd</li><li>英文原意：print name of current&#x2F;working directory</li><li>所在路径：&#x2F;bin&#x2F;pwd</li><li>执行权限：所有用户</li><li>功能描述：查询当前所在目录</li></ul><h3 id="2-4-mkdir命令"><a href="#2-4-mkdir命令" class="headerlink" title="2.4 mkdir命令"></a>2.4 mkdir命令</h3><ul><li>命令名称：mkdir</li><li>英文原意：make directories</li><li>所在路径：&#x2F;bin&#x2F;mkdir</li><li>执行权限：所有用户</li><li>功能描述：创建空目录</li></ul><p>命令格式：mkdir [选项] 目录名</p><ul><li>选项：<ul><li><code>-p</code>: 递归建立所需目录</li><li><code>-m 权限</code>：建立目录的同时设置目录的权限</li></ul></li></ul><h3 id="2-5-rmdir命令"><a href="#2-5-rmdir命令" class="headerlink" title="2.5 rmdir命令"></a>2.5 rmdir命令</h3><p>rmdir命令删除空目录，基本信息如下：</p><ul><li>命令名称：rmdir</li><li>英文原意：remove empty directories</li><li>所在路径：&#x2F;bin&#x2F;rmdir</li><li>执行权限：所有用户</li><li>功能描述：删除空目录</li></ul><p>命令格式：<code>rmdir [选项] 目录名</code></p><ul><li>选项：<ul><li><code>-p</code>: 递归删除目录</li></ul></li></ul><blockquote><p><code>rmdir</code>命令的作用十分有限，只能删除空目录，一旦目录中有内容就会报错。所以一般不论删除的是文件还是目录，都会使用<code>rm</code>命令</p></blockquote><h2 id="3-文件操作命令"><a href="#3-文件操作命令" class="headerlink" title="3 文件操作命令"></a>3 文件操作命令</h2><h3 id="3-1-touch命令"><a href="#3-1-touch命令" class="headerlink" title="3.1 touch命令"></a>3.1 touch命令</h3><p>touch命令创建空文件或修改文件时间，基本信息如下：</p><ul><li>命令名称：touch</li><li>英文原意：change file timestamps</li><li>所在路径：&#x2F;bin&#x2F;touch</li><li>执行权限：所有用户</li><li>功能描述：创建文件或改文件时间戳</li></ul><p>命令格式：<code>touch [选项] 文件名</code></p><ul><li>选项：<ul><li><code>-a</code>：或–time&#x3D;atime或–time&#x3D;access或–time&#x3D;use 更改存取时间为当前时间(access time)</li><li><code>-m</code>：或–time&#x3D;mtime或–time&#x3D;modify 更该变动时间为当前时间(modify time)</li><li><code>-t 日期时间</code>: 使用指定的日期时间(格式：[[CC]YY]MMDDhhmm[.ss])，而非现在的时间</li><li><code>-r 参考文件或目录</code>: 把指定文件或目录的日期时间统统设成参考文件或目录的日期时间</li></ul></li></ul><h3 id="3-2-cat命令"><a href="#3-2-cat命令" class="headerlink" title="3.2 cat命令"></a>3.2 cat命令</h3><p>cat命令用来查看文件内容，进本信息如下：</p><ul><li>命令名称：cat</li><li>英文原意：concatenate files and print on the standard output</li><li>所在路径：&#x2F;bin&#x2F;cat</li><li>执行权限：所有用户</li><li>功能描述：合并文件并打印输出到标准输出</li></ul><p>命令格式：<code>cat [选项] 文件名</code></p><ul><li>选项：<ul><li><code>-E</code>: 列出每行结尾的回车符$</li><li><code>-n</code>: 显示行号</li><li><code>-T</code>: 把Tab键用^I显示出来</li><li><code>-v</code>: 列出特殊字符</li><li><code>-A</code>: 相当于-vET选项的整合，用于列出所有隐藏符号</li></ul></li></ul><h3 id="3-3-more-命令"><a href="#3-3-more-命令" class="headerlink" title="3.3 more 命令"></a>3.3 more 命令</h3><p>more是分屏显示文件的命令，基本信息如下：</p><ul><li>命令名称：more</li><li>英文原意：file perusal filter for crt viewin</li><li>所在路径：&#x2F;bin&#x2F;more</li><li>执行权限：所有用户</li><li>功能描述：分屏显示文件内容</li></ul><p>命令格式：<code>more [选项] 文件名</code></p><ul><li>选项：<ul><li><code>-d</code>：显示“[press space to continue,’q’ to quit.]”和“[Press ‘h’ for instructions]”；</li><li><code>-c</code>：不进行滚屏操作。每次刷新这个屏幕</li><li><code>-s</code>：将多个空行压缩成一行显示</li><li><code>-u</code>：禁止下划线</li><li><code>-数字</code>：指定每屏显示的行数</li><li><code>+数字</code>：从指定数字的行开始显示</li></ul></li></ul><blockquote><p>more 命令比较简单，一般不用什么选项，命令会打开一个交互界面，可以识别一些交互命令。常用的交互命令如下：</p><ul><li>空格键：向下翻页</li><li>B键: 向上翻页</li><li>&#x2F;字符串：搜索指定的字符串</li><li>q: 退出</li></ul></blockquote><h3 id="3-4-less-命令"><a href="#3-4-less-命令" class="headerlink" title="3.4 less 命令"></a>3.4 less 命令</h3><p>less命令和more命令类似，只是more命令是分屏显示，而less是分行显示命名，less命令允许用户向前(PageUp键)或向后(PageDown键)浏览文件，基本信息如下：</p><ul><li>命令名称：less</li><li>英文原意：opposite of more</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;more</li><li>执行权限：所有用户</li><li>功能描述：分行显示文件内容</li></ul><p>命令格式：<code>less [选项] 文件名</code></p><ul><li><code>-e</code>：文件内容显示完毕后，自动退出</li><li><code>-f</code>：强制显示文件</li><li><code>-g</code>：不加亮显示搜索到的所有关键词，仅显示当前显示的关键字，以提高显示速度</li><li><code>-l</code>：搜索时忽略大小写的差异</li><li><code>-N</code>：每一行行首显示行号</li><li><code>-s</code>：将连续多个空行压缩成一行显示</li><li><code>-S</code>：在单行显示较长的内容，而不换行显示</li><li><code>-x数字</code>：将TAB字符显示为指定个数的空格字符</li></ul><h3 id="3-5-head-命令"><a href="#3-5-head-命令" class="headerlink" title="3.5 head 命令"></a>3.5 head 命令</h3><p>head 命令是用来显示文件开头内容的命令，基本信息如下：</p><ul><li>命令名称：head</li><li>英文原意：output the first part files</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;head</li><li>执行权限：所有用户</li><li>功能描述：显示文件开头的内容</li></ul><p>命令格式：<code>head [选项] 文件名</code></p><ul><li><code>-n 行数</code>：从文件开头开始，显示指定行数</li><li><code>-v</code>：显示文件名</li></ul><h3 id="3-6-tail-命令"><a href="#3-6-tail-命令" class="headerlink" title="3.6 tail 命令"></a>3.6 tail 命令</h3><p>tail 命令是用来显示文件结尾内容的命令</p><ul><li>命令名称：tail</li><li>英文原意：output the last part files</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;tail</li><li>执行权限：所有用户</li><li>功能描述：显示文件结尾的内容</li></ul><p>命令格式：<code>tail [选项] 文件名</code></p><ul><li><code>-n 行数</code>：从文件结尾开始，显示指定行数</li><li><code>-v</code>：显示文件名</li><li><code>-f</code>: 监听文件新增内容</li></ul><h3 id="3-7-ln-命令"><a href="#3-7-ln-命令" class="headerlink" title="3.7 ln 命令"></a>3.7 ln 命令</h3><p>ln命令用来为文件创件链接，连接类型分为硬连接和符号连接(软链接)两种，基本信息如下：</p><ul><li>命令名称：ln</li><li>英文原意：make links between file</li><li>所在路径：&#x2F;bin&#x2F;tail</li><li>执行权限：所有用户</li><li>功能描述：在文件之间建立链接</li></ul><p>命令格式：<code>ln [选项] 源文件 [目标文件]</code></p><ul><li>选项：<ul><li>-s: 建立软链接文件。如果不加’-s’选项，则建立硬链接文件</li><li>-f: 强行删除已存在的链接文件。如果链接文件已存在，则删除目标文件后再建立链接文件</li></ul></li><li><strong>源文件</strong>：指定链接的源文件。如果使用<code>-s</code>选项创建软链接，则“源文件”可以是<strong>文件或者目录</strong>，创建硬链接时，则“源文件”参数只能是<strong>文件</strong>。（源文件最好用绝对路径名，这样可以在任何工作目录下进行符号链接，而当源文件用相对路径时，如果当前的工作路径与要创建的符号链接文件所在路径不同，就不能进行链接）</li><li><strong>目标文件</strong>：指定源文件的目标链接文件，省略则在当前目录下新建与源文件名称相同的链接文件</li></ul><blockquote><p>硬链接和源文件实际上是同一个文件，不会创建新的文件（类似于Java中，一个对象有多个引用）；而软链接会创建一个新文件来保存源文件的路径，从而间接读取或修改源文件内容</p><p>硬链接与软链接的特征</p><p>硬链接特征</p><p>：</p><p>1.源文件和硬链接文件拥有相同的Indoe和Block</p><p>2.修改任意一个文件，另一个都改变</p><p>3.删除任意一个文件，另一个都能使用</p><p>4.硬链接建立或删除，原文件连接数相应加一或减一</p><p>5.硬链接不能链接目录</p><p>6.硬链接不能跨分区</p><p>7.硬链接标记不清，很难确认硬链接文件位置，不建议使用</p><p><strong>软链接特征</strong>：<br>1.软链接和源文件拥有不同的Inode和Block<br>2.两个文件修改任意一个，另一个都改变<br>3.删除软链接，源文件不受影响；删除源文件，软链接不能使用<br>4.软链接建立或删除，原文件链接数不变<br>5.软链接可以链接目录<br>6.软链接可以跨分区<br>7.软链接特征明显，建议使用软链接<br>8.软链接没有实际数据，只是保存源文件的Inode，不论源文件多大，软链接大小不变<br>9.软链接的权限是最大权限<code>lrwxrwxrwx.</code>，但是由于没有实际数据，最终访问时需要参考源文件权限</p></blockquote><h2 id="4-文件和目录都能操作的命令"><a href="#4-文件和目录都能操作的命令" class="headerlink" title="4 文件和目录都能操作的命令"></a>4 文件和目录都能操作的命令</h2><h3 id="4-1-rm-命令"><a href="#4-1-rm-命令" class="headerlink" title="4.1 rm 命令"></a>4.1 rm 命令</h3><p>rm是最强大的删除命令，不仅可以删除文件，也可以删除目录，基本信息如下：</p><ul><li>命令名称：rm</li><li>英文原意：remove files or directories</li><li>所在路径：&#x2F;bin&#x2F;rm</li><li>执行权限：所有用户</li><li>功能描述：删除文件或目录</li></ul><p>命令格式：<code>rm [选项] 文件或目录</code></p><ul><li>选项：<ul><li><code>-f</code>: 强制删除</li><li><code>-i</code>: 交互删除，在删除之前会询问用户</li><li><code>-r</code>: 递归删除，可以删除目录</li></ul></li></ul><h3 id="4-2-cp-命令"><a href="#4-2-cp-命令" class="headerlink" title="4.2 cp 命令"></a>4.2 cp 命令</h3><p>cp命令用于复制文件或目录，基本信息入下：</p><ul><li>命令名称：cp</li><li>英文原意：copy files and directories</li><li>所在路径：&#x2F;bin&#x2F;cp</li><li>执行权限：所有用户</li><li>功能描述：复制文件或目录</li></ul><p>命令格式：<code>cp [选项] 源文件 目标文件</code></p><ul><li>选项：<ul><li><code>-d</code>: 如果文件为软链接(对硬链接无效)，则复制出的目标文件也为软链接</li><li><code>-i</code>: 询问，如果目标文件已经存在，则会询问是否覆盖</li><li><code>-p</code>: 复制后目标文件保留源文件的属性(包括所有者、所有组、权限和时间)</li><li><code>-r</code>: 递归复制，用于复制目录</li><li><code>-a</code>: 相当于<code>-dpr</code>选项的集合</li></ul></li></ul><h3 id="4-3-mv-命令"><a href="#4-3-mv-命令" class="headerlink" title="4.3 mv 命令"></a>4.3 mv 命令</h3><p>mv命令用来剪贴文件或目录，基本信息如下：</p><ul><li>命令名称：mv</li><li>英文原意：move(rename) files</li><li>所在路径：&#x2F;bin&#x2F;mv</li><li>执行权限：所有用户</li><li>功能描述：移动文件或目录</li></ul><p>命令格式：<code>cp [选项] 源文件 目标文件</code></p><ul><li>选项：<ul><li><code>-f</code>: 强制覆盖，如果目标文件已经存在，则不询问直接强制覆盖</li><li><code>-i</code>: 交互模式，如果目标文件已经存在，则询问用户是否覆盖（默认选项）</li><li><code>-v</code>：显示详细信息</li></ul></li></ul><h3 id="4-4-stat命令"><a href="#4-4-stat命令" class="headerlink" title="4.4 stat命令"></a>4.4 stat命令</h3><p>stat命令是查看文件详细的命令，基本信息如下：</p><ul><li>命令名称：stat</li><li>英文原意：display file or file system status</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;stat</li><li>执行权限：所有用户</li><li>功能描述：显示文件或文件系统的详细信息</li></ul><p>命令格式：<code>stat [选项] 文件名</code></p><ul><li>选项：<ul><li><code>-f</code>：显示文件系统状态而非文件状态</li><li><code>-t</code>：以简洁方式输出信息</li></ul></li></ul><h2 id="5-基本权限管理"><a href="#5-基本权限管理" class="headerlink" title="5 基本权限管理"></a>5 基本权限管理</h2><h3 id="5-1-权限介绍"><a href="#5-1-权限介绍" class="headerlink" title="5.1 权限介绍"></a>5.1 权限介绍</h3><p>使用ls命令时，长格式显示的第一列就是文件的权限，例如：</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# <span class="keyword">ls</span> -l install.<span class="keyword">log</span></span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">28425</span> <span class="number">11</span>月 <span class="number">30</span> <span class="number">18</span>:<span class="number">50</span> install.<span class="keyword">log</span></span><br></pre></td></tr></table></figure><p>第一列的权限位(<code>-rw-r--r--.</code>)如果不计最后的 “<strong>.</strong>“ (这个点代表受SELinux安全上下文保护，这里暂时忽略不做介绍)，则共10位，这10位权限位的含义如下图所示：<br><img src="https://segmentfault.com/img/bVbDGxt" alt="image.png"></p><ul><li><strong>第1位</strong>：代表文件类型。Linux不像Windows使用扩展名表示文件类型，而是使用权限位的第一位表示文件类型。虽然Linux文件的种类不像Windows中那么多，但是分类也不少，详细情况可以使用“<code>info ls</code>” 命令查看。这里列出一些常见的文件类型：<ul><li><code>-</code>: 普通文件</li><li><code>d</code>: 目录文件。Linux中一切皆文件，所以目录也是文件的一种</li><li><code>l</code>: 软链接文件</li><li><code>b</code>: 块设备文件。这是一种特殊设备文件，存储设备都是这种文件，如分区文件&#x2F;dev&#x2F;sda1就是这种文件</li><li><code>c</code>: 字符设备文件。这也是特殊设备文件，输入设备一般都是这种文件，如鼠标、键盘等</li><li><code>p</code>: 管道符文件。这是一种非常少见的特殊设备文件。</li><li><code>s</code>: 套接字文件。这也是一种特殊设备文件，一些服务支持socket访问就会产生这样的文件</li></ul></li><li><strong>第2~4位</strong>：代表文件所有者的权限<ul><li><code>r</code>: 代表read，是读取权限</li><li><code>w</code>： 代表write，是写权限</li><li><code>x</code>: 代表execute，是执行权限</li></ul></li><li><strong>第5~7位</strong>：代表文件所属组的权限，同样拥有“rwx”权限</li><li><strong>第8~10位</strong>：代表文件其他人的权限，同样拥有“rwx”权限</li></ul><p><strong>权限含义的解释：</strong><br>读、写、执行权限对文件和目录的作用是不同的。</p><ul><li>权限对文件的作用<ul><li>读(r)：对文件有读权限，代表可以读取文件中的数据。如果把权限对应到命令上，那么一旦对文件有读权限，就可以对文件执行<code>cat</code>、<code>more</code>、<code>less</code>、<code>head</code>、<code>tail</code>等文件查看命令</li><li>写(w)：对文件有写权限，代表可以修改文件中的数据。如果把权限对应到命令上，那么一旦对文件有写权限，就可以对文件执行<code>vim</code>、<code>echo</code>等修改文件数据的命令。<strong>注意：对文件有写权限，是不能删除文件本身的，只能修改文件中的数据，如果想要删除文件，则需要对文件的上级目录拥有写权限</strong>。</li><li>执行(x)：对文件有执行权限，代表文件可以运行。在Linux中，只要文件有执行权限，这个文件就是执行文件了，只是这个文件到底能不能正确执行，不仅需要看执行权限，还要看文件的代码是不是正确的语言代码。对文件来说，执行权限是最高权限</li></ul></li><li>权限对目录的作用<ul><li>读(r)：对目录有读权限，代表可以查看目录下的内容，也就是可以查看目录下有哪些文件和子目录。如果包权限对应到命令上，那么一旦对目录拥有了读权限，就可以在目录下执行<code>ls</code>命令查看目录下的内容了</li><li>写(w)：对目录有写权限，代表可以修改目录下的数据，也就是可以在目录中新建、删除、复制、剪贴子文件或子目录。如果把权限对应到命令上，那么一旦对目录拥有了写权限，就可以在目录下执行<code>touch</code>、<code>rm</code>、<code>cp</code>、<code>mv</code>等命令。对目录来说，写权限是最高权限</li><li>执行(x)：目录是不能运行的，那么对目录拥有执行权限，代表可以进入目录。如果把权限对应到命令上，那么一旦对目录拥有了执行权限，就可以对目录执行<code>cd</code>命令进入目录</li></ul></li></ul><h3 id="5-2-chmod-命令"><a href="#5-2-chmod-命令" class="headerlink" title="5.2 chmod 命令"></a>5.2 chmod 命令</h3><p>chmod用来修改文件的权限，基本信息如下：</p><ul><li>命令名称：chmod</li><li>英文原意：change file mode bits</li><li>所在路径：&#x2F;bin&#x2F;chmod</li><li>执行权限：所有用户</li><li>功能描述：修改文件的权限模式</li></ul><p>命令格式：<code>chmod [选项] 权限模式 文件或目录</code></p><ul><li>选项：<ul><li><code>-R</code>: 递归设置权限，也就是给予目录中的所有文件设定权限</li><li><code>--reference=RFILE</code>：使用参考文件或参考目录RFILE的权限来设置目标文件或目录的权限。</li></ul></li></ul><blockquote><p>chmod命令的<strong>权限模式</strong>分为<strong>符号组合</strong>和<strong>八进制数组合</strong><br>符号组合的格式是<code>[ugoa][[+-=][permission]]</code>，也就是<code>[用户身份][[赋予方式][权限]]</code>的格式。</p><ul><li>用户身份<ul><li><code>u</code>：代表所有者(user)</li><li><code>g</code>：代表所属组(group)</li><li><code>o</code>：代表其他人(other)</li><li><code>a</code>：代表全部身份(all)</li></ul></li><li>赋予方式<ul><li><code>+</code>：加入权限</li><li><code>-</code>：减去权限</li><li><code>=</code>：设置权限</li></ul></li><li>权限<ul><li><code>r</code>: 读取权限(read)</li><li><code>w</code>: 写权限(write)</li><li><code>x</code>: 执行权限(execute)</li></ul></li></ul><p>八进制数组合的格式是<code>[0-7][0-7][0-7]</code>三位数字组成(每一位数字都是权限之和)，第一位是所有者权限，第二位是所属组权限，第三位其他人权限</p><ul><li><code>r</code>读取权限对应的数字是<code>4</code></li><li><code>w</code>写权限对应的数字是<code>2</code></li><li><code>x</code>执行权限对应的数字是<code>1</code></li><li>例如读写权限<code>rw</code>八进制数表示 <code>6</code></li></ul></blockquote><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加组用户的写权限。</span></span><br><span class="line"><span class="built_in">chmod</span> g+w ./test.log </span><br><span class="line"><span class="comment"># 删除其他用户的所有权限。  </span></span><br><span class="line"><span class="built_in">chmod</span> o= ./test.log </span><br><span class="line"><span class="comment"># 使得所有用户都没有写权限。  </span></span><br><span class="line"><span class="built_in">chmod</span> a-w ./test.log </span><br><span class="line"><span class="comment"># 当前用户具有所有权限，组用户有读写权限，其他用户只有读权限。  </span></span><br><span class="line"><span class="built_in">chmod</span> u=rwx, g=rw, o=r ./test.log (等价的八进制数表示:<span class="built_in">chmod</span> 754 ./test.log )   </span><br><span class="line"><span class="comment"># 将目录以及目录下的文件都设置为所有用户拥有读写权限。注意，使用&#x27;-R&#x27;选项一定要保留当前用户的执行和读取权限，否则会报错！  </span></span><br><span class="line"><span class="built_in">chmod</span> -R a=rw ./testdir/ </span><br><span class="line"><span class="comment"># 根据其他文件的权限设置文件权限。  </span></span><br><span class="line"><span class="built_in">chmod</span> --reference=./1.<span class="built_in">log</span> ./test.log</span><br></pre></td></tr></table></figure><h3 id="5-3-chown-命令"><a href="#5-3-chown-命令" class="headerlink" title="5.3 chown 命令"></a>5.3 chown 命令</h3><p>chown 命令用来修改文件和目录的所有者和所属组，基本信息如下：</p><ul><li>命令名称：chown</li><li>英文原意：change file owner and group</li><li>所在路径：&#x2F;bin&#x2F;chown</li><li>执行权限：所有用户</li><li>功能描述：修改文件和目录的所有者和所属组</li></ul><p>命令格式：<code>chown [选项] 所有者[:所属组] 文件或目录</code></p><ul><li>选项：<ul><li><code>-R</code>：递归设置权限，也就是给予子目录的所有文件设置权限</li></ul></li><li>当省略 “:所属组” ，仅改变文件所有者</li></ul><blockquote><p>注意：普通用户不能修改文件的所有者，哪怕自己是这个文件的所有者也不行。普通用户可以修改所有者是自己的文件权限。</p></blockquote><h3 id="5-4-umask-命令"><a href="#5-4-umask-命令" class="headerlink" title="5.4 umask 命令"></a>5.4 umask 命令</h3><p>umask命令用来显示或设置创建文件或目录的权限掩码。</p><p>我们需要先了解一下新建文件和目录的默认最大权限，对于文件来讲，新建文件的默认最大权限是<code>666</code>，没有执行权限，只是因为执行权限对文件来讲比较危险，不能再新建文件的时候默认赋予，而必须通过用户手工赋予；对于目录来讲，新建目录的默认最大权限是<code>777</code>，这是因为对目录而言，执行权限仅仅代表进入目录，所以即使新建目录时直接默认赋予也没有什么危险。</p><p>按照官方的标准算法，<code>umask</code>默认权限需要使用二进制进行逻辑与和逻辑非联合运算才可以得到正确的新建文件和目录的默认权限，这种方法既不好计算也不好理解，不推荐。我们这里按照权限字母来讲解<code>umask</code>权限的计算方。我们就按照默认的<code>umask</code>值是<code>0022</code>(等效于<code>022</code>)分别来计算一下新建文件和目录的默认权限，</p><ul><li>文件的默认权限最大只能是<code>666</code>，而<code>umask</code>的值是<code>022</code>，则 <code>rw-rw-rw-</code> 减去 <code>----w--w-</code>等于<code>rw-r--r--</code>，所以新建文件的默认权限是<code>rw-r--r--</code></li><li>目录的默认权限最大是<code>777</code>，而<code>umask</code>的值是<code>022</code>，则 <code>rwxrwxrwx</code> 减去 <code>----w--w-</code>等于<code>rwxr-xr-x</code>，所以新建目录的默认权限是<code>rwxr-xr-x</code></li><li>同理，如果<code>umask</code>的值是<code>033</code>，新建文件的默认权限为 <code>rw-rw-rw-</code> 减去 <code>----wx-wx</code>等于<code>rw-r--r--</code></li></ul><p>命令格式：<code>umask [选项] [模式]</code></p><ul><li>选项：<ul><li><code>-p</code>：输出的权限掩码可直接作为指令来执行</li><li><code>-S</code>：以符号组合的方式输出权限掩码，不使用该选项时以八进制数的形式输出</li></ul></li></ul><p>示例：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 以八进制数的形式输出权限掩码</span></span><br><span class="line">[root<span class="symbol">@localhost</span> tmp]<span class="meta"># umask</span></span><br><span class="line"><span class="number">0022</span></span><br><span class="line"><span class="meta"># 以八进制数的形式输出权限掩码，并作为指令来执行 </span></span><br><span class="line">[root<span class="symbol">@localhost</span> tmp]<span class="meta"># umask -p</span></span><br><span class="line">umask <span class="number">0022</span></span><br><span class="line"><span class="meta"># 以符号组合的方式输出权限掩码。</span></span><br><span class="line">[root<span class="symbol">@localhost</span> tmp]<span class="meta"># umask -S</span></span><br><span class="line">u=rwx,g=rx,o=rx</span><br><span class="line"></span><br><span class="line"><span class="meta">#上条命令以符号组合的方式输出权限掩码，输出的结果u=rwx,g=rx,o=rx转化为八进制数等于0755，</span></span><br><span class="line"><span class="meta">#用八进制数来设置同样的权限，umask需要额外的执行减法<span class="string">&quot;0777 - 0755&quot;</span>即0022</span></span><br><span class="line">[root<span class="symbol">@localhost</span> tmp]<span class="meta"># umask 0022</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># 为组用户添加写权限</span></span><br><span class="line">[root<span class="symbol">@localhost</span> tmp]<span class="meta"># umask g+w</span></span><br><span class="line"><span class="meta"># 删除其他用户的写、执行权限</span></span><br><span class="line">[root<span class="symbol">@localhost</span> tmp]<span class="meta"># umask o-wx</span></span><br><span class="line"><span class="meta"># 赋值全部用户所有权限，等价于umask u=rwx,g=rwx,o=rwx</span></span><br><span class="line">[root<span class="symbol">@localhost</span> tmp]<span class="meta"># umask a=rwx</span></span><br><span class="line"><span class="meta">#清除其他用户的读、写、执行权限</span></span><br><span class="line">[root<span class="symbol">@localhost</span> tmp]<span class="meta"># umask o=</span></span><br></pre></td></tr></table></figure><h2 id="6-帮助命令"><a href="#6-帮助命令" class="headerlink" title="6 帮助命令"></a>6 帮助命令</h2><h3 id="6-1-man-命令"><a href="#6-1-man-命令" class="headerlink" title="6.1 man 命令"></a>6.1 man 命令</h3><p>man命令是最常见的帮助命令，也是Linux最主要的帮助命令，基本信息如下：</p><ul><li>命令名称：man</li><li>英文原意：format and display the on-line manual pages</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;chown</li><li>执行权限：所有用户</li><li>功能描述：显示连机帮助手册</li></ul><p>命令格式：<code>man [选项] [章节] 命令</code></p><ul><li>选项：<ul><li>-f: 查看命令有哪些章节的帮助和简短描述信息，等价于<code>whatis</code>指令</li><li>-k: 查看和命令相关的所有帮助</li></ul></li></ul><p><code>man</code>命令交互快捷键：</p><ul><li><code>上箭头</code>：向上移动一行</li><li><code>下箭头</code>：向下移动一行</li><li><code>PgUP</code>：向上翻一页</li><li><code>PgDn</code>：向下翻一页</li><li><code>g</code>：移动到第一页</li><li><code>G</code>：移动到最后一页</li><li><code>q</code>：退出</li><li><code>/字符串</code>：从当前向下搜索字符串</li><li><code>?字符串</code>：从当前向上搜索字符串</li><li><code>n</code>：当搜索字符串时，可以用n键找到下一个字符串</li><li><code>N</code>：当搜索字符串时，使用N键反向查询字符串。也就是说，如果使用“&#x2F;字符串”方式搜索，则N键表示向上搜索字符串；如果使用“?字符串”方式搜索，则N键表示向下搜索字符串</li></ul><p><code>man</code>手册章节：</p><ul><li><code>1</code>： 用户在shell环境可操作的命令或执行文件</li><li><code>2</code>： 系统内核可调用的函数与工具等</li><li><code>3</code>： 一些常用的函数(function)与函数库(library)，大部分为C的函数库(libc)</li><li><code>4</code>： 设备文件说明，通常在&#x2F;dev下的文件</li><li><code>5</code>： 配置文件或某些文件格式</li><li><code>6</code>： 游戏帮助(个人版的Linux中是有游戏的)</li><li><code>7</code>： 惯例与协议等，如Linux文件系统，网络协议，ASCII code等说明</li><li><code>8</code>： 系统管理员可用的管理命令</li><li><code>9</code>： 跟kernel有关的文件</li></ul><p><code>man</code>手册的格式：</p><ul><li><code>NAME</code>: 命令名称及功能简要说明</li><li><code>SYNOPSIS</code>：用法说明，包括可用的选项<ul><li><code>[]</code>：可选内容</li><li><code>&lt;&gt;</code>：必选内容</li><li><code>a|b</code>：二选一</li><li><code>&#123;&#125;</code>：分组</li><li><code>...</code>：同意内容可出现多次</li></ul></li><li><code>DESCRIPTION</code>：命令功能的详细说明，可能包括每一个选项的意义</li><li><code>OPTIONS</code>：说明每一项的意义</li><li><code>EXAMPLES</code>：使用示例</li></ul><p>* <code>FILES</code>：此命令相关的配置文件<br>* <code>AUTHOR</code>：作者<br>* <code>COPYRIGHT</code>：版本信息<br>* <code>REPORTTING BUGS</code>：bug信息        </p><ul><li><code>SEE ALSO</code>：参考其他帮助</li></ul><p>示例：<br>我们输入 <code>man ls</code>，它会在最左上角显示“LS（1）”，在这里，“LS”表示手册名称，而“（1）”表示该手册位于第一节章，同样，我们输 <code>man ifconfig</code> 它会在最左上角显示“IFCONFIG（8）”。也可以这样输入命令：“man [章节号] 手册名称”。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man`是按照手册的章节号的顺序进行搜索的，比如：`man sleep` 只会显示sleep命令的手册，如果想查看库函数sleep，就要输入：`man 3 sleep</span><br></pre></td></tr></table></figure><h3 id="6-2-info-命令"><a href="#6-2-info-命令" class="headerlink" title="6.2 info 命令"></a>6.2 info 命令</h3><p>info 命令的帮助信息是一套完整的资料，每个单独命令的<code>man</code>帮助信息只是这套完整资料的某一个区段(节点)，基本信息如下：</p><ul><li>命令名称：info</li><li>英文原意：info</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;info</li><li>执行权限：所有用户</li><li>功能描述：显示一套完整的帮助信息资料</li></ul><p>命令格式：<code>info [选项] 参数</code></p><ul><li>选项：<ul><li><code>-d</code>：添加包含info格式帮助文档的目录</li><li><code>-f</code>：指定要读取的info格式的帮助文档</li><li><code>-n</code>：指定首先访问的info帮助文件的节点</li><li><code>-o</code>：输出被选择的节点内容到指定文件</li></ul></li><li>参数：指定需要获得帮助的主题，可以是指令、函数以及配置文件</li></ul><p><code>info</code>命令交互快捷键</p><ul><li><code>上箭头</code>：向上移动一行</li><li><code>下箭头</code>：向下移动一行</li><li><code>PgUP</code>：向上翻一页</li><li><code>PgDn</code>：向下翻一页</li><li><code>Tab</code>：在有“*”符号的节点间切换</li><li><code>回车</code>：进入有“*” 符号的子页面，查看详细帮助信息</li><li><code>u</code>：进入上一层信息(回车是进入下一层信息)</li><li><code>q</code>：退出info帮助信息</li><li><code>n</code>：进入下一小节信息</li><li><code>p</code>：进入上一下节信息</li><li><code>?</code>：查看帮助信息</li></ul><h3 id="6-3-help-命令"><a href="#6-3-help-命令" class="headerlink" title="6.3 help 命令"></a>6.3 help 命令</h3><p>help 命令只能获取shell内置命令的帮助，基本信息如下：</p><ul><li>命令名称：help</li><li>英文原意：help</li><li>所在路径：shell 内置命令</li><li>执行权限：所有用户</li><li>功能描述：显示shell内置命令的帮助。可以使用shell内置命令<code>type</code>来区分内置命令与外部命令，对于外部命令的帮助信息只能使用<code>man</code>或者<code>info</code>命令查看</li></ul><p>命令格式：<code>help [选项] 内置命令</code></p><ul><li>选项：<ul><li><code>-d</code>：显示内建命令的简要描述。</li><li><code>-m</code>：按照man手册的格式输出内置命令的帮助信息。</li><li><code>-s</code>：仅输出内建命令的命令格式。</li></ul></li></ul><p>示例：</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 以<span class="keyword">man</span>手册的格式查看内置命令<span class="keyword">type</span>的帮助信息</span><br><span class="line">[root@localhost ~]# <span class="keyword">help</span> -<span class="keyword">m</span> <span class="keyword">type</span></span><br><span class="line">NAME</span><br><span class="line">    <span class="keyword">type</span> - <span class="keyword">Display</span> information <span class="keyword">about</span> command <span class="keyword">type</span>.</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">    <span class="keyword">type</span> [-afptP] name [name ...]</span><br><span class="line"> (省略。。。)</span><br><span class="line"></span><br><span class="line"># 查看<span class="keyword">ls</span>、<span class="keyword">help</span>命令是否是内置命令</span><br><span class="line">[root@localhost ~]# <span class="keyword">type</span> <span class="keyword">ls</span></span><br><span class="line"><span class="keyword">ls</span> is aliased to `<span class="keyword">ls</span> --color=auto&#x27;</span><br><span class="line">[root@localhost ~]# <span class="keyword">type</span> <span class="keyword">help</span></span><br><span class="line"><span class="keyword">help</span> is a <span class="keyword">shell</span> builtin</span><br></pre></td></tr></table></figure><h3 id="6-4-–help-选项"><a href="#6-4-–help-选项" class="headerlink" title="6.4 –help 选项"></a>6.4 –help 选项</h3><p>绝大多数命令都可以使用<code>--help</code>选项来查看帮助，者也是一种获取帮助的方法。例如 <code>ls --help</code>，这种方法非常简单，输出的帮助信息基本上是<code>man</code>命令的信息简要版。</p><h2 id="7-搜索命令"><a href="#7-搜索命令" class="headerlink" title="7 搜索命令"></a>7 搜索命令</h2><h3 id="7-1-whereis-命令"><a href="#7-1-whereis-命令" class="headerlink" title="7.1 whereis 命令"></a>7.1 whereis 命令</h3><p>whereis 是搜索命令的命令，也就是说whereis不能搜索普通文件，而只能搜索系统命令，基本信息如下：</p><ul><li>命令名称：whereis</li><li>英文原意：locate the binary,source,and manual page files for a command</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;whereis</li><li>执行权限：所有用户</li><li>功能描述：查找二进制命令、源文件和帮助文档的路径</li></ul><p>命令格式：<code>whereis [选项] 参数</code></p><ul><li>选项：<ul><li><code>-b</code>：只查找二进制文件</li><li><code>-B 目录</code>：只在设置的目录下查找二进制文件</li><li><code>-m</code>：只查找说明文件</li><li><code>-M 目录</code>：只在设置的目录下查找说明文件</li><li><code>-s</code>：只查找原始代码文件</li><li><code>-S 目录</code>：只在设置的目录下查找原始代码文件</li><li><code>-f</code>：不显示文件名前的路径名称</li></ul></li></ul><h3 id="7-2-which-命令"><a href="#7-2-which-命令" class="headerlink" title="7.2 which 命令"></a>7.2 which 命令</h3><p>which 也是搜索系统命令的命令，和<code>whereis</code>的区别在于，<code>whereis</code>命令可以在查找二进制命令的同时，查找帮助文档的位置，而<code>which</code>命令在查找到二进制命令的同时，如果这个命令有别名，则还可以查到别名命令。基本信息如下：</p><ul><li>命令名称：which</li><li>英文原意：shows the full path of (shell) commands</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;which</li><li>执行权限：所有用户</li><li>功能描述：列出二进制命令路径和别名。<code>which</code>只会在环境变量$PATH设置的目录里查找符合条件的命令</li></ul><p>命令格式：<code>which [选项] 参数</code></p><h3 id="7-3-find-命令"><a href="#7-3-find-命令" class="headerlink" title="7.3 find 命令"></a>7.3 find 命令</h3><p>find命令用来在指定目录下查找文件，基本信息如下：</p><ul><li>命令名称：find</li><li>英文原意：search for files in a directory hierarchy</li><li>所在路径：&#x2F;bin&#x2F;find</li><li>执行权限：所有用户</li><li>功能描述：在指定目录中搜索文件</li></ul><p>命令格式：<code>find [搜索路径] [选项]</code></p><ul><li>搜索路径：省略则默认为当前目录，相当于 “find .”</li><li>选项：<ul><li><code>-name 范本样式</code>：按照文件名称搜索，支持通配符模糊查询</li><li><code>-iname 范本样式</code>：此参数的效果和指定“-name”参数类似，但忽略字符大小写</li><li><code>-inum inode编号</code>：查找符合指定的inode编号的文件或目录</li><li><code>-path 范本样式</code>：查找路径包含范本样式的文件或目录</li><li><code>-regex 范本样式</code>：正则表达式搜索</li><li><code>-iregex 范本样式</code>：同”-regex”，忽略大小写</li><li><code>-size [+|-|=]文件大小[cwbkMG] </code>：查找符合指定的文件大小的文件<ul><li>“+” 的意思是搜索比指定大小还要大的文件；”-“ 的意思是搜索比指定大小还要小的文件；”&#x3D;” 的意思是搜索指定大小的文件，一般不用</li><li>“cwbkMG”是单位，c——字节，w——字(2字节)，b——块(512字节)，k——千字节，M——兆字节，G——吉字节。如果不写单位默认是b</li></ul></li><li><code>-atime [+|-]天数</code>：按照文件最后一次访问时间搜索，单位每天<ul><li>“+”、”-“的含义，例如”5”表示恰好5天前的那一天，”+5”超过5天前的时间，”-5”5天内的时间。(以下按时间搜索选项中”+”、”-“含义相同)</li></ul></li><li><code>-mtime [+|-]天数</code>：按照文件数据最后一次修改时间搜索，单位每天</li><li><code>-ctime [+|-]天数</code>：按照文件元数据(如权限等)最后一次修改时间搜索，单位每天</li><li><code>-amin [+|-]分钟数</code>：按照文件最后一次访问时间搜索，单位每分钟</li><li><code>-mmin [+|-]分钟数</code>：按照文件数据最后一次修改时间搜索，单位每分钟</li><li><code>-cmin [+|-]分钟数</code>：按照文件元数据(如权限等)最后一次修改时间搜索，单位每分钟</li><li><code>-perm [+|-]权限数值</code>：查找符合指定的权限数值的文件或目录。例如，权限数值为”766”表示权限恰好等于766，”-766”表示文件权限必须全部包含766，”+766”表示文件权限包含766任意一个权限</li><li><code>-uid 用户ID</code>：查找所有者是指定用户ID的文件</li><li><code>-user 用户名</code>：查找所有者是指定用户名的文件</li><li><code>-gid 组ID</code>：查找所有组是指定组ID的文件</li><li><code>-group 组名</code>：查找所有组是指定组名的文件</li><li><code>-nouser</code>：查找没有所有者的文件<ul><li>按照所有者和所有组搜索时，”-nouser”选项比较常用，主要用于查找垃圾文件。没有所有者的文件比较少见，那就是外来文件，比如光盘和U盘的文件是由Windows复制的，在Linux中查看就是没有所有者的文件，再比如手工源码包安装的文件也可能没有所有者</li></ul></li><li><code>-type 文件类型</code>：只寻找符合指定的文件类型的文件<ul><li><code>f</code>——普通文件，<code>l</code>——符号连接，<code>d</code>——目录，<code>c</code>——字符设备，<code>b</code>——块设备，<code>s</code>——套接字，<code>p</code>——Fifo</li></ul></li><li><code>-empty</code>：查找文件大小为0的文件</li><li><code>-maxdepth 目录层级数</code>：设置搜索的最大目录层级</li><li><code>-mindepth 目录层级</code>：设置搜索的最小目录层级</li><li><code>-exec 执行指令</code>：把find命令查找结果交由”-exec”调用的命令来处理<ul><li>格式：<code>find [搜索路径] [选项] -exec 命令 &#123;&#125; \;</code>, 其中”{}”代表find命令的查询结果</li></ul></li><li><code>-ok 执行指令</code>：此参数的效果和指定“-exec”类似，但在执行指令之前会先询问用户是否执行</li><li><code>-prune</code>：不寻找字符串作为寻找文件或目录的范本样式</li><li><code>-a</code>：and 逻辑与</li><li><code>-o</code>: or 逻辑或</li><li><code>-not</code>：not 逻辑非</li></ul></li></ul><p>示例：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#==================根据文件名或者正则表达式进行匹配=====================</span></span><br><span class="line"><span class="comment">#列出当前目录及子目录下所有文件和文件夹</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> .</span><br><span class="line"><span class="comment">#在`/home`目录下查找以.txt结尾的文件名</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> /home -name <span class="string">&quot;*.txt&quot;</span></span><br><span class="line"><span class="comment">#同上，但忽略大小写</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> /home -iname <span class="string">&quot;*.txt&quot;</span></span><br><span class="line"><span class="comment">#当前目录及子目录下查找所有以.txt和.pdf结尾的文件</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> . \( -name <span class="string">&quot;*.txt&quot;</span> -o -name <span class="string">&quot;*.pdf&quot;</span> \)</span><br><span class="line">或</span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> . -name <span class="string">&quot;*.txt&quot;</span> -o -name <span class="string">&quot;*.pdf&quot;</span></span><br><span class="line"><span class="comment">#查找路径包含local的文件或者目录</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> /usr/ -path <span class="string">&quot;*local*&quot;</span></span><br><span class="line"><span class="comment">#基于正则表达式匹配文件路径</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> . -regex <span class="string">&quot;.*\(\.txt\|\.pdf\)$&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#=====================借助`-exec`选项与其他命令结合使用==================</span></span><br><span class="line"><span class="comment">#找出当前目录下所有root的文件，并把所有权更改为用户tom</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> .-type f -user root -exec chown tom &#123;&#125; \;</span><br><span class="line"><span class="comment">#找出自己家目录下所有的.txt文件并删除，删除前先询问</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> <span class="variable">$HOME</span>/. -name <span class="string">&quot;*.txt&quot;</span> -ok rm &#123;&#125; \;</span><br><span class="line"><span class="comment">#查找当前目录下所有.txt文件并把他们拼接起来写入到all.txt文件中</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> . -type f -name <span class="string">&quot;*.txt&quot;</span> -exec cat &#123;&#125; \;&gt; all.txt</span><br><span class="line"><span class="comment">#将30天前的.log文件移动到old目录中</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> . -type f -mtime +30 -name <span class="string">&quot;*.log&quot;</span> -exec cp &#123;&#125; old \;</span><br><span class="line"><span class="comment">#找出当前目录下所有.txt文件并以“File:文件名”的形式打印出来</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> . -type f -name <span class="string">&quot;*.txt&quot;</span> -exec printf <span class="string">&quot;File: %s\n&quot;</span> &#123;&#125; \;</span><br><span class="line"></span><br><span class="line"><span class="comment">#========================逻辑运算符==========================</span></span><br><span class="line"><span class="comment">#查找文件大小超过2k并且是普通文件类型的文件</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> . -size +2k -a -type f</span><br><span class="line"><span class="comment">#找出/home下不是以.txt结尾的文件</span></span><br><span class="line">[root@localhost tmp]# <span class="built_in">find</span> . -not -name <span class="string">&quot;*.txt&quot;</span></span><br><span class="line">或</span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> /home ! -name <span class="string">&quot;*.txt&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#======================搜索但跳出指定的目录===================</span></span><br><span class="line"><span class="comment">#查找当前目录或者子目录下所有.txt文件，但是跳过子目录sk</span></span><br><span class="line">[root@localhost ~]# <span class="built_in">find</span> . -path <span class="string">&quot;./sk&quot;</span> -prune -o -name <span class="string">&quot;*.txt&quot;</span></span><br></pre></td></tr></table></figure><h3 id="7-4-locate-命令"><a href="#7-4-locate-命令" class="headerlink" title="7.4 locate 命令"></a>7.4 locate 命令</h3><p>locate命令其实是<code>find -name</code>的另一种写法，但是要比后者快得多，原因在于它不搜索具体目录(<code>find</code> 是去硬盘找)，而是搜索一个数据库<code>/var/lib/mlocate/mlocate.db</code>，这个数据库中含有本地所有文件信息。Linux系统自动创建这个数据库，并且每天自动更新一次，所以使用<code>locate</code>命令查不到最新变动过的文件，为了避免这种情况，可以在使用<code>locate</code>之前，先使用<code>updatedb</code>命令手动更新数据库，若命令权限不够，前面可加上<code>sudo</code>。locate命令基本信息如下：</p><ul><li>命令名称：locate</li><li>英文原意：find files by name</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;locate</li><li>执行权限：所有用户</li><li>功能描述：按照文件名搜索文件</li></ul><p>命令格式：<code>locate [选项] 文件名</code></p><ul><li>选项：<ul><li><code>-d</code>: 指定资料库的路径。默认是&#x2F;var&#x2F;lib&#x2F;mlocate&#x2F;mlocate.db</li><li><code>-n</code>：至多显示n个输出</li></ul></li></ul><p>数据库配置文件(<code>/etc/updatedb.conf</code>)内容说明：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[root@localhost ~]</span><span class="comment"># cat /etc/updatedb.conf</span></span><br><span class="line"><span class="comment">#开启搜索限制，也就是让这个文件生效</span></span><br><span class="line"><span class="attr">PRUNE_BIND_MOUNTS</span> = <span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="comment">#在locate执行搜索时，禁止搜索这些文件类型</span></span><br><span class="line"><span class="attr">PRUNEFS</span> = <span class="string">&quot;9p afs anon_inodefs auto autofs bdev binfmt_misc cgroup cifs coda configfs cpuset debugfs devpts ecryptfs exofs fuse fusectl gfs gfs2 gpfs hugetlbfs inotifyfs iso9660 jffs2 lustre mqueue ncpfs nfs nfs4 nfsd pipefs proc ramfs rootfs rpc_pipefs securityfs selinuxfs sfs sockfs sysfs tmpfs ubifs udf usbfs&quot;</span></span><br><span class="line"><span class="comment">#在locate执行搜索时，禁止搜索这些扩展名的文件</span></span><br><span class="line"><span class="attr">PRUNENAMES</span> = <span class="string">&quot;.git .hg .svn&quot;</span></span><br><span class="line"><span class="comment">##在locate执行搜索时，禁止搜索这些系统目录</span></span><br><span class="line"><span class="attr">PRUNEPATHS</span> = <span class="string">&quot;/afs /media /net /sfs /tmp /udev /var/cache/ccache /var/spool/cups /var/spool/squid /var/tmp&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>locate优缺点：<br><strong>优点</strong>：按照数据库搜索，搜索速度快，消耗资源小<br><strong>缺点</strong>：只能按照文件名来搜索文件，而不能执行更复杂的搜索，比如按照权限、大小、修改时间等</p></blockquote><h3 id="7-5-grep-命令"><a href="#7-5-grep-命令" class="headerlink" title="7.5 grep 命令"></a>7.5 grep 命令</h3><p>grep命令的作用是在文件中提取和匹配符合条件的字符串行，是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。基本信息如下：</p><ul><li>命令名称：grep</li><li>英文原意：global search regular expression(RE) and print out the line</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;grep</li><li>执行权限：所有用户</li><li>功能描述：全面搜索正则表达式并把行打印出来</li></ul><p>命令格式：<code>grep [选项] 搜索内容 文件名</code></p><ul><li>选项：<ul><li><code>-i</code>：忽略大小写</li><li><code>-n</code>：输出行号</li><li><code>-v</code>：反向查找</li><li><code>-d 动作</code>: 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep指令将回报信息并停止动作。动作包含：read、recurse、skip</li><li><code>-R</code>或<code>-r</code>: 此参数的效果和指定“-d recurse”参数相同，递归查找目录下的所有文件内容</li><li><code>--color=auto</code>：搜素出的关键字用颜色高亮显示</li></ul></li></ul><p>find也是搜索命令，那么find与grep命令有什么区别呢？<br><strong>find</strong>：find命令用于在系统中搜索符合条件的文件名，如果需要模糊查询，则使用通配符进行匹配，通配符是完全匹配。(find命令也可以通过”-regex”选项，把匹配规则转为正则表达式规则)<br><strong>grep</strong>：grep命令用于在文件中搜索符合条件的字符串，如果需要模糊查询，则使用正则表达式进行匹配，正则表达式是包含匹配。</p><blockquote><p>通配符与正则表达式的区别</p><ul><li>通配符：一般用于匹配文件名，完全匹配<ul><li><code>?</code>：匹配一个任意字符</li><li><code>*</code>：匹配0个或多个任意字符，也就是可以匹配任何内容</li><li><code>[]</code>：匹配中括号里任意一个字符。例如，[abc]代表一定匹配一个字符，或是a，或是b，或是c</li><li><code>[-]</code>：匹配中括号里任意一个字符，”-“代表一个范围。例如，[a-z]代表匹配一个小写字母</li><li><code>[^]</code>：逻辑非，表示匹配不是中括号里的一个字符。例如，[^0-9]代表匹配一个不是数字的字符</li></ul></li><li>正则表达式：一般用于匹配字符串<ul><li><code>?</code>：匹配前一个字符重复0次或1次</li><li><code>*</code>：匹配前一个字符重复0次或多次</li><li><code>[]</code>：匹配中括号里任意一个字符。例如，[abc]代表一定匹配一个字符，或是a，或是b，或是c</li><li><code>[-]</code>：匹配中括号里任意一个字符，”-“代表一个范围。例如，[a-z]代表匹配一个小写字母</li><li><code>[^]</code>：逻辑非，表示匹配不是中括号里的一个字符。例如，[^0-9]代表匹配一个不是数字的字符</li><li><code>^</code>：匹配行首</li><li><code>$</code>：匹配行尾</li></ul></li></ul></blockquote><p>示例：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#在文件中搜索一个单词，命令会返回一个包含“match_pattern”的文本行：</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># grep match_pattern file_name</span></span><br><span class="line">或</span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># grep <span class="string">&quot;match_pattern&quot;</span> file_name</span></span><br><span class="line"><span class="meta">#在多个文件中查找：</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># grep <span class="string">&quot;match_pattern&quot;</span> file_1 file_2 file_3</span></span><br><span class="line"><span class="meta">#标记匹配颜色 --color=auto 选项：</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># grep <span class="string">&quot;match_pattern&quot;</span> file_name --color=auto</span></span><br><span class="line"><span class="meta">#在当前目录中对文本进行递归搜索</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># grep -r <span class="string">&quot;match_pattern&quot;</span> .</span></span><br><span class="line"><span class="meta">#正则匹配输出以数字开头的所有行</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># grep <span class="string">&quot;^[0-9].*&quot;</span> file_name</span></span><br></pre></td></tr></table></figure><h3 id="7-6-管道符"><a href="#7-6-管道符" class="headerlink" title="7.6 | 管道符"></a>7.6 | 管道符</h3><p>命令格式：<code>命令1 | 命令2</code><br>“|”管道符的作用是把命令1的正确输出作为命令2的操作对象</p><p><strong>示例1</strong>：<br>我们经常使用 “ll” 命令查看文件的长格式，不过在有些目录中文件很多，不如&#x2F;etc&#x2F;目录使用 “ll” 命令显示的内容就非常多，只能看到最后的内容而不能看到前面输出的内容，这时我们马上想到 “more” 命令可以分屏显示文件内容，一种笨方法是：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#用输出重定向，把<span class="string">&quot;ll&quot;</span>命令的输出保存到<span class="regexp">/root/</span>testfile</span><br><span class="line">[root@localhost ~]# ll -a <span class="regexp">/etc/</span> &gt; <span class="regexp">/root/</span>testfile</span><br><span class="line">#然后用more分屏显示</span><br><span class="line">[root@localhost ~]# more <span class="regexp">/root/</span>testfile</span><br></pre></td></tr></table></figure><p>这样操作实在是不方便，这时可以利用管道符，命令如下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#把<span class="string">&quot;ll&quot;</span>命令的输出作为<span class="string">&quot;more&quot;</span>命令的操作对象</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ll -a /etc/ | more</span></span><br></pre></td></tr></table></figure><p><strong>示例2</strong>：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#在<span class="string">&quot;ll&quot;</span>命令输出内容中搜索yum的文件名</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ll -a /etc/ | grep yum</span></span><br></pre></td></tr></table></figure><p><strong>示例3</strong>：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#统计具体的网络连接数量（<span class="string">&quot;grep&quot;</span>命令筛选，<span class="string">&quot;wc&quot;</span>命令统计）</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># netstat -an | grep -i <span class="string">&quot;ESTABLISHED&quot;</span> | wc -l</span></span><br></pre></td></tr></table></figure><h3 id="7-7-alias-命令"><a href="#7-7-alias-命令" class="headerlink" title="7.7 alias 命令"></a>7.7 alias 命令</h3><p>alias命令用来设置指令的别名，我们可以使用该命令可以将一些较长的命令进行简化。</p><p><strong>alias基本使用方法</strong>：</p><ul><li>打印已经设置的命令别名<ul><li><code>alias</code> 或 <code>alias -p</code></li></ul></li><li>给命令设置别名<ul><li>格式：<code>alias 新的命令=&#39;实际命令&#39;</code>。必须使用单引号’’实际命令引起来，防止特殊字符导致错误</li><li>例如：<code>alias l=&#39;ls -lsh&#39;</code>，现在只用输入 “l” 就可以列出目录了，相当于输入”ls -lsh”；<code>alias ser=&#39;service network restart&#39;</code>，现在输入”ser”就可以重启网络服务了</li></ul></li></ul><blockquote><p>直接在shell里设定的命令别名，在终端关闭或者系统重新启动后都会失效，如何才能永久有效呢？<br>使用编辑器打开<del>&#x2F;.bashrc，在文件中加入别名设置，如：alias rm&#x3D;’rm -i’，保存后执行source ~&#x2F;.bashrc，这样就可以永久保存命令的别名了。因为修改的是当前用户目录下的</del>&#x2F;.bashrc文件，所以这样的方式只对当前用户有用。如果要对所有用户都有效，修改&#x2F;etc&#x2F;bashrc文件就可以了。</p></blockquote><h2 id="8-压缩和解压缩命令"><a href="#8-压缩和解压缩命令" class="headerlink" title="8 压缩和解压缩命令"></a>8 压缩和解压缩命令</h2><p>在Linux中可以识别的常见压缩格式有十几种，比如”.zip”、”.gz”、”.bz2”、”.tar”、”.tar.gz”、”.tar.bz2”等。减少文件大小有两个明显的好处，一是可以减少存储空间，二是通过网络传输文件时，可以减少传输的时间</p><h3 id="8-1-“-zip”-格式"><a href="#8-1-“-zip”-格式" class="headerlink" title="8.1 “.zip” 格式"></a>8.1 “.zip” 格式</h3><p>“.zip”是Windows中最常见的压缩格式，Liunx也可以正确识别”.zip”格式，这可以方便地和Windows系统通用压缩文件。</p><h4 id="8-1-1-zip-命令"><a href="#8-1-1-zip-命令" class="headerlink" title="8.1.1 zip 命令"></a>8.1.1 zip 命令</h4><p>zip命令就是”.zip”格式的压缩命令，基本信息如下：</p><ul><li>命令名称：zip</li><li>英文原意：package and compress(archive) files</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;zip</li><li>执行权限：所有用户</li><li>功能描述：压缩文件和目录</li></ul><p>命令格式：<code>zip [选项] 压缩包名 源文件或目录</code></p><ul><li>选项：<ul><li><code>-r</code>：压缩目录递归处理，将指定目录下的所有文件和子目录一并处理</li></ul></li></ul><h4 id="8-1-2-unzip-命令"><a href="#8-1-2-unzip-命令" class="headerlink" title="8.1.2 unzip 命令"></a>8.1.2 unzip 命令</h4><p>unzip命令就是”.zip”格式的解压缩命令，基本信息如下：</p><ul><li>命令名称：unzip</li><li>英文原意：list, test and extract compressed files in a zip archive</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;unzip</li><li>执行权限：所有用户</li><li>功能描述：列表、测试和提取压缩文件中的文件</li></ul><p>命令格式：<code>unzip [选项] 压缩包名</code></p><ul><li>选项：<ul><li><code>-d</code>：指定解压的位置</li></ul></li></ul><h3 id="8-2-“-gz”-格式"><a href="#8-2-“-gz”-格式" class="headerlink" title="8.2 “.gz” 格式"></a>8.2 “.gz” 格式</h3><p>“.gz”格式是Linux中最常见的压缩格式。</p><h4 id="8-2-1-gzip-命令"><a href="#8-2-1-gzip-命令" class="headerlink" title="8.2.1 gzip 命令"></a>8.2.1 gzip 命令</h4><p>gzip命令是”.gz”格式的压缩和解压缩命令，既方便又好用。gzip不仅可以用来压缩大的、较少使用的文件以节省磁盘空间，还可以和tar命令一起构成Linux操作系统中比较流行的压缩文件格式。据统计，gzip命令对文本文件有60%～70%的压缩率。<strong>注意：gzip不会打包文件，压缩的过程源文件会对应变为”.gz”格式的压缩文件(源文件被删除)，解压缩的过程将”.gz”格式的压缩文件再恢复成对应的源文件</strong>。基本信息如下：</p><ul><li>命令名称：gzip</li><li>英文原意：compress or expand files</li><li>所在路径：&#x2F;bin&#x2F;gzip</li><li>执行权限：所有用户</li><li>功能描述：压缩或解压缩 “.gz” 格式的文件或目录</li></ul><p>命令格式：<code>gzip [选项] 源文件</code></p><ul><li>选项：<ul><li><code>-d</code>：执行解压缩</li><li><code>-r</code>：递归处理，将指定目录下的所有文件及子目录一并处理</li><li><code>-c</code>：将压缩数据输出到标准输出中，可以保留源文件<ul><li>使用”-c”选项，压缩数据会直接输出到屏幕上，为了不让压缩数据输出到屏幕上而是重定向到压缩文件中，并且同时保留源文件，命令可以这样写：<code>gzip -c abc &gt; abc.gz</code></li></ul></li><li><code>-l</code>：列出压缩文件的相关信息</li></ul></li></ul><h4 id="8-2-2-gunzip-命令"><a href="#8-2-2-gunzip-命令" class="headerlink" title="8.2.2 gunzip 命令"></a>8.2.2 gunzip 命令</h4><p>gunzip命令用来解压缩 “.gz” 格式的文件(即使用 “gzip” 命令压缩的文件)，作用相当于 “gzip -d 压缩文件”，因此不论是压缩或解压缩，都可通过 “gzip” 指令单独完成。基本下信息如下：</p><ul><li>命令名称：gunzip</li><li>英文原意：expand files</li><li>所在路径：&#x2F;bin&#x2F;gunzip</li><li>执行权限：所有用户</li><li>功能描述：解压缩”.gz” 格式的文件或目录</li></ul><p>命令格式：<code>gunzip [选项] 压缩文件</code></p><ul><li>选项：<ul><li><code>-r</code>：递归处理，将指定目录下的所有文件及子目录一并处理</li><li><code>-c</code>：把解压后的文件数据输出到标准输出中，可以保留压缩文件</li><li><code>-l</code>：列出压缩文件的相关信息</li></ul></li></ul><h3 id="8-3-“-bz2”-格式"><a href="#8-3-“-bz2”-格式" class="headerlink" title="8.3 “.bz2” 格式"></a>8.3 “.bz2” 格式</h3><p>“.bz2” 格式是Linux的另一种压缩格式，从理论上来讲，”.bz2” 格式的算法更新进、压缩比更好；而 “.gz” 格式相对来讲压缩的时间更快</p><h4 id="8-3-1-bzip2-命令"><a href="#8-3-1-bzip2-命令" class="headerlink" title="8.3.1 bzip2 命令"></a>8.3.1 bzip2 命令</h4><p>bzip2 命令是 “.bz2” 格式文件的压缩和解压缩命令。<strong>注意：”bzip2”不能用来压缩目录</strong>。基本信息如下：</p><ul><li>命令名称：bzip2</li><li>英文原意：a block-sorting file compressor</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;bzip2</li><li>执行权限：所有用户</li><li>功能描述：压缩或解压缩 “.bz2” 格式的文件</li></ul><p>命令格式：<code>bzip2 [选项] 源文件</code></p><ul><li>选项：<ul><li><code>-d</code>：执行解压缩</li><li><code>-k</code>：压缩或解压缩后，会删除原始文件，若要保留原始文件，请使用此参数</li><li><code>-f</code>：在压缩或解压缩时，若输出文件与现有文件同名，强制覆盖现有文件</li><li><code>-c</code>：将压缩与解压缩的数据输出到标准输出中</li></ul></li></ul><h4 id="8-3-2-bunzip2-命令"><a href="#8-3-2-bunzip2-命令" class="headerlink" title="8.3.2 bunzip2 命令"></a>8.3.2 bunzip2 命令</h4><p>bunzip2命令用来解压缩 “.bz2” 格式的文件(即使用 “bzip2” 命令压缩的文件)，作用相当于 “bzip2 -d 压缩文件”，因此不论是压缩或解压缩，都可通过 “bzip2” 指令单独完成。基本信息如下：</p><ul><li>命令名称：bunzip2</li><li>英文原意：a block-sorting file compressor</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;bunzip2</li><li>执行权限：所有用户</li><li>功能描述：解压缩 “.bz2” 格式的文件</li></ul><p>命令格式：<code>bunzip2 [选项] 压缩文件</code></p><ul><li>选项：<ul><li><code>-k</code>：bzip2在解压缩后，会删除原始压缩文件，若要保留原始压缩文件，请使用此参数</li><li><code>-f</code>：解压缩时，若输出的文件与现有文件同名时，强制覆盖现有的文件</li><li><code>-c</code>：将解压缩的数据输出到标准输出中</li></ul></li></ul><h3 id="8-4-“-tar”、”-tar-gz”、”-tar-bz2”-格式"><a href="#8-4-“-tar”、”-tar-gz”、”-tar-bz2”-格式" class="headerlink" title="8.4 “.tar”、”.tar.gz”、”.tar.bz2” 格式"></a>8.4 “.tar”、”.tar.gz”、”.tar.bz2” 格式</h3><p>tar命令可以把一大堆的文件和目录全部打包成一个文件，这对于备份文件或将几个文件组合成为一个文件以便于网络传输是非常有用的。<strong>注意：打包和压缩是两个不同的概念，打包是指将一大堆文件或目录变成一个总的文件；压缩则是将一个大的文件通过一些压缩算法变成一个小文件</strong>。为什么要区分这两个概念呢？这源于Linux中很多压缩程序(gzip、bzip2)只能针对一个文件进行压缩，这样当你想要压缩一大堆文件时，你得先将这一大堆文件先打成一个包（tar），然后再用压缩程序进行压缩。tar命令基本信息如下：</p><ul><li>命令名称：tar</li><li>英文原意：tar</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;tar</li><li>执行权限：所有用户</li><li>功能描述：打包与解打包文件</li></ul><p>命令格式：<br><strong>打包</strong>：<code>tar -c [选项] [-f 包文件名] 源文件或目录</code><br><strong>解打包</strong>：<code>tar -x [选项] -f 包文件名</code></p><ul><li>选项：<ul><li><code>-c</code>：执行打包</li><li><code>-x</code>：执行解打包</li><li><code>-z</code>：支持压缩和解压缩 “.tar.gz” 格式文件</li><li><code>-j</code>：支持压缩和解压缩 “.tar.bz2” 格式文件</li><li><code>-C 目录路径</code>：指定解打包位置</li><li><code>-f 包文件名</code>: 指定打包文件名(.tar)或压缩包文件名(.tar.gz、.tar.bz2)。（执行打包时不写此选项，会默认把打包数据输出到屏幕）</li><li><code>-v</code>: 显示打包或解打包过程</li><li><code>-t</code>：测试，就是不解打包，只是查看包中有哪些文件</li></ul></li></ul><p>示例：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#=======================<span class="string">&quot;.tar&quot;</span>格式=========================</span></span><br><span class="line"><span class="meta">#打包不会压缩</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># tar -cvf anaconda-ks.cfg.tar anaconda-ks.cfg</span></span><br><span class="line"><span class="meta">#解打包到当前目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># tar -xvf anaconda-ks.cfg.tar</span></span><br><span class="line"><span class="meta">#解打包到指定目录</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># tar -xvf anaconda-ks.cfg.tar -C /testdir/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#=====================<span class="string">&quot;.tar.gz&quot;</span>格式=====================</span></span><br><span class="line"><span class="meta">#把/tmp/目录直接打包并压缩为<span class="string">&quot;.tar.gz&quot;</span>格式</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># tar -zcvf tmp.tar.gz /tmp/</span></span><br><span class="line"><span class="meta">#解压缩并解打包<span class="string">&quot;.tar.gz&quot;</span>格式文件</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># tar -zxvf tmp.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#=====================<span class="string">&quot;.tar.bz2&quot;</span>格式=====================</span></span><br><span class="line"><span class="meta">#把/tmp/目录直接打包并压缩为<span class="string">&quot;.tar.bz2&quot;</span>格式</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># tar -jcvf tmp.tar.gz /tmp/</span></span><br><span class="line"><span class="meta">#解压缩并解打包<span class="string">&quot;.tar.bz2&quot;</span>格式文件</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># tar -jxvf tmp.tar.gz</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="9-关机和重启命令"><a href="#9-关机和重启命令" class="headerlink" title="9 关机和重启命令"></a>9 关机和重启命令</h2><h3 id="9-1-sync-数据同步"><a href="#9-1-sync-数据同步" class="headerlink" title="9.1 sync 数据同步"></a>9.1 sync 数据同步</h3><p>sync命令用于强制被改变的内容立刻写入磁盘。在Linux&#x2F;Unix系统中，在文件或数据处理过程中一般先放到内存缓冲区中，等到适当的时候再写入磁盘，以提高系统的运行效率。sync命令则可用来强制将内存缓冲区中的数据立即写入磁盘中。用户通常不需执行sync命令，系统会自动执行update或bdflush操作，将缓冲区的数据写入磁盘。<strong>只有在update或bdflush无法执行或用户需要非正常关机时，才需手动执行sync命令</strong>。基本信息如下：</p><ul><li>命令名称：sync</li><li>英文原意：flush file system buffers</li><li>所在路径：&#x2F;bin&#x2F;sync</li><li>执行权限：所有用户</li><li>功能描述：刷新文件系统缓冲区</li></ul><p>命令格式：<code>sync [选项]</code></p><h3 id="9-2-shutdown-命令"><a href="#9-2-shutdown-命令" class="headerlink" title="9.2 shutdown 命令"></a>9.2 shutdown 命令</h3><p>shutdown命令用来系统关机。shutdown指令可以关闭所有程序，并依用户的需要，进行重新开机或关机的动作。基本信息如下：</p><ul><li>命令名称：shutdown</li><li>英文原意：bring the system down</li><li>所在路径：&#x2F;sbin&#x2F;shutdown</li><li>执行权限：超级用户</li><li>功能描述：关机和重启</li></ul><p>命令格式：<code>shutdown [选项] 时间 [警告信息]</code></p><ul><li>选项：<ul><li><code>-c</code>：取消将要执行的shutdown命令</li><li><code>-h</code>：系统关机</li><li><code>-r</code>：系统重启</li></ul></li><li>时间：<code>now</code> 立即执；<code>hh:mm</code> 指定确定时间点执行；<code>+分钟数</code> 延迟指定分钟后执行</li><li>警告信息：执行指令时，同时送出警告信息给登入用户</li></ul><p>示例：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#立即关机</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># shutdown -h now</span></span><br><span class="line"><span class="meta">#指定5分钟后关机，同时送出警告信息给登入用户：</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># shutdown +5 <span class="string">&quot;System will shutdown after 5 minutes&quot;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="9-3-reboot-命令"><a href="#9-3-reboot-命令" class="headerlink" title="9.3 reboot 命令"></a>9.3 reboot 命令</h3><p>reboot命令用来重新系统，命令也是安全的，而且不需要过多的选项</p><ul><li>命令名称：reboot</li><li>英文原意：reboot</li><li>所在路径：&#x2F;sbin&#x2F;reboot</li><li>执行权限：超级用户</li><li>功能描述：重启系统</li></ul><p>命令格式：<code>reboot [选项]</code></p><ul><li>选项：<ul><li><code>-d</code>：重新开机时不把数据写入记录文件&#x2F;var&#x2F;tmp&#x2F;wtmp。本参数具有“-n”参数效果；</li><li><code>-f</code>：强制重新开机，不调用shutdown指令的功能；</li><li><code>-i</code>：在重开机之前，先关闭所有网络界面；</li><li><code>-n</code>：重开机之前不检查是否有未结束的程序；</li><li><code>-w</code>：仅做测试，并不真正将系统重新开机，只会把重开机的数据写入&#x2F;var&#x2F;log目录下的wtmp记录文件。</li></ul></li></ul><h3 id="9-4-halt-和-poweroff-命令"><a href="#9-4-halt-和-poweroff-命令" class="headerlink" title="9.4 halt 和 poweroff 命令"></a>9.4 halt 和 poweroff 命令</h3><p>halt 和 poweroff 这两都是系统关机命令，直接执行即可。但是两个命令不会完整关闭和保存系统的服务，不建议使用。</p><h3 id="9-5-init-命令"><a href="#9-5-init-命令" class="headerlink" title="9.5 init 命令"></a>9.5 init 命令</h3><p>init 命令是修改Linux 运行级别的命令，是Linux下的进程初始化工具，init进程是所有Linux进程的父进程，它的进程号为1。也可以用于关机和重启，这个命令并不安全，不建议使用</p><p>命令格式：<code>init [选项] 系统运行级别</code></p><ul><li>选项：<ul><li><code>-b</code>：不执行相关脚本而直接进入单用户模式</li><li><code>-s</code>：切换到单用户模式</li></ul></li></ul><p>示例：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#关机，也就是调用系统的0级别</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># init 0</span></span><br><span class="line"><span class="meta">#重启，也就是调用系统的6级别</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># init 6</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Linux有7个系统运行级别</p><table><thead><tr><th>运行级别</th><th>含义</th></tr></thead><tbody><tr><td>0</td><td>关机</td></tr><tr><td>1</td><td>单用户模式，可以想象为Windows的安全模式，主要用于系统修复</td></tr><tr><td>2</td><td>不完全的命令模式，不含NFS服务</td></tr><tr><td>3</td><td>完全的命令模式，就是标准字符界面</td></tr><tr><td>4</td><td>系统保留，没有用到</td></tr><tr><td>5</td><td>图形模式</td></tr><tr><td>6</td><td>重启动</td></tr></tbody></table><blockquote><p><code>runlevel</code> 命令可查看当前系统运行级别</p></blockquote><h2 id="10-常用网络命令"><a href="#10-常用网络命令" class="headerlink" title="10 常用网络命令"></a>10 常用网络命令</h2><h3 id="10-1-配置IP地址"><a href="#10-1-配置IP地址" class="headerlink" title="10.1 配置IP地址"></a>10.1 配置IP地址</h3><p>IP地址是计算机在互联网中唯一的地址编码，每台计算机如果需要接入网络和其他计算机进行数据通信，就必须配置唯一的IP地址</p><p>IP地址的配置有两种方法：</p><ul><li><strong>setup 工具</strong></li><li><strong>手工修改网卡配置文件</strong><ul><li>第一步：编辑网卡文件，<code>vi /etc/sysconfig/network-scripts/ifcfg-eth0</code>，”ifcfg-eth0”是第一块网卡，第二块网卡则为”ifcfg-eth1”，以此类推。网卡文件内容配置项如下：<ul><li>DEVICE&#x3D;eth0 #网卡设备名</li><li>BOOTPROTO&#x3D;static #[none|static|bootp|dhcp]（引导时不使用协议|静态分配|BOOTP协议|DHCP协议）</li><li>HWADDR&#x3D;00:15:5D:00:46:83 #MAC地址</li><li>UUID&#x3D;5753e2ed-add1-4d1c-8a69-21a89647b050 # 唯一识别码</li><li>NM_CONTROLLED&#x3D;yes #是否可以由Network Manager图形管理工具托管</li><li>ONBOOT&#x3D;yes #[yes|no]，是否随网络服务启动，如果配置”no”，使用”ifconfig”命令时看不到该网卡</li><li>TYPE&#x3D;Ethernet # 网络类型</li><li>IPADDR&#x3D;192.168.1.10 #IP地址</li><li>NETMASK&#x3D;255.255.255.0 #子网掩码</li><li>NETWORK&#x3D;192.168.1.0 #网络地址</li><li>BROADCAST&#x3D;192.168.1.255 #广播地址</li><li>GATEWAY&#x3D;192.168.1.1 #网关地址</li><li>DNS1&#x3D;202.109.14.5 #首选DNS服务地址</li><li>DNS2&#x3D;219.141.136.10 #备用DNS服务地址</li><li>USERCTL&#x3D;no #[yes|no]（非root用户是否可以控制该设备）</li></ul></li><li>第二步：查看DNS服务配置文件，<code>vim /etc/resolv.conf</code>，里面的内容是系统自动生成的，一般不需要修改</li><li>第三步：重启网络服务，<code>service network restart</code> 或 <code>/etc/init.d/network restart</code></li></ul></li></ul><blockquote><p>注意：使用虚拟机克隆时，UUID可能复制的是一样的，导致网络服务启动失败，需要重置UUID值：<br>第一步：编辑网卡文件，删除UUID和MAC地址<br>第二步: 删除MAC地址和UUID绑定文件，<code>rm -rf /etc/udev/rules.d/70-persistent-net.rules</code><br>第三部：重启系统</p></blockquote><h3 id="10-2-ifconfig-命令"><a href="#10-2-ifconfig-命令" class="headerlink" title="10.2 ifconfig 命令"></a>10.2 ifconfig 命令</h3><p>ifconfig 被用于配置和显示Linux内核中网络接口的网络参数。<strong>用ifconfig命令配置的网卡信息，在网卡重启后机器重启后，配置就不存在</strong>，要想将上述的配置信息永远的存的电脑里，那就要修改网卡的配置文件了。基本信息如下：</p><ul><li>命令名称：ifconfig</li><li>英文原意：configure a network interface</li><li>所在路径：&#x2F;sbin&#x2F;ifconfig</li><li>执行权限：超级用户</li><li>功能描述：配置网络接口</li></ul><p>命令格式：<code>ifconfig [参数]</code></p><ul><li>参数：<ul><li><code>add 地址</code>：设置网络设备IPv6的ip地址；</li><li><code>del 地址</code>：删除网络设备IPv6的IP地址；</li><li><code>down</code>：关闭指定的网络设备；</li><li><code>&lt;hw&lt;网络设备类型&gt;&lt;硬件地址&gt;</code>：设置网络设备的类型与硬件地址；</li><li><code>io_addr I/O地址</code>：设置网络设备的I&#x2F;O地址；</li><li><code>irq IRQ地址</code>：设置网络设备的IRQ；</li><li><code>media 网络媒介类型</code>：设置网络设备的媒介类型；</li><li><code>mem_start 内存地址</code>：设置网络设备在主内存所占用的起始地址；</li><li><code>metric 数目</code>：指定在计算数据包的转送次数时，所要加上的数目；</li><li><code>mtu 字节</code>：设置网络设备的MTU；</li><li><code>netmask 子网掩码</code>：设置网络设备的子网掩码；</li><li><code>tunnel 地址</code>：建立IPv4与IPv6之间的隧道通信地址；</li><li><code>up</code>：启动指定的网络设备；</li><li><code>IP地址</code>：指定网络设备的IP地址；</li><li><code>网络设备</code>：指定网络设备的名称。</li></ul></li></ul><p>ifconfig 命令最主要的作用就是查看IP地址的信息，直接输入<code>ifconfig</code>命令即可显示激活状态的网络设备信息:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr <span class="number">00</span>:<span class="number">16</span>:<span class="number">3</span>E:<span class="number">00</span>:<span class="number">1</span>E:<span class="number">51</span>  </span><br><span class="line">          inet addr:<span class="number">10.160</span>.<span class="number">7.81</span>  Bcas<span class="variable">t:10</span>.<span class="number">160.15</span>.<span class="number">255</span>  Mask:<span class="number">255.255</span>.<span class="number">240.0</span></span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:61430830</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:88534</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">1000</span></span><br><span class="line">          RX byte<span class="variable">s:3607197869</span> (<span class="number">3.3</span> GiB)  TX byte<span class="variable">s:6115042</span> (<span class="number">5.8</span> MiB)</span><br><span class="line"></span><br><span class="line"><span class="keyword">lo</span>        Link encap:Local Loopback  </span><br><span class="line">          inet addr:<span class="number">127.0</span>.<span class="number">0.1</span>  Mask:<span class="number">255.0</span>.<span class="number">0.0</span></span><br><span class="line">          UP LOOPBACK RUNNING  MTU:<span class="number">16436</span>  Metric:<span class="number">1</span></span><br><span class="line">          RX packet<span class="variable">s:56103</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> frame:<span class="number">0</span></span><br><span class="line">          TX packet<span class="variable">s:56103</span> error<span class="variable">s:0</span> dropped:<span class="number">0</span> overrun<span class="variable">s:0</span> carrier:<span class="number">0</span></span><br><span class="line">          collision<span class="variable">s:0</span> txqueuelen:<span class="number">0</span></span><br><span class="line">          RX byte<span class="variable">s:5079451</span> (<span class="number">4.8</span> MiB)  TX byte<span class="variable">s:5079451</span> (<span class="number">4.8</span> MiB)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>内容说明：</p><ul><li><strong>eth0</strong> 表示第一块网卡，其中HWaddr表示网卡的物理地址，可以看到目前这个网卡的物理地址(MAC地址）是00:16:3E:00:1E:51</li><li><strong>inet addr</strong> 用来表示网卡的IP地址，此网卡的IP地址是10.160.7.81，广播地址Bcast:10.160.15.255，掩码地址Mask:255.255.240.0</li><li><strong>lo</strong> 是表示主机的回环地址，这个一般是用来测试一个网络程序，但又不想让局域网或外网的用户能够查看，只能在此台主机上运行和查看所用的网络接口。比如把 httpd服务器的指定到回环地址，在浏览器输入127.0.0.1就能看到你所架WEB网站了，但只是本机能看得到，局域网的其它主机或用户无从知道<ul><li>第一行：连接类型：Ethernet（以太网）HWaddr（硬件mac地址）</li><li>第二行：网卡的IP地址、子网、掩码</li><li>第三行：UP（代表网卡开启状态）RUNNING（代表网卡的网线被接上）MULTICAST（支持组播）MTU:1500（最大传输单元）：1500字节</li><li>第四、五行：接收、发送数据包情况统计</li><li>第七行：接收、发送数据字节数统计信息</li></ul></li></ul><p>其他示例：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#启动和关闭网卡eth0。关闭网卡eth0，ssh登陆linux服务器操作要小心，关闭了就不能开启了，除非你有多网卡</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 up</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 down</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#为网卡eth0配置IPv6地址</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 add 33ffe:3240:800:1005::2/64  </span></span><br><span class="line"> <span class="meta">#为网卡eth0删除IPv6地址</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 del 33ffe:3240:800:1005::2/64 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#用ifconfig修改MAC地址</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 hw ether 00:AA:BB:CC:dd:EE</span></span><br><span class="line"><span class="meta">#ifconfig配置IP地址</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 192.168.2.10</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 192.168.2.10 netmask 255.255.255.0</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 192.168.2.10 netmask 255.255.255.0 broadcast 192.168.2.255</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#启用和关闭arp协议</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 arp   </span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 -arp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#设置最大传输单元，这里设置能通过的最大数据包大小为 1500 bytes</span></span><br><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># ifconfig eth0 mtu 1500 </span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="10-3-ping-命令"><a href="#10-3-ping-命令" class="headerlink" title="10.3 ping 命令"></a>10.3 ping 命令</h3><p>ping 命令是常用的网络命令，主要通过ICMP协议进行网络探测，测试网络中主机的通信情况。基本信息如下：</p><ul><li>命令名称：ping</li><li>英文原意：send ICMP ECHO_REQUEST to network hosts</li><li>所在路径：&#x2F;bin&#x2F;ping</li><li>执行权限：所有用户</li><li>功能描述：向网络主机发送ICMP请求</li></ul><p>命令格式： <code>ping [选项] IP</code></p><ul><li>选项：<ul><li>-b：用于对整个网段进行探测。IP需要为广播地址</li><li>-c 次数：设置完成要求回应的次数</li><li>-s 字节数：设置数据包的大小</li></ul></li></ul><p>示例：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#探测整个网段中有多少主机是可以和本机通信的，而不是一个一个IP地址地进行探测</span></span><br><span class="line">[root@localhost ~]#<span class="built_in"> ping </span>-b -c 3 192.168.199.255</span><br><span class="line">WARNING: pinging broadcast<span class="built_in"> address</span></span><br><span class="line"><span class="built_in">PING </span>192.168.199.255 (192.168.199.255) 56(84) bytes of data.</span><br><span class="line">64 bytes <span class="keyword">from</span> 192.168.199.216: <span class="attribute">icmp_seq</span>=1 <span class="attribute">ttl</span>=64 <span class="attribute">time</span>=77.7 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 192.168.199.131: <span class="attribute">icmp_seq</span>=2 <span class="attribute">ttl</span>=64 <span class="attribute">time</span>=102 ms</span><br><span class="line">64 bytes <span class="keyword">from</span> 192.168.199.216: <span class="attribute">icmp_seq</span>=3 <span class="attribute">ttl</span>=64 <span class="attribute">time</span>=19.5 ms</span><br><span class="line"></span><br><span class="line">--- 192.168.199.255<span class="built_in"> ping </span>statistics ---</span><br><span class="line">3 packets transmitted, 3 received, 0% packet loss, time 2023ms</span><br><span class="line">rtt min/avg/max/mdev = 19.515/66.701/102.798/34.892 ms</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="10-4-netstat-命令"><a href="#10-4-netstat-命令" class="headerlink" title="10.4 netstat 命令"></a>10.4 netstat 命令</h3><p>netstat是网络状态查看命令，既可以查看到本机开启的端口，也可以查看哪些客户端连接。在CentOS 7.x中 netstat 命令默认没有安装，如果需要使用，需要先安装 “net-snmp” 和 “net-tools” 软件包。基本信息如下：</p><ul><li>命令名称：network</li><li>英文原意：print network connections, routing tables, interface statistics, masquerade connections, and mulicast memberships</li><li>所在路径：&#x2F;bin&#x2F;netstat</li><li>执行权限：所有用户</li><li>功能描述：打印网络连接、路由表、接口统计信息、伪装连接和多播成员身份</li></ul><p>命令格式：<code>netstat [选项]</code></p><ul><li>选项：<ul><li><code>-a</code>：列出所有网络状态，包括Socket程序</li><li><code>-c 秒数</code>：制定每隔几秒刷一次网络状态</li><li><code>-n</code>：使用IP地址和端口号显示，不使用域名与服务名</li><li><code>-p</code>：显示PID和程序</li><li><code>-t</code>：显示使用TCP协议端口的连接情况</li><li><code>-u</code>：显示使用UDP协议端口的连接情况</li><li><code>-l</code>：仅显示监听状态的连接</li><li><code>-r</code>：显示路由表</li></ul></li></ul><p><strong>示例 1：查看本机开启的端口</strong><br>这是本机最常用的方式，使用”-tuln”选项。因为使用了”-l”选项，所以只能看到监听状态的连接，而不能看到已经建立连接状态的连接，</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="variable">@localhost</span> ~]<span class="comment"># netstat -tuln</span></span><br><span class="line"><span class="title class_">Active</span> <span class="title class_">Internet</span> connections (only servers)</span><br><span class="line"><span class="title class_">Proto</span> <span class="title class_">Recv</span>-Q <span class="title class_">Send</span>-Q <span class="title class_">Local</span> <span class="title class_">Address</span>               <span class="title class_">Foreign</span> <span class="title class_">Address</span>             <span class="title class_">State</span>            </span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">3306</span>                <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                   <span class="title class_">LISTEN</span></span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">11211</span>               <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                   <span class="title class_">LISTEN</span></span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">22</span>                  <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                   <span class="title class_">LISTEN</span></span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> ::<span class="symbol">:</span><span class="number">11211</span>                    ::<span class="symbol">:*</span>                        <span class="title class_">LISTEN</span></span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> ::<span class="symbol">:</span><span class="number">80</span>                       ::<span class="symbol">:*</span>                        <span class="title class_">LISTEN</span></span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> ::<span class="symbol">:</span><span class="number">22</span>                       ::<span class="symbol">:*</span>                        <span class="title class_">LISTEN</span></span><br><span class="line">udp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">11211</span>               <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span> </span><br><span class="line">udp        <span class="number">0</span>      <span class="number">0</span> ::<span class="symbol">:</span><span class="number">11211</span>                    ::<span class="symbol">:*</span>  </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这个命令输出内容较多，下面对每列进行说明：</p><ul><li><strong>Proto</strong>：网络连接的协议，一般就是 TCP 协议或者 UDP 协议</li><li><strong>Recv-Q</strong>：接收队列。表示接收到的数据，已经在本地的缓冲中，但是还没有被进程取走</li><li><strong>Send-Q</strong>：发送队列。表示从本机发送，对方还没有收到的数据，依然在本地的缓冲中，一般是不具备ACK标志的数据包</li><li><strong>Local Address</strong>：本机的 IP 地址和端口号。</li><li><strong>Foreign Address</strong>：远程主机的 IP 地址和端口号。</li><li><strong>State</strong>：状态。常见的状态主要有以下几种：<ul><li>LISTEN：监听状态，只有 TCP 协议需要监听，而 UDP 协议不需要监听</li><li>ESTABLISHED：已经建立连接的状态。如果使用“-l”选项，则看不到已经建立连接的状态</li><li>SYN_SENT：SYN 发起包，就是主动发起连接的数据包</li><li>SYN_RECV：接收到主动连接的数据包</li><li>FIN_WAIT1：正在中断的连接</li><li>FIN_WAIT2：已经中断的连接，但是正在等待对方主机进行确认</li><li>TIME_WAIT：连接已经中断，但是套接字依然在网络中等待结束</li><li>CLOSED：套接字没有被使用</li><li>在这些状态中，我们最常用的就是 LISTEN 和 ESTABLISHED 状态，一种代表正在监听，另一种代表已经建立连接</li></ul></li></ul><p><strong>示例 2：查看本机有哪些程序开启的端口</strong><br>如果使用“-p”选项，查询结果会多出一列”PID&#x2F;Program name”，则可以查看到是哪个程序占用了端口，并且可以知道这个程序的 PID</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="variable">@localhost</span> ~]<span class="comment"># netstat -tulnp</span></span><br><span class="line"><span class="title class_">Active</span> <span class="title class_">Internet</span> connections (only servers)</span><br><span class="line"><span class="title class_">Proto</span> <span class="title class_">Recv</span>-Q <span class="title class_">Send</span>-Q <span class="title class_">Local</span> <span class="title class_">Address</span>      <span class="title class_">Foreign</span> <span class="title class_">Address</span>     <span class="title class_">State</span>      <span class="title class_">PID</span>/<span class="title class_">Program</span> name       </span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">3306</span>       <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>           <span class="title class_">LISTEN</span>     <span class="number">2359</span>/mysqld</span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">11211</span>      <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>           <span class="title class_">LISTEN</span>     <span class="number">1563</span>/memcached</span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">22</span>         <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>           <span class="title class_">LISTEN</span>     <span class="number">1490</span>/sshd</span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> ::<span class="symbol">:</span><span class="number">11211</span>           ::<span class="symbol">:*</span>                <span class="title class_">LISTEN</span>     <span class="number">1563</span>/memcached</span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> ::<span class="symbol">:</span><span class="number">80</span>              ::<span class="symbol">:*</span>                <span class="title class_">LISTEN</span>     <span class="number">21025</span>/httpd</span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> ::<span class="symbol">:</span><span class="number">22</span>              ::<span class="symbol">:*</span>                <span class="title class_">LISTEN</span>     <span class="number">1490</span>/sshd</span><br><span class="line">udp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">11211</span>      <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                      <span class="number">1563</span>/memcached</span><br><span class="line">udp        <span class="number">0</span>      <span class="number">0</span> ::<span class="symbol">:</span><span class="number">11211</span>           ::<span class="symbol">:*</span>                           <span class="number">1563</span>/memcached</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>示例 3：查看所有连接</strong><br>使用选项“-an”可以查看所有连接，包括监听状态的连接（LISTEN）、已经建立连接状态的<br>连接（ESTABLISHED）、Socket 程序连接等。因为连接较多，所以输出的内容有很多</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># netstat -an</span></span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address               Foreign Address             State            </span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>0.0.0.0:3306                0.0.0.0:*                   LISTEN</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>0.0.0.0:11211               0.0.0.0:*                   LISTEN</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>117.79.130.170:80           78.46.174.55:58815          SYN_RECV</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>0.0.0.0:22                  0.0.0.0:*                   LISTEN</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>117.79.130.170:22           124.205.129.99:10379        ESTABLISHED</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>117.79.130.170:22           124.205.129.99:11811        ESTABLISHED</span><br><span class="line">...省略部分内容...</span><br><span class="line">udp       <span class="number"> 0 </span>    <span class="number"> 0 </span>0.0.0.0:11211               0.0.0.0:* </span><br><span class="line">udp       <span class="number"> 0 </span>    <span class="number"> 0 </span>:::11211                    :::* </span><br><span class="line">Active UNIX domain sockets (servers and established)</span><br><span class="line">Proto RefCnt Flags       Type       State         I-Node Path</span><br><span class="line">unix <span class="number"> 2 </span>     [ ACC ]     STREAM     LISTENING    <span class="number"> 12668 </span> /var/run/mcelog-client</span><br><span class="line">unix <span class="number"> 2 </span>     [ ACC ]     STREAM     LISTENING    <span class="number"> 12193 </span> @/var/run/hald/dbus-ZeYsMXZ7Uf</span><br><span class="line">...省略部分内容...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>从 “Active UNIX domain sockets” 开始，之后的内容就是 Socket 程序产生的连接，之前的内容都是网<br>络服务产生的连接。我们可以在“-an”选项的输出中看到各种网络连接状态，而之前的“-tuln”选项则只能看到监听状态的连接</p><h3 id="10-5-write-命令"><a href="#10-5-write-命令" class="headerlink" title="10.5 write 命令"></a>10.5 write 命令</h3><p>write 命令用于向指定登录用户终端上发送信息。通过write命令可传递信息给另一位登入系统的用户，当输入完毕后，键入 “回车” 表示发送，键入 “Ctrl+C” 表示信息结束。如果接收信息的用户不只登入本地主机一次，你可以指定接收信息的终端机编号。基本信息：</p><ul><li>命令名称：write</li><li>英文原意：send a message to another user</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;write</li><li>执行权限：所有用户</li><li>功能描述：向其他用户发送消息</li></ul><p>命令格式 ：<code>write 用户名 [终端编号]</code></p><ul><li><code>用户名</code>：指定要接受信息的登录用户</li><li><code>终端编号</code>：指定接收信息的用户的登录终端，如果省略，且用户在多个终端登录，会发送给其中一个终端</li></ul><h3 id="10-6-wall-命令"><a href="#10-6-wall-命令" class="headerlink" title="10.6 wall 命令"></a>10.6 wall 命令</h3><p>wall命令用于向系统当前所有打开的终端上输出信息，而 “write” 命令用于给指定用户发送消息。</p><p>命令格式：<code>wall 消息</code></p><p>示例：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@localhost</span> ~]<span class="meta"># wall <span class="string">&quot;I will be in 5 minutes to restart, please save your data&quot;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="11-系统痕迹命令"><a href="#11-系统痕迹命令" class="headerlink" title="11 系统痕迹命令"></a>11 系统痕迹命令</h2><p>系统中有一些重要的痕迹日志文件，如 &#x2F;var&#x2F;log&#x2F;wtmp、 &#x2F;var&#x2F;run&#x2F;utmp、 &#x2F;var&#x2F;log&#x2F;btmp、&#x2F;var&#x2F;log&#x2F;lastlog 等日志文件，如果你用 vim 打开这些文件，你会发现这些文件是二进制乱码。这是由于这些日志中保存的是系统的重要登录痕迹，包括某个用户何时登录了系统，何时退出了系统，错误登录等重要的系统信息。这些信息要是可以通过 vim 打开，就能编辑，这样痕迹信息就不准确，所以这些重要的痕迹日志，只能通过对应的命令来进行查看。</p><h3 id="11-1-w-命令"><a href="#11-1-w-命令" class="headerlink" title="11.1 w 命令"></a>11.1 w 命令</h3><p>w 命令是显示系统中正在登录的用户信息的命令，这个命令查看的痕迹日志是 “&#x2F;var&#x2F;run&#x2F;utmp”。基础信息如下：</p><ul><li>命令名称：w</li><li>英文原意：show who is logged on and what they are doing</li><li>所在路径：&#x2F;usr&#x2F;bin&#x2F;w</li><li>执行权限：所有用户</li><li>功能描述：显示登录用户和他们正在做什么</li></ul><p>命令格式：<code>w [选项] [用户名]</code></p><ul><li>选项：<ul><li><code>-h</code>：不打印头信息；</li><li><code>-u</code>：当显示当前进程和cpu时间时忽略用户名；</li><li><code>-s</code>：使用短输出格式；</li><li><code>-f</code>：显示用户从哪登录；</li></ul></li><li>用户：仅显示指定用户</li></ul><p>示例：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># w</span></span><br><span class="line"> <span class="number">18</span>:<span class="number">31</span>:<span class="number">08</span> up <span class="number">1</span> day, <span class="number">16</span> min,  <span class="number">3</span> users,  load average: <span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.00</span></span><br><span class="line"><span class="keyword">USER</span>     <span class="title">TTY</span>      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     tty1     -                Sat18   <span class="number">49</span>:<span class="number">23</span>   <span class="number">0.07s</span>  <span class="number">0.07s</span> -bash</span><br><span class="line">root     pts/<span class="number">0</span>    <span class="number">192.168</span>.<span class="number">199.119</span>  <span class="number">18</span>:<span class="number">22</span>    <span class="number">8</span>:<span class="number">17</span>   <span class="number">0.02s</span>  <span class="number">0.02s</span> -bash</span><br><span class="line">root     pts/<span class="number">1</span>    <span class="number">192.168</span>.<span class="number">199.119</span>  <span class="number">18</span>:<span class="number">22</span>    <span class="number">0.00s</span>  <span class="number">0.03s</span>  <span class="number">0.00s</span> w</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>说明：</p><ul><li>第一行内容：<ul><li>18:31:08：系统当前时间</li><li>up 1 day, 16 min：系统的运行时间</li><li>3 users：当前登录终端数量</li><li>load average: 0.00, 0.00, 0.00：系统在之前1分钟、5分钟、15分钟的平均负载。如果CPU是单核的，则这个数据超过1就是高负载；如果CPU是四核的，则这个数值超过4就是高负载</li></ul></li><li>第二行内容：<ul><li>USER：当前登录的用户</li><li>TTY：登录的终端。tty1-6: 本地字符终端(alt+F1-6 切换)，tty7: 本地图形终端(ctrl+F7切换，必须安装启动图形界面)，pts&#x2F;0-255: 远程终端</li><li>FROM：登录的IP地址，如果是本地终端，则是空</li><li>LOGIN@：登录时间</li><li>IDLE：用户空闲时间</li><li>JCPU：所有的进程占用的CPU时间</li><li>PCPU：当前进程占用的CPU时间</li><li>WHAT：用户正在进行的操作</li></ul></li></ul><h3 id="11-2-who-命令"><a href="#11-2-who-命令" class="headerlink" title="11.2 who 命令"></a>11.2 who 命令</h3><p>who 命令和 w 命令类似，用于查看正在登录的用户，但显示的内容更加简单，也是查看 “&#x2F;var&#x2F;run&#x2F;utmp” 日志。</p><p>命令格式：<code>who [选项] [查询文件]</code></p><ul><li>选项：<ul><li><code>-H</code>：显示各栏位的标题信息列</li><li><code>-q</code>：只显示登入系统的帐号名称和总人数</li><li><code>-w</code>：显示用户的信息状态栏</li><li><code>-u</code>：显示闲置时间，若该用户在前一分钟之内有进行任何动作，将标示成”.”号，如果该用户已超过24小时没有任何动作，则标示出”old”字符串</li></ul></li><li>查询文件：指定要查询的文件，默认是&#x2F;var&#x2F;run&#x2F;utmp</li></ul><h3 id="11-3-last-命令"><a href="#11-3-last-命令" class="headerlink" title="11.3 last 命令"></a>11.3 last 命令</h3><p>last 命令查看系统所有登录过的用户信息，包括正在登录的用户和之前登录的用户，这个命令查看的是 “&#x2F;var&#x2F;log&#x2F;wtmp” 痕迹日志文件</p><p>命令格式：<code>last [选项] [用户|终端]</code></p><ul><li>选项：<ul><li><code>-a</code>：把从何处登入系统的主机名称或ip地址，显示在最后一行</li><li><code>-d</code>：将IP地址转换成主机名称</li><li><code>-f 记录文件</code>：指定记录文件</li><li><code>-n 显示列数</code>或<code>-显示列数</code>：设置列出名单的显示列数</li><li><code>-R</code>：不显示登入系统的主机名称或IP地址</li><li><code>-x</code>：显示系统关机，重新开机，以及执行等级的改变等信息</li></ul></li><li>用户|终端：显示指定的用户或终端</li></ul><h3 id="11-4-lastlog-命令"><a href="#11-4-lastlog-命令" class="headerlink" title="11.4 lastlog 命令"></a>11.4 lastlog 命令</h3><p>lastlog 命令是查看系统中所有用户最好一次的登录时间的命令，这个命令查看的是 “&#x2F;var&#x2F;log&#x2F;lastlog” 痕迹日志文件</p><p>命令格式：<code>lastlog [选项]</code></p><ul><li>选项：<ul><li><code>-b 天数</code>：显示指定天数前的登录信息</li><li><code>-t 天数</code>：显示指定天数以来的登录信息</li><li><code>-u 用户名</code>：显示指定用户的最近登录信息</li></ul></li></ul><h3 id="11-5-lostb-命令"><a href="#11-5-lostb-命令" class="headerlink" title="11.5 lostb 命令"></a>11.5 lostb 命令</h3><p>lastb 命令是查看错误登录的信息的，查看的是 “&#x2F;var&#x2F;log&#x2F;btmp” 痕迹日志</p><p>命令格式：<code>lostb [选项] [用户|终端]</code></p><ul><li>选项：<ul><li><code>-a</code>：把从何处登入系统的主机名称或ip地址显示在最后一行</li><li><code>-d</code>：将IP地址转换成主机名称</li><li><code>-f 记录文件</code>：指定记录文件</li><li><code>-n 显示列数</code>或<code>-显示列数</code>：设置列出名单的显示列数</li><li><code>-R</code>：不显示登入系统的主机名称或IP地址</li><li><code>-x</code>：显示系统关机，重新开机，以及执行等级的改变等信息</li></ul></li><li>用户|终端：显示指定的用户或终端</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>个人博客搭建</title>
      <link href="/post/9639fcc6.html"/>
      <url>/post/9639fcc6.html</url>
      
        <content type="html"><![CDATA[<h1 id="个人博客搭建"><a href="#个人博客搭建" class="headerlink" title="个人博客搭建"></a>个人博客搭建</h1><h2 id="简介："><a href="#简介：" class="headerlink" title="简介："></a>简介：</h2><p>本文是基于<a href="https://www.bilibili.com/video/BV1NY4y1C7Ng/?spm_id_from=333.1007.top_right_bar_window_history.content.click&vd_source=63053d55e8751329afed633909c51f3f">【2022最新版】保姆级Hexo+github搭建个人博客并绑定自己的域名_哔哩哔哩_bilibili</a>进行创建，仅仅是搭建个人博客，而未作任何美化，如果有推荐的美化效果，欢迎分享，同时建议大家根据该视频和本文进行创建，创建过程中出现的一些问题也可以发在评论区。</p><h2 id="一、安装nodejs"><a href="#一、安装nodejs" class="headerlink" title="一、安装nodejs"></a>一、安装nodejs</h2><h5 id="1-1教程：https-blog-csdn-net-weixin-52799373-article-details-123840137"><a href="#1-1教程：https-blog-csdn-net-weixin-52799373-article-details-123840137" class="headerlink" title="1.1教程：https://blog.csdn.net/weixin_52799373/article/details/123840137"></a>1.1教程：<a href="https://blog.csdn.net/weixin_52799373/article/details/123840137">https://blog.csdn.net/weixin_52799373/article/details/123840137</a></h5><p>根据教程的部分截图：配置环境变量</p><p><img src="/post/9639fcc6/myBlog\source\img\1684984543102.png" alt="header"></p><p><img src="/post/9639fcc6/myBlog\source\img\1684984512067.png" alt="header"></p><h5 id="1-2-测试"><a href="#1-2-测试" class="headerlink" title="1.2 测试"></a>1.2 测试</h5><p>使用express模块全局安装测试<br>命令如下:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express -g</span><br></pre></td></tr></table></figure><h5 id="1-3-全局配置淘宝镜像"><a href="#1-3-全局配置淘宝镜像" class="headerlink" title="1.3 全局配置淘宝镜像"></a>1.3 全局配置淘宝镜像</h5><p>注意一定要<strong>管理员身份</strong>运行CMD</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https:<span class="comment">//registry.npm.taobao.org</span></span><br></pre></td></tr></table></figure><p>如果需要可以将cpm安装上</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm</span><br></pre></td></tr></table></figure><h5 id="1-4-查看配置："><a href="#1-4-查看配置：" class="headerlink" title="1.4 查看配置："></a>1.4 查看配置：</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config ls</span><br></pre></td></tr></table></figure><p><img src="/post/9639fcc6/myBlog\source\img\1684985491431.png" alt="header"></p><p>全局安装webpack:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack -g</span><br></pre></td></tr></table></figure><p><img src="/post/9639fcc6/myBlog\source\img\1684985348383.png" alt="header"></p><h2 id="二、安装并配置Git"><a href="#二、安装并配置Git" class="headerlink" title="二、安装并配置Git"></a>二、安装并配置Git</h2><h5 id="2-1-Windows系统Git安装教程：https-www-cnblogs-com-xueweisuoyong-p-11914045-html"><a href="#2-1-Windows系统Git安装教程：https-www-cnblogs-com-xueweisuoyong-p-11914045-html" class="headerlink" title="2.1 Windows系统Git安装教程：https://www.cnblogs.com/xueweisuoyong/p/11914045.html"></a>2.1 Windows系统Git安装教程：<a href="https://www.cnblogs.com/xueweisuoyong/p/11914045.html">https://www.cnblogs.com/xueweisuoyong/p/11914045.html</a></h5><p>安装完成之后双击打开git-bash.exe</p><h5 id="2-2-生成ssh-keys"><a href="#2-2-生成ssh-keys" class="headerlink" title="2.2 生成ssh keys"></a>2.2 生成ssh keys</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;你的邮箱地址&quot;</span></span><br></pre></td></tr></table></figure><p>一共四次回车,第二次如果出现overwrite，请输入y</p><p><img src="/post/9639fcc6/myBlog\source\img\1684986081946.png" alt="header"></p><h5 id="2-3-添加密钥"><a href="#2-3-添加密钥" class="headerlink" title="2.3 添加密钥"></a>2.3 添加密钥</h5><p>到C:\Users\gaofei.ssh文件中用记事本打开id _rsa.pub，复制</p><p>然后到git仓库（），粘贴之前复制的内容，添加秘钥，如下图所示</p><p><img src="/post/9639fcc6/myBlog\source\img\1685009140013.png" alt="header"></p><p><img src="/post/9639fcc6/myBlog\source\img\1685009219657.png" alt="header"></p><p><img src="/post/9639fcc6/myBlog\source\img\1684986888294.png" alt="header"></p><p><img src="/post/9639fcc6/myBlog\source\img\1685009261792.png" alt="header"></p><p>输入ssh -T <a href="mailto:&#103;&#x69;&#x74;&#64;&#x67;&#105;&#116;&#x68;&#x75;&#98;&#x2e;&#x63;&#x6f;&#109;">&#103;&#x69;&#x74;&#64;&#x67;&#105;&#116;&#x68;&#x75;&#98;&#x2e;&#x63;&#x6f;&#109;</a>测试ssh是否绑定成功</p><p>出现yes或者no填入yes，最后有successfully代表成功绑定</p><p><img src="/post/9639fcc6/myBlog\source\img\1684986947236.png" alt="1684986947236"></p><h2 id="三、安装hexo"><a href="#三、安装hexo" class="headerlink" title="三、安装hexo"></a>三、安装hexo</h2><h5 id="3-1-安装hexo"><a href="#3-1-安装hexo" class="headerlink" title="3.1 安装hexo"></a>3.1 安装hexo</h5><p>打开git-bash.exe输入</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>然后使用hexo -v查看是否安装成功</p><p>进入D盘，新建一个myBlog文件夹并进入该文件</p><p>使用命令hexo init初始化hexo，hexo s生成本地的hexo页面<br>输入<a href="http://localhost:400打开本地服务区">http://localhost:400打开本地服务区</a></p><h5 id="3-2-具体代码实现如下图所示"><a href="#3-2-具体代码实现如下图所示" class="headerlink" title="3.2 具体代码实现如下图所示"></a>3.2 具体代码实现如下图所示</h5><p><img src="/post/9639fcc6/myBlog\source\img\1684998128928.png" alt="header"></p><p><img src="/post/9639fcc6/myBlog\source\img\1684998147728.png" alt="1684998147728"></p><p><img src="/post/9639fcc6/myBlog\source\img\1684998161332.png" alt="header"></p><h2 id="四、上传GitHub"><a href="#四、上传GitHub" class="headerlink" title="四、上传GitHub"></a>四、上传GitHub</h2><h5 id="4-1-在GitHub上创建仓库"><a href="#4-1-在GitHub上创建仓库" class="headerlink" title="4.1 在GitHub上创建仓库"></a>4.1 在GitHub上创建仓库</h5><p><strong>注意：</strong>创建时名字要和github用户名一致，原因在下文，看完之后再创建！！！</p><p><img src="/post/9639fcc6/myBlog\source\img\1685004137044.png" alt="1685004137044"></p><h5 id="4-2-配置更改"><a href="#4-2-配置更改" class="headerlink" title="4.2 配置更改"></a>4.2 配置更改</h5><p>将下图中的文件（文件位置在自己创建的myBlog文件夹中）打开，并将末尾位置修改为下列内容，建议直接复制，然后将<a href="mailto:&#103;&#105;&#x74;&#64;&#103;&#105;&#116;&#104;&#x75;&#x62;&#46;&#x63;&#111;&#109;">&#103;&#105;&#x74;&#64;&#103;&#105;&#116;&#104;&#x75;&#x62;&#46;&#x63;&#111;&#109;</a>:后面的内容修改为你自己的仓库地址</p><p><img src="/post/9639fcc6/myBlog\source\img\1685004069950.png" alt="1685004069950"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: git<span class="meta">@github</span>.com:Evalin233/Evalin.github.io.git</span><br><span class="line">  branch: main</span><br></pre></td></tr></table></figure><h5 id="4-3-安装hexo-deployer-git-自动部署发布工具"><a href="#4-3-安装hexo-deployer-git-自动部署发布工具" class="headerlink" title="4.3 安装hexo-deployer-git 自动部署发布工具"></a>4.3 安装hexo-deployer-git 自动部署发布工具</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --sava</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="4-4-使用hexo-g生成页面"><a href="#4-4-使用hexo-g生成页面" class="headerlink" title="4.4 使用hexo g生成页面"></a>4.4 使用<strong>hexo g</strong>生成页面</h5><p>使用<strong>hexo g</strong>将本地文件上传到Github上面</p><p><img src="/post/9639fcc6/myBlog\source\img\1685005326484.png" alt="1685005326484"></p><p><img src="/post/9639fcc6/myBlog\source\img\1685005347787.png" alt="1685005347787"></p><h5 id="4-6-出现问题：访问github博客显示404"><a href="#4-6-出现问题：访问github博客显示404" class="headerlink" title="4.6 出现问题：访问github博客显示404"></a>4.6 出现问题：访问github博客显示404</h5><p>通过访问<a href="https://evalin233.github.io/">Hexo (evalin233.github.io)</a>，但是出现了404</p><p>解决方法，将仓库名与博客名改为一致的，之前我是创建的evalin仓库，但我的博客名为evalin233，除此之外还需要更改_config.yml文件中的内容，再次访问就可以了</p><p><img src="/post/9639fcc6/高菲\Documents\Ttpora文档\pictures\1685006258981.png" alt="1685006258981"></p><h5 id="4-7-访问博客"><a href="#4-7-访问博客" class="headerlink" title="4.7 访问博客"></a>4.7 访问博客</h5><p>开始的页面是初始化页面，没有做美化和增加内容</p><p><img src="/post/9639fcc6/myBlog\source\img\1685006314398.png" alt="1685006314398"></p><span id="more"></span><h2 id="五、一些其他内容"><a href="#五、一些其他内容" class="headerlink" title="五、一些其他内容"></a>五、一些其他内容</h2><h4 id="5-1-hexo常用命令"><a href="#5-1-hexo常用命令" class="headerlink" title="5.1 hexo常用命令"></a>5.1 hexo常用命令</h4><p>初始化<br>npm install hexo -g &#x2F;&#x2F;安装Hexo<br>npm update hexo -g &#x2F;&#x2F;升级<br>hexo init &#x2F;&#x2F;初始化博客<br>命令简写<br>hexo n “我的博客” &#x3D; hexo new “我的博客” &#x2F;&#x2F;新建文章<br>hexo g &#x3D; hexo generate &#x2F;&#x2F;生成<br>hexo s &#x3D; hexo server &#x2F;&#x2F;启动服务预览<br>hexo d &#x3D; hexo deploy &#x2F;&#x2F;部署<br>hexo server &#x2F;&#x2F;Hexo会监视文件变动并自动更新，无须重启服务器<br>hexo server -s &#x2F;&#x2F;静态模式<br>hexo server -p 5000 &#x2F;&#x2F;更改端口<br>hexo server -i 192.168.1.1 &#x2F;&#x2F;自定义 IP<br>hexo clean &#x2F;&#x2F;清除缓存，若是网页正常情况下可以忽略这条命令<br>原文链接：<a href="https://blog.csdn.net/jun_zhong866810/article/details/119892418">https://blog.csdn.net/jun_zhong866810/article/details/119892418</a></p><h4 id="5-2向hexo博客中插入图片"><a href="#5-2向hexo博客中插入图片" class="headerlink" title="5.2向hexo博客中插入图片"></a>5.2向hexo博客中插入图片</h4><p>进入博客根目录配置_config.yml:将post_asset_folder: false·改为post_asset_folder: true</p><p>安装插件:</p><p>npm install <a href="https://github.com/CodeFalling/hexo-asset-image">https://github.com/CodeFalling/hexo-asset-image</a> – save</p><p>此时再执行命令 :<br>hexo n article_name </p><p>创建新的文章，在 source&#x2F;_posts 中会生成文章 post_name.md 和同名文件夹 post_name,我们将文章中所使用到的将图片资源均放在 post_name 中，这时就可以在文章中使用相对路径引用图片资源了</p><p>添加图片:在想添加的位置写入<img src="/post/9639fcc6/%E9%AB%98%E8%8F%B2/Documents/Ttpora%E6%96%87%E6%A1%A3/%E5%9B%BE%E7%89%87%E5%90%8D%E5%AD%97.%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F">,例如<img src="/post/9639fcc6/%E9%AB%98%E8%8F%B2/Documents/Ttpora%E6%96%87%E6%A1%A3/1.png"><br>原文链接：<a href="https://blog.csdn.net/jun_zhong866810/article/details/119892418">https://blog.csdn.net/jun_zhong866810/article/details/119892418</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/post/4a17b156.html"/>
      <url>/post/4a17b156.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
